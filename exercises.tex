\documentclass{book}

\usepackage[T1,T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}

\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{enumitem}

\title{Решение упражнений из книги Искусство программирования на компьютере Д. Кнута \thanks{}}
\author{Dim Ch}
\date{July 2022}

\graphicspath{ {images/} }

\begin{document}

\chapter{Основные понятия}

\section{Алгоритмы}
\subsection*{}
\subsubsection{1.}

Необходимо преобразовать четверку $ (a, b, c, d) \textrm{ в } (b, c, d, a)$.

\begin{flalign*}
  t \leftarrow a, a \leftarrow b, b \leftarrow c, c \leftarrow d, d \leftarrow t && \\
\end{flalign*}

\subsubsection{2.}

Докажте, что в начале выполнения шага E1 $m$ всегда больше $n$, за исключением только первого случая выполнения этого шага.

Рассмотрим второй и последующий случаи выполнения шага E1. В этом случае шагу E1 всегда предшествует шаг E3, на котором $m$ принимается равным $n$, а $n$ -- $r$. Шагу E3 всегда предшествует шаг E1, на котором $r$ вычисляется как остаток от деления $m$ на $n$ при чем $(0 \leq r < n)$. Итого имеем

\begin{flalign*}
  \textrm{E1. } & 0 \leq r < n && \\
  \textrm{E3. } & m \leftarrow n, n \leftarrow r \Rightarrow 0 \leq n < m && \\
  \textrm{E1. } & 0 \leq n < m && \\
\end{flalign*}

\subsubsection{3.}

Изменить алгоритм E (из соображений эффективности) таким образом, чтобы исключить из него все тривиальные операции замены типа "$m \leftarrow n$".

\textbf{Алгоритм F} (Алгоритм Евклида без тривиальных присваиваний). Даны два целых положительных числа $m$ и $n$. Требуется найти их НОД.

\textbf{E1}. [\textit{Остаток от деления 1}] Вычислить остаток от деления $m$ на $n$ и сохранить его в $m$.

\textbf{E2}. [\textit{Сравнение с 0}] Если $m$ равно 0, ответ $n$.

\textbf{E3}. [\textit{Остаток от деления 2}] Вычислить остаток от деления $n$ на $m$ и сохранить его в $n$.

\textbf{E4}. [\textit{Сравнение с 0}] Если $n$ равно 0, ответ $m$.

\textbf{E5}. [\textit{Цикл}] Перейти на шаг 1.

\subsubsection{4.}

НОД 2166 и 6099 равен 57.

\subsubsection{5.}

Метод вычисления считается алгоритмом, если он удовлетворяет следующим условиям:
\begin{enumerate}
\item Конечность. Алгоритм -- это конечный метод вычислений.
\item Определенность. Программа -- метод вычислений на формальном языке.
\item Ввод.
\item Вывод.
\item Эффективность.
\end{enumerate}

Для процедуры чтения этой книги не выполняются условия:
\begin{itemize}
\item эффективности (например, не существует простого способа выполнить все упражнения, приведенные в книге);
\item конечности;
\item наличия определенного вывода (хотя неформально можно описать ожидаемые результаты от прочтения клиги).
\end{itemize}

Остальные условия условно можно считать выполненными:
\begin{itemize}
\item наличие ввода (текст книги);
\item определенность (хотя описание процедуры приведено на неформальном языке, шаги являются достаточно понятными и недвусмысленными).
\end{itemize}

В описании процедуры нет названия алгоритма, краткого описания шагов и завершающей вертикальной черты.

\subsubsection{6.}

Чему равно $T_5$ (среднее число случаев выполнения шага E1 при $n=5$)?

По условию алгоритма E $m$ -- положительное целое число. Рассмотрим все $ m \leq n$:

\begin{center}
\begin{tabular}{ c c }
 $m$ & $T_5$  \\ 
 1 & 2  \\  
 2 & 3  \\
 3 & 4  \\
 4 & 3  \\
 5 & 1  \\
\end{tabular}
\end{center}

Если $m < n$, то на первой итерации значения $m$ и $n$ меняются местами, а затем происходит выполнение алгоритма для $m=5$ и $n < m$.
Если $m > n$, то на первой итерации происходит вычисление остатка от деления $m$  на $n$, а затем алгоритм также выполняется для $m=5$ и $n < m$.
Если $m \bmod n = 0$ (в т.ч. при $m=n$), то алгоритм завершается на первой же итерации.

Таким образом, при увеличении $m$ значение $T_5$ будет последовательно принимать значения из таблицы выше. Среднее значение $T_5 = (2+3+4+3+1)/5 = 2.6$.

\subsubsection{7.}

Пусть $m$ известно, а $n$ -- любое целое положительное число. Пусть $U_m$ -- среднее число случаев выполнения шага E1 из алгоритма E. Покажите, что $U_m$ четко определено. Существует ли какая либо связь между $U_m$ и $T_m$?

Рассмотрим все случаи, когда $n>m$. На первом шаге значения $m$ и $n$ меняются местами. Среднее число дальнейших итераций равно $T_m$.
Т.е. среднее число $U_m$ в этом случае равно $T_m + 1$.

Если $n<m$, то $U_m = T_m - 1$, т.к. в это же состояние можно было прийти, обменяв местами $m$ и $n$ на первой итерации, как это показано в предыдущем упражнении.

Для $m=n$ $U_m = T_m$.

\subsubsection{8.}

Придумайте эффективный формальный алгоритм вычисления НОД целых положительных чисел $m$ и $n$, определив соответствующим образом $\theta_{j}$, $\phi_{j}$, $a_{j}$, $b_{j}$. Пусть входные данные представлены строкой $a^{m}b^{n}$, т.е. за $a$, взятым $m$ раз, следует $b$, взятое $n$ раз. Постарайтесь найти самое простое решение, насколько это возможно. [\textit{Указание.} Воспользуйтесь алгоритмом E, но вместо деления на шаге E1 присвойте $r \leftarrow |m-n|$, $n \leftarrow \min(m,n)$.]

\begin{flalign*}
  f(\alpha \ \ ab \ \ \omega, 0) & = f(\alpha \ \ ab \ \ \omega, 1) \\
  f(\sigma, 0) & = f(\sigma, 5) \\
  f(\alpha \ \ abb \ \ \omega, 1) & = f(\alpha \ \ bab \ \ \omega, 1) \\
  f(\sigma, 1) & = f(\sigma, 2) \\
  f(\alpha \ \ aab \ \ \omega, 2) & = f(\alpha \ \ aba \ \ \omega, 2) \\
  f(\sigma, 2) & = f(\sigma, 3) \\
  f(\alpha \ \ ab \ \ \omega, 3) & = f(\alpha \ \ b \ \ \omega, 3) \\
  f(\sigma, 3) & = f(\sigma, 4) \\
  f(\alpha \ \ ba \ \ \omega, 4) & = f(\alpha \ \ ab \ \ \omega, 4) \\
  f(\sigma, 4) & = f(\sigma, 0) \\
  f(\alpha \ \ b \ \ \omega, 5) & = f(\alpha \ \ a \ \ \omega, 5) \\
  f(\sigma, 5) & = f(\sigma, 6) \\
  f(\sigma, 6) & = f(\sigma, 6) \\
\end{flalign*}

\subsubsection{9.}


\section{Математическое введение}
\subsection{Математическая индукция}

\subsubsection{1.}

Объясните, как можно модифицировать идею доказательства методом математической индукции в случае, если некоторое утверждение $P(n)$ нужно доказать для всех \textit{неотрицательных} целых чисел, т.е. для $n = 0, 1, 2, \dots $, а не для $n = 1, 2, 3, \dots $.

\begin{enumerate}[label=\alph*)]
\item Доказать, что $P(0)$ верно.
\item Доказать, что $P(0), P(1), \dots, P(n)$ справедливы, то $P(n+1)$ также справедливо.
\end{enumerate}

\subsubsection{2.}

Найдите ошибку в следующем доказательстве. "\textbf{Теорема.} Пусть $a$ -- любое положительное число. Для всех целых положительных чисел $n$ имеем $a^{n-1}=1$. \textit{Доказательство.} Если $n=1$, $a^{n-1}=a^{1-1}=a^{0}=1$. По индукции, предполагая, что теорема верна для $1, 2, \dots, n$, имеем

\begin{flalign} \label{eq:1_2_1__2_1}
  a^{(n+1)-1}=a^{n}=\frac {a^{n-1} \times a^{n-1}} {a^{(n-1)-1}}=\frac{1 \times 1}{1} = 1;
\end{flalign}

следоваельно, теорема верна также для $n+1$."

В формуле \ref{eq:1_2_1__2_1} помимо $a^{n-1}$ фигурирует $a^{n-2}$. Поэтому в качестве базы индукции необходимо проверить два случая: $P(0)$ и $P(1)$. $P(0) = a^{0-1}=a^{-1}$ ($\neq 1 \ \ \textrm{при} \ \ a \neq 1$).

\subsubsection{3.}

Следующее доказательство по индукции выглядит корректным, но по непонятной причине для $n=6$ левая часть уравнения даёт $\frac{1}{2} + \frac{1}{6} + \frac{1}{12} + \frac{1}{20} + \frac{1}{30} = \frac{5}{6}$, а правая --- $\frac{3}{2}-\frac{1}{6} = \frac{4}{3}$. В чём же ошибка? "\textbf{Теорема}.

\begin{flalign} \label{eq:1_2_1__3_1}
  \frac{1}{1 \times 2} + \frac{1}{2 \times 3} + \cdots + \frac{1}{(n-1) \times n} = \frac{3}{2} - \frac{1}{n}.
\end{flalign}

\textit{Доказательство}. Используем индукцию по $n$. Для $n=1$ доказательство очевидно: $\frac{3}{2}-\frac{1}{n} = \frac{1}{1 \times 2}$. Предполагая, что теорема верна для $n$, имеем:

\begin{flalign*}
  \frac{1}{1 \times 2} + \cdots + \frac{1}{(n-1) \times n} + \frac{1}{n \times (n+1)} = \frac{3}{2} - \frac{1}{n} + \frac{1}{n(n+1)} = \frac{3}{2} - \frac{1}{n} + \Bigl(\frac{1}{n} - \frac{1}{n+1}\Bigl) = \frac{3}{2} - \frac{1}{n+1}
\end{flalign*}."

Для $n=1$ в левой части формулы \ref{eq:1_2_1__3_1} имеем $\frac{1}{(n-1) \times n} = \frac{1}{0 \times 1}$, а не $\frac{1}{2}$. База индукции определена неверно.

\subsubsection{4.}

Докажите, что числа Фибоначчи удовлетворяют не только соотношению $F_{n} \leq \phi ^ {n-1}$, но и неравенству $F_n \geq \phi^{n-2}$.

Если $n=1$, $F_1 = 1 \geq \phi^{-1}$. Пункт $(a)$ выполнен.

Заметим, что для $n=2$ $F_2 = 1 \geq \phi^{0} = 1$. Предполагая по индукции, что утверждения $P(1), P(2), \cdots, P(n)$ справедливы, имеем

\begin{flalign*}
  & F_{n} \geq \phi^{n-2} & \\
  & F_{n-1} \geq \phi^{n-3} & \\
  & F_{n+1} = F_n + F_{n-1} \geq \phi^{n-2} + \phi^{n-3} = \phi^{n-3}(\phi + 1) = \phi^{n-1} & \\
\end{flalign*}

\subsubsection{5.}

\textit{Простое число} --- это целое число, большее единицы, которое делится только на 1 и на само себя. Используя данное определение и метод математической индукции, докажите, что любое целое число, большее единицы, можно записать как произведение одного или нескольких простых чисел. (Для удобства будем считать, что простое число --- это ``произведение'' одного простого числа, т.е. его самого.)

Число 2 является простым, следовательно его можно записать как ``произведение'' одного простого числа. Обозначим это утверждение через $P(2)$.

Предполагая по индукции, что утверждения $P(2), P(3), \cdots, P(n)$ верны, докажем утверждение $P(n+1)$.

Если число $n+1$ простое, то его можно записать в качестве ``произведения'' одного числа. В противном случае $n+1$ делится без остатка на одно из чисел $q$ ($1 < q < n + 1$). При этом $n+1 = q d$, где $1 < d < n + 1$. Т.к. $P(q)$ и $P(d)$ выполняются, то $q$ и $d$ можно записать в виде произведения простых чисел. Следовательно, $n+1$ также можно записать в виде произведения простых чисел.

\subsubsection{6.}

Докажите, что если соотношения

\begin{flalign*}
  a'm + b'n = c \textrm{,} \ \ a m + b n = d & \\
\end{flalign*}

справедливы непосредственно перед выполнением шага E4, то они верны и после его выполнения.

Шаг E4:

\begin{flalign*}
  c \leftarrow d, d \leftarrow r, t \leftarrow a', a' \leftarrow a, a \leftarrow t - q a, t \leftarrow b', b' \leftarrow b, b \leftarrow t - q b.
\end{flalign*}

Т.к. $ a' \leftarrow a, b' \leftarrow b, c \leftarrow d $, то справедливость $a'm + b'n = c$ после шага E4 следует из справедливости $a m + b n = d$ до шага E4.

Заметим, что $ c = a'm + b'n = q d + r = q (a m + b n) + r $. Отсюда $ r = (a' - q a) m + (b' - q b) n $. Т.к. $ d \leftarrow r, a \leftarrow a' - q a, b \leftarrow b' - q b $, то $ a m + b n = d $ также справедливо.

\subsubsection{7.}

Сформулируйте и докажите по индукции правило вычисления сумм $1^2$, $2^2 - 1^2$, $3^2 - 2^2 + 1^2$, $4^2 - 3^2 + 2^2 - 1^2$, $5^2 - 4^2 + 3^2 - 2^2 + 1^2$ и т.д.

\begin{flalign*}
  & 1^2 = 1 & \\
  & 2^2 - 1^2 = 3 & \\
  & 3^2 - 2^2 + 1^2 = 6 & \\
  & 4^2 - 3^2 + 2^2 - 1^2 = 10 & \\
  & 5^2 - 4^2 + 3^2 - 2^2 + 1^2 = 15 & \\
\end{flalign*}

Заметим, что для $n \in [1..n]$ $P(n) = \sum_i^n i$ и по формуле арифметической прогрессии для $a=0, b=1$ $P(n) = \frac{1}{2} n(n+1)$. Докажем это утверждение по индукции.

Для $n=1$ утверждение выполняется: $1^2 = \frac{1}{2} 1 (1+1) = 1$. Предполагая по индукции, что выполняются $P(1)$, $P(2)$, $\cdots$, $P(n)$, докажем $P(n+1) = \frac{1}{2} (n+1) (n+2)$.

Заметим предварительно, что $P(n) = n^2 - P(n-1)$. Тогда, $P(n+1) = (n+1)^2 - P(n) = n^2 + 2 n + 1 - \frac{1}{2} n (n + 1) = n^2 + 2 n + 1 - \frac{1}{2} n^2 - \frac{1}{2} n = \frac{1}{2} (2 n^2 + 4n + 2 - n^2 - n) = \frac{1}{2} (n^2 + 3n + 2) = \frac{1}{2} (n+1)(n+2)$.

\subsubsection{8.}

(a) Докажите по индукции следующую теорему Никомаха (Nicomachus) (ок. 100 г. н.э.): $1^3 = 1$, $2^3 = 3+5$, $3^3 = 7+9+11$, $4^3 = 13+15+17+19$ и т.д. Требуется доказать формулу $(n^2-n+1) + (n^2-n+3) + \cdots + (n^2+n-1) = n^3$.

$P(1)$ выполняется. Предполагая по индукции, что выполняются $P(1), P(2), \cdots, P(n)$, докажем $P(n+1)$.

\begin{flalign} \label{eq:1_2_1__8_1}
  ((n+1)^2-(n+1)+1) + ((n+1)^2-(n+1)+3) + \cdots + ((n+1)^2+(n+1)-1)
\end{flalign}

Количество целых чисел $i$ таких, что $ ((n+1)^2-(n+1)+1) \leq i \leq ((n+1)^2+(n+1)-1)$ равно $ ((n+1)^2+(n+1)-1) - ((n+1)^2-(n+1)+1) + 1 = 2n + 1$. Т.к. мы берем каждое второе число, то количество слагаемых в формуле \ref{eq:1_2_1__8_1} равно $ \Bigl \lceil \frac{2n + 1}{2} \Bigl \rceil = n + 1$.

Заметим, что выражение $(n+1)^2-(n+1) = n^2 + 2n + 1 - n - 1 = (n^2 - n) + 2n$ входит в $n$ первых слагаемых. Следовательно $P(n+1) = P(n) + 2n \cdot n + (n+1)^2 + (n+1) -1 = n^3 + 2n^2 + n^2 + 3n + 1 = (n+1)^3$.

(b) Воспользуйтесь этим результатом для доказательства замечательной формулы $1^3 + 2^3 + \cdots + n^3 = (1+2+\cdots+n)^2$.

$P(n)$ очевидно выполняется. Предположим, что выполняется $P(n)$. Тогда:

\begin{flalign*}
  & 1^3 + 2^3 + \cdots + n^3 = & \\
  & (1) + (3+5) + (7+9+11) + \cdots + (n^2 + n - 1) = & \\
  & \sum_{0 \leq j < \sum_{1 \leq i \leq n} i} 1 + 2j = 
  \sum_{0 \leq j < \frac{1}{2}n(n+1)} 1 + 2j = & \\
  & \sum_{0 \leq j < \frac{1}{2}n(n+1)} 1 + (2 \sum_{0 \leq j < \frac{1}{2}n(n+1)} j) & \\
  & \frac{1}{2}n(n+1) + 2 \frac{1}{2}n(n+1) \frac{1}{2}(\frac{1}{2}n(n+1) - 1) = & \\
  & \frac{n}{2} (n+1)( 1 + \frac{1}{2}(n^2 + n - 2)) =
  \frac{n}{4} (n+1)( n^2 + n) =
  \frac{n^2}{4} (n+1)^2 = \Bigl ( \frac{n}{2} (n+1) \Bigl )^2 = & \\
  & (1 + 2 + \cdots n)^2 & \\
\end{flalign*}


\subsection{Числа, степени и логарифмы}
\subsection{Суммы и произведения}
\subsection{Целочисленные функции и элементарная теория чисел }
\subsection{Перестановки и факториалы}

\subsection{Биномиальные коэффициенты}

\subsubsection{10.}
Пусть $p$ --- простое число. Покажите:

\paragraph{e.}

\begin{flalign} \label{eq:1_2_6__10_e_1}
  \binom{n}{k} \equiv \binom{\lfloor n/p \rfloor}{\lfloor k/p \rfloor} \binom{n \bmod p}{k \bmod p} (\textrm{по модулю} \ \ p) &&
\end{flalign}

Основная формула биномиального коэффициента:

\begin{flalign*}
  \binom{n}{k} = \frac {n (n-1) (n-2) \dots (n-k+1)} {k (k-1) (k-2) \dots 1} &&
\end{flalign*}

Рассмотрим $ k \bmod p $ первых сомножителей в знаменателе. Все они делятся на $p$ с остатком. 
Если $ k \bmod p > 0 $, то

\begin{flalign*}
  \prod_{i=0}^{(k \bmod p)-1} k-i & \equiv \prod_{i=1}^{k \bmod p} i \ \ & (\textrm{по модулю } p) \\
  k & \equiv k \bmod p \ \ & (\textrm{по модулю } p) \\
  k - 1 & \equiv (k \bmod p) - 1 \ \ & (\textrm{по модулю } p) \\
  \dots & \equiv \dots & \\
  k - (k \bmod p) + 2 & \equiv 2  \ \ & (\textrm{по модулю } p) \\
  k - (k \bmod p) + 1 & \equiv 1  \ \ & (\textrm{по модулю } p) \\
\end{flalign*}

Например, для $ k=17, p=7 $:

\begin{flalign*}
  17 \bmod 7 & = 3 & \\
  (17 \bmod 7) - 1 & = 2 & \\
  \prod_{i=0}^{2} 17-i  & \equiv \prod_{i=1}^{3} i \ \ & (\textrm{по модулю } 7) \\
  17 \cdot 16 \cdot 15  & \equiv 3 \cdot 2 \cdot 1 \ \ & (\textrm{по модулю } 7) \\
  4080 & \equiv 6  \ \ & (\textrm{по модулю } 7) \\
  4080 \bmod 7 & = 6
\end{flalign*}

Эта формула также справедлива для случая, когда $k$ делится на $p$ без остатка. Например, для $ k=14, p=7 $:

\begin{flalign*}
  14 \bmod 7 & = 0 & \\
  (14 \bmod 7) - 1 & = -1 & \\
  \prod_{i=0}^{-1} 14-i  & \equiv \prod_{i=1}^{0} i \ \ & (\textrm{по модулю } 7) \\
  1  & \equiv 1 \ \ & (\textrm{по модулю } 7)
\end{flalign*}

Теперь рассмотрим $ k \bmod p $ первых сомножителей в числителе $ n (n - 1) \dots (n - (k \bmod p) + 1) $.
Среди них может не оказаться сомножителя кратного $p$. Тогда:

\begin{flalign*}
  \prod_{i=0}^{(k \bmod p)-1} n-i & \equiv (n \bmod p) ((n \bmod p) - 1) \dots ((n \bmod p) - (k \bmod p) + 1) \ \ & (\textrm{по модулю } p) \\
  n & \equiv n \bmod p \ \ & (\textrm{по модулю } p) \\
  n - 1 & \equiv (n \bmod p) - 1 \ \ & (\textrm{по модулю } p) \\
  \dots & \equiv \dots & \\
  n - (k \bmod p) + 2 & \equiv (n \bmod p) - (k \bmod p) + 2  \ \ & (\textrm{по модулю } p) \\
  n - (k \bmod p) + 1 & \equiv (n \bmod p) - (k \bmod p) + 1  \ \ & (\textrm{по модулю } p) \\
\end{flalign*}

Например, для $ n=20, k=17, p=7 $:

\begin{flalign*}
  20 \bmod 7 & = 6 & \\
  (20 \bmod 7) - 1 & = 5 & \\
  \prod_{i=0}^{2} 20-i  & \equiv 6 \cdot 5 \cdot 4 \ \ & (\textrm{по модулю } 7) \\
  20 \cdot 19 \cdot 18  & \equiv 6 \cdot 5 \cdot 4 \ \ & (\textrm{по модулю } 7) \\
  6840 & \equiv 120  \ \ & (\textrm{по модулю } 7) \\
  6840 \bmod 7 & = 1 &\\
  120 \bmod 7 & = 1 &
\end{flalign*}

Для случая $ k \bmod p = 0 $ произведение в числителе, также как и в знаменателе, обращается в $ 1 $.
Если среди первых $ k \bmod p $ сомножителей в числителе встретится число, кратное $p$, то

\begin{flalign*}
  \prod_{i=0}^{(k \bmod p)-1} n-i & \equiv 0 \ \ & (\textrm{по модулю } p) \\
\end{flalign*}

Подставим получившиеся соотношения в дробь

\begin{flalign*}
  \frac{\prod_{i=0}^{(k \bmod p)-1} n-i}{\prod_{i=0}^{(k \bmod p)-1} k-i} & \equiv \frac{(n \bmod p) ((n \bmod p) - 1) \dots ((n \bmod p) - (k \bmod p) + 1)}{\prod_{i=1}^{k \bmod p} i}  \ \ & (\textrm{по модулю } p) \\
  \frac{\prod_{i=0}^{(k \bmod p)-1} n-i}{\prod_{i=0}^{(k \bmod p)-1} k-i} & \equiv \binom{n \bmod p}{k \bmod p} \ \ & (\textrm{по модулю } p)
\end{flalign*}

Для случая $ \prod_{i=0}^{(k \bmod p)-1} n-i \equiv 0 \ \ (\textrm{по модулю } p) $ соотношения также справедливы, т.к. $ \binom{0}{k} = \Bigl\{ \genfrac{}{}{0pt}{}{0 \textrm{ при } k > 0}{1 \textrm{ при } k = 0} $.

Рассмотрим далее оставшиеся сомножители в знаменателе: $ \prod_{i=1}^{k-(k \bmod p)} i $. Например, для $ k=17, p = 7 $ имеем $ \prod_{i=1}^{14} i $. Можно выделить $ \lfloor k / p \rfloor $ групп по $ p $ элементов в каждой. При этом в каждой группе существует только один элемент, кратный $ p $, а остальные эквиваленты $ (p-1)! $. То же самое утверждение справедливо и для числителя.

Тогда элементы некратные $p$ сокращаются в числителе и знаменателе. Рассмотрим $ \lfloor k / p \rfloor $ элементов кратных $p$. Разделим каждый сомножитель в числителе и знаменателе на $ p $. Получим в знаменателе $ \lfloor k / p \rfloor ! $, т.к. первое число равно $ \lfloor k / p \rfloor $, а каждое последующее должно уменьшаться на $1$. В числителе получим $ \lfloor k / p \rfloor $ сомножителей, первым из которых является $ \lfloor (n - (k \bmod p)) / p \rfloor $, а последующие также уменьшаются на единицу. Т.е. получим биномиальный коэффициент

\begin{flalign*}
  \binom{\lfloor (n - (k \bmod p)) / p \rfloor}{\lfloor k / p \rfloor}
\end{flalign*}

При этом

\begin{flalign*}
  \lfloor (n - (k \bmod p)) / p \rfloor = \biggl\{ \genfrac{}{}{0pt}{0}
          {\lfloor n / p \rfloor \textrm{, если } k \bmod p \leq n \bmod p}
          {\lfloor n / p \rfloor - 1 \textrm{, если } k \bmod p > n \bmod p}
\end{flalign*}

Учтем, что при $ k \bmod p > n \bmod p $ второй сомножитель $ \binom{n \bmod p}{k \bmod p} = 0 $, поэтому значение первого сомножителя во всех случаях можно оставить равным $ \lfloor n / p \rfloor $.

Интересным следствием доказанной формулы является тот факт, что

\begin{flalign} \label{eq:1_2_6__10_e_2}
  \binom{n}{k} \equiv 0 \ \ (\textrm{по модулю } p) \textrm{, если } k \bmod p > n \bmod p 
\end{flalign}

\paragraph{a.}

\begin{flalign} \label{eq:1_2_6__10_a_1}
  \binom{n}{p} \equiv \biggl \lfloor \frac{n}{p} \biggl \rfloor \ \ (\textrm{по модулю} \ \ p) &&
\end{flalign}


Подставим в формулу \ref{eq:1_2_6__10_e_1} $p$ вместо $k$. Получим

\begin{flalign*}
  \binom{n}{p} & \equiv \binom{\lfloor n/p \rfloor}{\lfloor p/p \rfloor} \binom{n \bmod p}{p \bmod p} & (\textrm{по модулю} \ \ p) && \\
  \binom{n}{p} & \equiv \binom{\lfloor n/p \rfloor}{1} \binom{n \bmod p}{0} & (\textrm{по модулю} \ \ p) && \\
  \binom{n}{p} & \equiv \lfloor n/p \rfloor \cdot 1 & (\textrm{по модулю} \ \ p) && \\
  \binom{n}{p} & \equiv \lfloor n/p \rfloor & (\textrm{по модулю} \ \ p) && \\
\end{flalign*}

\paragraph{b.}

\begin{flalign} \label{eq:1_2_6__10_b_1}
  \binom{p}{k} \equiv 0 \ \ (\textrm{по модулю} \ \ p) \textrm{ для } 1 \leq k \leq p-1 &&
\end{flalign}

Подставим в формулу \ref{eq:1_2_6__10_e_1} $p$ вместо $n$. Получим

\begin{flalign*}
  \binom{p}{k} & \equiv \binom{\lfloor p/p \rfloor}{\lfloor k/p \rfloor} \binom{p \bmod p}{k \bmod p} & (\textrm{по модулю} \ \ p) && \\
  \binom{p}{k} & \equiv \binom{1}{\lfloor k/p \rfloor} \binom{0}{k \bmod p} & (\textrm{по модулю} \ \ p) && \\
  & k \bmod p = k \textrm{ для } 1 \leq k \leq p-1 & && \\
  & \lfloor k/p \rfloor = 0 \textrm{ для } 1 \leq k \leq p-1 & && \\
  \binom{p}{k} & \equiv \binom{1}{0} \binom{0}{k} & (\textrm{по модулю} \ \ p) && \\
  \binom{p}{k} & \equiv 1 \cdot 0 & (\textrm{по модулю} \ \ p) && \\
  \binom{p}{k} & \equiv 0 & (\textrm{по модулю} \ \ p) && \\
\end{flalign*}

\paragraph{c.}

\begin{flalign*}
  \binom{p-1}{k} \equiv (-1)^{k} \ \ (\textrm{по модулю} \ \ p) \textrm{ для } 0 \leq k \leq p-1 &&
\end{flalign*}

Если $k=0$, а $p>0$, то $ \binom{p-1}{k} = \binom{p-1}{0} = 1 $ и $ (-1)^k = 1 $.

Подстановка $p-1$ вместо $n$ в формулу \ref{eq:1_2_6__10_e_1} ничего не дает, т.к. первый сомножитель обращается в $1$, а второй в исходное выражение:

\begin{flalign*}
  \binom{p-1}{k} & \equiv \binom{\lfloor (p-1)/p \rfloor}{\lfloor k/p \rfloor} \binom{p-1 \bmod p}{k \bmod p} & (\textrm{по модулю} \ \ p) && \\
  \binom{p-1}{k} & \equiv \binom{0}{\lfloor k/p \rfloor} \binom{p-1}{k \bmod p} & (\textrm{по модулю} \ \ p) && \\
  & k \bmod p = k \textrm{ для } 0 \leq k \leq p-1 & && \\
  & \lfloor k/p \rfloor = 0 \textrm{ для } 0 \leq k \leq p-1 & && \\
  \binom{p-1}{k} & \equiv \binom{0}{0} \binom{p-1}{k} & (\textrm{по модулю} \ \ p) && \\
\end{flalign*}

Рассмотрим формулу сложения:

\begin{flalign*}
  \binom{p}{k} & = \binom{p-1}{k} + \binom{p-1}{k-1} && \\
  \binom{p-1}{k} & = \binom{p}{k} - \binom{p-1}{k-1} && \\
\end{flalign*}

Т.к. по формуле \ref{eq:1_2_6__10_b_1} $\binom{p}{k} \equiv 0 \ \ (\textrm{по модулю } p)$, то имеем

\begin{flalign*}
  \binom{p-1}{k} & \equiv - \binom{p-1}{k-1} & (\textrm{по модулю } p) && \\
  \binom{p-1}{0} & \equiv 1 & (\textrm{по модулю } p) && \\
  \binom{p-1}{1} & \equiv -1 = p-1 & (\textrm{по модулю } p) && \\
  \binom{p-1}{2} & \equiv 1 & (\textrm{по модулю } p) && \\
  \dots & \equiv \dots & (\textrm{по модулю } p) && \\
  \binom{p-1}{p-1} & \equiv 1 & (\textrm{по модулю } p) && \\
  \binom{p-1}{k} & \equiv (-1)^{k} & (\textrm{по модулю } p) && \\
\end{flalign*}

Т.к. $p$ -- простое число, а следовательно и нечетное, то $p-1$ -- число четное и $(-1)^{p-1} = 1$. 

\paragraph{d.}

\begin{flalign*}
  \binom{p+1}{k} \equiv 0 \ \ (\textrm{по модулю} \ \ p) \textrm{ для } 2 \leq k \leq p-1 &&
\end{flalign*}

По формуле сложения:

\begin{flalign*}
  \binom{r}{k} & = \binom{r-1}{k} + \binom{r-1}{k-1} && \\
  \binom{p+1}{k} & = \binom{p}{k} + \binom{p}{k-1} && \\
\end{flalign*}

По формуле \ref{eq:1_2_6__10_b_1} $ \binom{p}{k} \equiv 0 \ \ (\textrm{по модулю } p) \textrm{ для } k \geq 1 $, но тогда и $ \binom{p}{k-1} \equiv 0 \ \ (\textrm{по модулю } p) $, т.к. по условию $ k \geq 2 $.

\paragraph{f.}

Если в системе счисления с основанием $p$ числа $n$ и $k$ представляются в виде

\begin{flalign*}
  \genfrac{}{}{0pt}{}{n = a_r p^r + \dots + a_1 p + a_0,}{k = b_r p^r + \dots + b_1 p + b_0,} \textrm{ то }
  \binom{n}{k} \equiv \binom{a_r}{b_r} \dots \binom{a_1}{b_1} \binom{a_0}{b_0} \ \ (\textrm{по модулю } p)
\end{flalign*}

Заметим, что

\begin{flalign*}
  \lfloor n/p \rfloor & = a_r p^{r-1} + \dots + a_2 p + a_1 &&  \\
  n \bmod p           & = a_0 &&
\end{flalign*}

Таким образом по формуле \ref{eq:1_2_6__10_e_1} получаем

\begin{flalign*}
  \binom{n}{k} & \equiv \binom{a_r p^{r-1} + \dots + a_2 p + a_1}{b_r p^{r-1} + \dots + b_2 p + b_1} \binom{a_0}{b_0} \ \ & (\textrm{по модулю } p) && \\
  \binom{n}{k} & \equiv \binom{a_r p^{r-2} + \dots + a_3 p + a_2}{b_r p^{r-2} + \dots + b_3 p + b_2} \binom{a_1}{b_1} \binom{a_0}{b_0} \ \ & (\textrm{по модулю } p) && \\
  \dots & \equiv \dots \ \ & (\textrm{по модулю } p) && \\
  \binom{n}{k} & \equiv \binom{a_r p + a_{r-1}}{b_r p + b_{r-1}} \binom{a_{r-2}}{b_{r-2}} \dots \binom{a_1}{b_1} \binom{a_0}{b_0} \ \ & (\textrm{по модулю } p) && \\
  \binom{n}{k} & \equiv \binom{a_r}{b_r} \binom{a_{r-1}}{b_{r-1}} \binom{a_{r-2}}{b_{r-2}} \dots \binom{a_1}{b_1} \binom{a_0}{b_0} \ \ & (\textrm{по модулю } p) && \\
\end{flalign*}


\end{document}
