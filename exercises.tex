\documentclass{book}

\usepackage[T1,T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}

\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{enumitem}
\usepackage{tabularx}
\usepackage{geometry}
\usepackage{layout}

\geometry{a4paper, textwidth=426pt}

\title{Решение упражнений из книги Искусство программирования на компьютере Д. Кнута \thanks{}}
\author{Dim Ch}
\date{July 2022}

\graphicspath{ {images/} }

\begin{document}

\chapter{Основные понятия}

\section{Алгоритмы}

\subsection*{}
\subsubsection{1.}

Необходимо преобразовать четверку $ (a, b, c, d) \textrm{ в } (b, c, d, a)$.

\begin{flalign*}
  t \leftarrow a, a \leftarrow b, b \leftarrow c, c \leftarrow d, d \leftarrow t && \\
\end{flalign*}

\subsubsection{2.}

Докажите, что в начале выполнения шага E1 $m$ всегда больше $n$, за исключением только первого случая выполнения этого шага.

Рассмотрим второй и последующий случаи выполнения шага E1. В этом случае шагу E1 всегда предшествует шаг E3, на котором $m$ принимается равным $n$, а $n$ -- $r$. Шагу E3 всегда предшествует шаг E1, на котором $r$ вычисляется как остаток от деления $m$ на $n$ при чем $(0 \leq r < n)$. Итого имеем

\begin{flalign*}
  \textrm{E1. } & 0 \leq r < n && \\
  \textrm{E3. } & m \leftarrow n, n \leftarrow r \Rightarrow 0 \leq n < m && \\
  \textrm{E1. } & 0 \leq n < m && \\
\end{flalign*}

\subsubsection{3.}

Изменить алгоритм E (из соображений эффективности) таким образом, чтобы исключить из него все тривиальные операции замены типа "$m \leftarrow n$".

\textbf{Алгоритм F} (Алгоритм Евклида без тривиальных присваиваний). Даны два целых положительных числа $m$ и $n$. Требуется найти их НОД.

\textbf{E1}. [\textit{Остаток от деления 1}] Вычислить остаток от деления $m$ на $n$ и сохранить его в $m$.

\textbf{E2}. [\textit{Сравнение с 0}] Если $m$ равно 0, ответ $n$.

\textbf{E3}. [\textit{Остаток от деления 2}] Вычислить остаток от деления $n$ на $m$ и сохранить его в $n$.

\textbf{E4}. [\textit{Сравнение с 0}] Если $n$ равно 0, ответ $m$.

\textbf{E5}. [\textit{Цикл}] Перейти на шаг 1.

\subsubsection{4.}

НОД 2166 и 6099 равен 57.

\subsubsection{5.}

Метод вычисления считается алгоритмом, если он удовлетворяет следующим условиям:
\begin{enumerate}
\item Конечность. Алгоритм -- это конечный метод вычислений.
\item Определенность. Программа -- метод вычислений на формальном языке.
\item Ввод.
\item Вывод.
\item Эффективность.
\end{enumerate}

Для процедуры чтения этой книги не выполняются условия:
\begin{itemize}
\item эффективности (например, не существует простого способа выполнить все упражнения, приведенные в книге);
\item конечности;
\item наличия определенного вывода (хотя неформально можно описать ожидаемые результаты от прочтения клиги).
\end{itemize}

Остальные условия условно можно считать выполненными:
\begin{itemize}
\item наличие ввода (текст книги);
\item определенность (хотя описание процедуры приведено на неформальном языке, шаги являются достаточно понятными и недвусмысленными).
\end{itemize}

В описании процедуры нет названия алгоритма, краткого описания шагов и завершающей вертикальной черты.

\subsubsection{6.}

Чему равно $T_5$ (среднее число случаев выполнения шага E1 при $n=5$)?

По условию алгоритма E $m$ -- положительное целое число. Рассмотрим все $ m \leq n$:

\begin{center}
\begin{tabular}{ c c }
 $m$ & $T_5$  \\ 
 1 & 2  \\  
 2 & 3  \\
 3 & 4  \\
 4 & 3  \\
 5 & 1  \\
\end{tabular}
\end{center}

Если $m < n$, то на первой итерации значения $m$ и $n$ меняются местами, а затем происходит выполнение алгоритма для $m=5$ и $n < m$.
Если $m > n$, то на первой итерации происходит вычисление остатка от деления $m$  на $n$, а затем алгоритм также выполняется для $m=5$ и $n < m$.
Если $m \bmod n = 0$ (в т.ч. при $m=n$), то алгоритм завершается на первой же итерации.

Таким образом, при увеличении $m$ значение $T_5$ будет последовательно принимать значения из таблицы выше. Среднее значение $T_5 = (2+3+4+3+1)/5 = 2.6$.

\subsubsection{7.}

Пусть $m$ известно, а $n$ -- любое целое положительное число. Пусть $U_m$ -- среднее число случаев выполнения шага E1 из алгоритма E. Покажите, что $U_m$ четко определено. Существует ли какая либо связь между $U_m$ и $T_m$?

Рассмотрим все случаи, когда $n>m$. На первом шаге значения $m$ и $n$ меняются местами. Среднее число дальнейших итераций равно $T_m$.
Т.е. среднее число $U_m$ в этом случае равно $T_m + 1$.

Если $n<m$, то $U_m = T_m - 1$, т.к. в это же состояние можно было прийти, обменяв местами $m$ и $n$ на первой итерации, как это показано в предыдущем упражнении.

Для $m=n$ $U_m = T_m$.

\subsubsection{8.}

Придумайте эффективный формальный алгоритм вычисления НОД целых положительных чисел $m$ и $n$, определив соответствующим образом $\theta_{j}$, $\phi_{j}$, $a_{j}$, $b_{j}$. Пусть входные данные представлены строкой $a^{m}b^{n}$, т.е. за $a$, взятым $m$ раз, следует $b$, взятое $n$ раз. Постарайтесь найти самое простое решение, насколько это возможно. [\textit{Указание.} Воспользуйтесь алгоритмом E, но вместо деления на шаге E1 присвойте $r \leftarrow |m-n|$, $n \leftarrow \min(m,n)$.]

\begin{flalign*}
  f(\alpha \ \ ab \ \ \omega, 0) & = f(\alpha \ \ ab \ \ \omega, 1) \\
  f(\sigma, 0) & = f(\sigma, 5) \\
  f(\alpha \ \ abb \ \ \omega, 1) & = f(\alpha \ \ bab \ \ \omega, 1) \\
  f(\sigma, 1) & = f(\sigma, 2) \\
  f(\alpha \ \ aab \ \ \omega, 2) & = f(\alpha \ \ aba \ \ \omega, 2) \\
  f(\sigma, 2) & = f(\sigma, 3) \\
  f(\alpha \ \ ab \ \ \omega, 3) & = f(\alpha \ \ b \ \ \omega, 3) \\
  f(\sigma, 3) & = f(\sigma, 4) \\
  f(\alpha \ \ ba \ \ \omega, 4) & = f(\alpha \ \ ab \ \ \omega, 4) \\
  f(\sigma, 4) & = f(\sigma, 0) \\
  f(\alpha \ \ b \ \ \omega, 5) & = f(\alpha \ \ a \ \ \omega, 5) \\
  f(\sigma, 5) & = f(\sigma, 6) \\
  f(\sigma, 6) & = f(\sigma, 6) \\
\end{flalign*}

\subsubsection{9.}


\section{Математическое введение}
\subsection{Математическая индукция}

\subsubsection{1.}

Объясните, как можно модифицировать идею доказательства методом математической индукции в случае, если некоторое утверждение $P(n)$ нужно доказать для всех \textit{неотрицательных} целых чисел, т.е. для $n = 0, 1, 2, \dots $, а не для $n = 1, 2, 3, \dots $.

\begin{enumerate}[label=\alph*)]
\item Доказать, что $P(0)$ верно.
\item Доказать, что $P(0), P(1), \dots, P(n)$ справедливы, то $P(n+1)$ также справедливо.
\end{enumerate}

\subsubsection{2.}

Найдите ошибку в следующем доказательстве. "\textbf{Теорема.} Пусть $a$ -- любое положительное число. Для всех целых положительных чисел $n$ имеем $a^{n-1}=1$. \textit{Доказательство.} Если $n=1$, $a^{n-1}=a^{1-1}=a^{0}=1$. По индукции, предполагая, что теорема верна для $1, 2, \dots, n$, имеем

\begin{flalign} \label{eq:1_2_1__2_1}
  a^{(n+1)-1}=a^{n}=\frac {a^{n-1} \times a^{n-1}} {a^{(n-1)-1}}=\frac{1 \times 1}{1} = 1;
\end{flalign}

следоваельно, теорема верна также для $n+1$."

В формуле \ref{eq:1_2_1__2_1} помимо $a^{n-1}$ фигурирует $a^{n-2}$. Поэтому в качестве базы индукции необходимо проверить два случая: $P(0)$ и $P(1)$. $P(0) = a^{0-1}=a^{-1}$ ($\neq 1 \ \ \textrm{при} \ \ a \neq 1$).

\subsubsection{3.}

Следующее доказательство по индукции выглядит корректным, но по непонятной причине для $n=6$ левая часть уравнения даёт $\frac{1}{2} + \frac{1}{6} + \frac{1}{12} + \frac{1}{20} + \frac{1}{30} = \frac{5}{6}$, а правая --- $\frac{3}{2}-\frac{1}{6} = \frac{4}{3}$. В чём же ошибка? "\textbf{Теорема}.

\begin{flalign} \label{eq:1_2_1__3_1}
  \frac{1}{1 \times 2} + \frac{1}{2 \times 3} + \cdots + \frac{1}{(n-1) \times n} = \frac{3}{2} - \frac{1}{n}.
\end{flalign}

\textit{Доказательство}. Используем индукцию по $n$. Для $n=1$ доказательство очевидно: $\frac{3}{2}-\frac{1}{n} = \frac{1}{1 \times 2}$. Предполагая, что теорема верна для $n$, имеем:

\begin{flalign*}
  \frac{1}{1 \times 2} + \cdots + \frac{1}{(n-1) \times n} + \frac{1}{n \times (n+1)} = \frac{3}{2} - \frac{1}{n} + \frac{1}{n(n+1)} = \frac{3}{2} - \frac{1}{n} + \Bigl(\frac{1}{n} - \frac{1}{n+1}\Bigl) = \frac{3}{2} - \frac{1}{n+1}
\end{flalign*}."

Для $n=1$ в левой части формулы \ref{eq:1_2_1__3_1} имеем $\frac{1}{(n-1) \times n} = \frac{1}{0 \times 1}$, а не $\frac{1}{2}$. База индукции определена неверно.

\subsubsection{4.}

Докажите, что числа Фибоначчи удовлетворяют не только соотношению $F_{n} \leq \phi ^ {n-1}$, но и неравенству $F_n \geq \phi^{n-2}$.

Если $n=1$, $F_1 = 1 \geq \phi^{-1}$. Пункт $(a)$ выполнен.

Заметим, что для $n=2$ $F_2 = 1 \geq \phi^{0} = 1$. Предполагая по индукции, что утверждения $P(1), P(2), \cdots, P(n)$ справедливы, имеем

\begin{flalign*}
  & F_{n} \geq \phi^{n-2} & \\
  & F_{n-1} \geq \phi^{n-3} & \\
  & F_{n+1} = F_n + F_{n-1} \geq \phi^{n-2} + \phi^{n-3} = \phi^{n-3}(\phi + 1) = \phi^{n-1} & \\
\end{flalign*}

\subsubsection{5.}

\textit{Простое число} --- это целое число, большее единицы, которое делится только на 1 и на само себя. Используя данное определение и метод математической индукции, докажите, что любое целое число, большее единицы, можно записать как произведение одного или нескольких простых чисел. (Для удобства будем считать, что простое число --- это ``произведение'' одного простого числа, т.е. его самого.)

Число 2 является простым, следовательно его можно записать как ``произведение'' одного простого числа. Обозначим это утверждение через $P(2)$.

Предполагая по индукции, что утверждения $P(2), P(3), \cdots, P(n)$ верны, докажем утверждение $P(n+1)$.

Если число $n+1$ простое, то его можно записать в качестве ``произведения'' одного числа. В противном случае $n+1$ делится без остатка на одно из чисел $q$ ($1 < q < n + 1$). При этом $n+1 = q d$, где $1 < d < n + 1$. Т.к. $P(q)$ и $P(d)$ выполняются, то $q$ и $d$ можно записать в виде произведения простых чисел. Следовательно, $n+1$ также можно записать в виде произведения простых чисел.

\subsubsection{6.}

Докажите, что если соотношения

\begin{flalign*}
  a'm + b'n = c \textrm{,} \ \ a m + b n = d & \\
\end{flalign*}

справедливы непосредственно перед выполнением шага E4, то они верны и после его выполнения.

Шаг E4:

\begin{flalign*}
  c \leftarrow d, d \leftarrow r, t \leftarrow a', a' \leftarrow a, a \leftarrow t - q a, t \leftarrow b', b' \leftarrow b, b \leftarrow t - q b.
\end{flalign*}

Т.к. $ a' \leftarrow a, b' \leftarrow b, c \leftarrow d $, то справедливость $a'm + b'n = c$ после шага E4 следует из справедливости $a m + b n = d$ до шага E4.

Заметим, что $ c = a'm + b'n = q d + r = q (a m + b n) + r $. Отсюда $ r = (a' - q a) m + (b' - q b) n $. Т.к. $ d \leftarrow r, a \leftarrow a' - q a, b \leftarrow b' - q b $, то $ a m + b n = d $ также справедливо.

\subsubsection{7.}

Сформулируйте и докажите по индукции правило вычисления сумм $1^2$, $2^2 - 1^2$, $3^2 - 2^2 + 1^2$, $4^2 - 3^2 + 2^2 - 1^2$, $5^2 - 4^2 + 3^2 - 2^2 + 1^2$ и т.д.

\begin{flalign*}
  & 1^2 = 1 & \\
  & 2^2 - 1^2 = 3 & \\
  & 3^2 - 2^2 + 1^2 = 6 & \\
  & 4^2 - 3^2 + 2^2 - 1^2 = 10 & \\
  & 5^2 - 4^2 + 3^2 - 2^2 + 1^2 = 15 & \\
\end{flalign*}

Заметим, что для $n \in [1..n]$ $P(n) = \sum_i^n i$ и по формуле арифметической прогрессии для $a=0, b=1$ $P(n) = \frac{1}{2} n(n+1)$. Докажем это утверждение по индукции.

Для $n=1$ утверждение выполняется: $1^2 = \frac{1}{2} 1 (1+1) = 1$. Предполагая по индукции, что выполняются $P(1)$, $P(2)$, $\cdots$, $P(n)$, докажем $P(n+1) = \frac{1}{2} (n+1) (n+2)$.

Заметим предварительно, что $P(n) = n^2 - P(n-1)$. Тогда, $P(n+1) = (n+1)^2 - P(n) = n^2 + 2 n + 1 - \frac{1}{2} n (n + 1) = n^2 + 2 n + 1 - \frac{1}{2} n^2 - \frac{1}{2} n = \frac{1}{2} (2 n^2 + 4n + 2 - n^2 - n) = \frac{1}{2} (n^2 + 3n + 2) = \frac{1}{2} (n+1)(n+2)$.

\subsubsection{8.}

(a) Докажите по индукции следующую теорему Никомаха (Nicomachus) (ок. 100 г. н.э.): $1^3 = 1$, $2^3 = 3+5$, $3^3 = 7+9+11$, $4^3 = 13+15+17+19$ и т.д. Требуется доказать формулу $(n^2-n+1) + (n^2-n+3) + \cdots + (n^2+n-1) = n^3$.

$P(1)$ выполняется. Предполагая по индукции, что выполняются $P(1), P(2), \cdots, P(n)$, докажем $P(n+1)$.

\begin{flalign} \label{eq:1_2_1__8_1}
  ((n+1)^2-(n+1)+1) + ((n+1)^2-(n+1)+3) + \cdots + ((n+1)^2+(n+1)-1)
\end{flalign}

Количество целых чисел $i$ таких, что $ ((n+1)^2-(n+1)+1) \leq i \leq ((n+1)^2+(n+1)-1)$ равно $ ((n+1)^2+(n+1)-1) - ((n+1)^2-(n+1)+1) + 1 = 2n + 1$. Т.к. мы берем каждое второе число, то количество слагаемых в формуле \ref{eq:1_2_1__8_1} равно $ \Bigl \lceil \frac{2n + 1}{2} \Bigl \rceil = n + 1$.

Заметим, что выражение $(n+1)^2-(n+1) = n^2 + 2n + 1 - n - 1 = (n^2 - n) + 2n$ входит в $n$ первых слагаемых. Следовательно $P(n+1) = P(n) + 2n \cdot n + (n+1)^2 + (n+1) -1 = n^3 + 2n^2 + n^2 + 3n + 1 = (n+1)^3$.

(b) Воспользуйтесь этим результатом для доказательства замечательной формулы $1^3 + 2^3 + \cdots + n^3 = (1+2+\cdots+n)^2$.

$P(n)$ очевидно выполняется. Предположим, что выполняется $P(n)$. Тогда:

\begin{flalign*}
  & 1^3 + 2^3 + \cdots + n^3 = & \\
  & (1) + (3+5) + (7+9+11) + \cdots + (n^2 + n - 1) = & \\
  & \sum_{0 \leq j < \sum_{1 \leq i \leq n} i} 1 + 2j = 
  \sum_{0 \leq j < \frac{1}{2}n(n+1)} 1 + 2j = & \\
  & \sum_{0 \leq j < \frac{1}{2}n(n+1)} 1 + (2 \sum_{0 \leq j < \frac{1}{2}n(n+1)} j) & \\
  & \frac{1}{2}n(n+1) + 2 \frac{1}{2}n(n+1) \frac{1}{2}(\frac{1}{2}n(n+1) - 1) = & \\
  & \frac{n}{2} (n+1)( 1 + \frac{1}{2}(n^2 + n - 2)) =
  \frac{n}{4} (n+1)( n^2 + n) =
  \frac{n^2}{4} (n+1)^2 = \Bigl ( \frac{n}{2} (n+1) \Bigl )^2 = & \\
  & (1 + 2 + \cdots n)^2 & \\
\end{flalign*}

\subsubsection{9.}

Докажите по индукции, что если $0 < a < 1$, то $(1-a)^n \geq 1 - na$.

P(1) выполняется:

\begin{flalign*}
  & (1-a)^1 \geq 1-1a & \\
  & 1-a = 1-a & \\
\end{flalign*}

Предполагая по индукции, что выполняются $P(1), P(2), \cdots, P(n)$, докажем что выполняется $P(n+1)$.

\begin{flalign*}
  & (1-a)^{n+1} = (1-a)^n (1-a) = (1-a)^n -a(1-a)^n = ((1-a)^n) + (-a(1-a)^n) & \\
  & 1-(n+1)a = 1-na-a = (1-na)+(-a) & \\
  & (1-a)^n \geq 1-na & \\
  & -a(1-a)^n \textrm{ ? } -a & \\
  & 0 < (1-a)^n < 1 & \\
  & a(1-a)^n < a & \\
  & -a(1-a)^n > -a & \\
\end{flalign*}

Т.к. оба слагаемых в правой части неравенства больше либо равны, чем соответствующие слагаемые в левой части, то выражение $P(n+1)$ доказано.

\subsubsection{10.}

Докажите по индукции, что если $n \geq 10$, то $2^n > n^3$.

Для $P(10)$ имеем $2^{10} = 1024 \geq 1000 = 10^3$.

Предполагая по индукции, что $P(10), P(11), \cdots, P(n)$ выполняются, докажем, что выполняется и $P(n+1)$.

\begin{flalign*}
  & 2^{n+1} \textrm{ ? } (n+1)^3 & \\
  & 2^n \cdot 2 = 2^n + 2^n \textrm{ ? } n^3 + 3n^2 + 3n + 1  & \\
  & n^3 \textrm{ ? } 3n^2 + 3n + 1 & \\
\end{flalign*}

Т.к. $P(n)$ выполняется, то остается сравнить $2^n$ и $3n^2 + 3n + 1$. Предположим, что для $n >= 10$ $3n^2 + 3n + 1$ меньше $n^3$, а следовательно и $2^n$. Если доказать этот факт, то задача будет решена.

Для $n=10$ имеем $10^3 = 1000 > 331 = 3 10^2 + 3 10 + 1$. Далее докажем утверждение для $n+1$, предполагая что для $n$ оно выполняется.

\begin{flalign*}
  & (n+1)^3 \textrm{ ? } 3(n+1)^2 + 3(n+1) + 1 & \\
  & n^3 + 3 n^2 + 3n + 1 \textrm{ ? } 3n^2 + 6n + 3 + 3n + 3 + 1 & \\
  & n^3 \geq 6(n + 1) & \\
\end{flalign*}

Последнее утверждение также легко доказывается по индукции.

В ответах приведено более простое решение, основанное на том, что $(n+1)^3 = n^3(1+\frac{1}{n})^3$.

\subsubsection{11.}

Найдите и докажите простую формулу для следующей суммы:

\begin{flalign*}
  \frac{1^3}{1^4+4} - \frac{3^3}{3^4 + 4} + \frac{5^3}{5^4 + 4} - \cdots + \frac{(-1)^n(2n+1)^3}{(2n+1)^4 + 4}
\end{flalign*}

Вычислим значение суммы для нескольких значений $n$.

\begin{flalign*}
  & P(0): \frac{1^3}{1^4+4} = \frac{1}{5} & \\
  & P(1) = P(0) - \frac{3^3}{3^4 + 4} = -\frac{2}{17} & \\
  & P(2) = P(1) + \frac{5^3}{5^4 + 4} = \frac{3}{37} & \\
  & P(3) = P(2) + \frac{7^3}{7^4 + 4} = -\frac{4}{65} & \\
\end{flalign*}

Заметим, что в числителе стоит $n+1$, знак меняется как $(-1)^n$, а в знаменателе имеем ряд чисел $5, 17, 37, 65, ...$. Уменьшив значения ряда на $1$, получим $4, 16, 36, 64, ...$. Поделив значения ряда на $4$, получим ряд $1, 4, 9, 16, ...$, состоящий из квадратов $n+1$. Таким образом, можно предположить, что

\begin{flalign*}
  & \sum_{0 \geq i \geq n} \frac{(-1)^n (2n + 1)^3}{(2n + 1)^4 + 4} = \frac{(-1)^n (n+1)}{4(n+1)^2 + 1} & \\
\end{flalign*}

Утверждение $P(0)$ справедливо, также как $P(1), P(2)$ и $P(3)$. Предполагая по индукции справедливость $P(0), P(1), \cdots, P(n)$, докажем $P(n+1)$.

\begin{flalign*}
  & P(n+1): P(n) + \frac{(-1)^{n+1} (2 (n+1) + 1)^3}{(2 (n+1) + 1)^4 + 4} = 
  \frac{(-1)^n (n+1)}{4(n+1)^2 + 1} + \frac{(-1)^{n+1} (2n+3)^3}{(2n+3)^4 + 4} & \\
\end{flalign*}

Для четного $n$ первое слагаемое положительное, второе --- отрицательное, итоговая сумма также отрицательная.

\begin{flalign} \label{eq:1_2_1__11_1}
  & \frac{(n+1)}{4(n+1)^2 + 1} - \frac{(2n+3)^3}{(2n+3)^4 + 4} = - \frac{(n+2)}{4(n+2)^2 + 1} &
\end{flalign}

Докажем, что равенство \ref{eq:1_2_1__11_1} выполняется.

\begin{flalign*}
  & \frac{(n+1)}{4(n+1)^2 + 1} + \frac{(n+2)}{4(n+2)^2 + 1} = & \\
  & \frac{(n+1)}{4(n^2+2n+1) + 1} + \frac{(n+2)}{4(n^2+4n+4) + 1} =
  \frac{(n+1)}{4n^2+8n+5} + \frac{(n+2)}{4n^2+16n+17} = & \\
  & \frac{(n+1)(4n^2+16n+17) + (n+2)(4n^2+8n+5)}{(4n^2+16n+17)(4n^2+8n+5)} = & \\
  & \frac{4n^3+16n^2+17n+4n^2+16n+17+4n^3+8n^2+5n+8n^2+16n+10}{16n^4+32n^3+20n^2+64n^3+128n^2+80n+68n^2+136n+85} & \\
  & \frac{8n^3+36n^2+54n+27}{16n^4+96n^3+216n^2+216n+85} = \frac{(2n+3)^3}{(2n+3)^4 + 4} & \\
\end{flalign*}

Таким образом, для четного $n$ утверждение $P(n+1)$ доказано. Для нечетного $n$ доказательство аналогично. Необходимо лишь домножить обе части выражения \ref{eq:1_2_1__11_1} на $-1$.

\subsubsection{12.}

Покажите, как можно обобщить алгоритм E, чтобы, как было показано в тексте, для него допускались входные значения вида $u+v \sqrt{2}$, где $u$ и $v$ --- целые числа, и вычисления по прежнему выполнялись элементарным образом (т.е. не выражая иррациональное число $\sqrt{2}$ бесконечной дробью). Докажите, что при $m=1$ и $n=\sqrt{2}$ выполнение алгоритма никогда не закончится.

Для чисел вида $u+v \sqrt{2}$ деление и умножение на число $w+x \sqrt{2}$ дает

\begin{flalign*}
  & \frac{u+v \sqrt{2}}{w+x \sqrt{2}} = 
  \frac{u+v \sqrt{2}}{w+x \sqrt{2}} \cdot \frac{w-x \sqrt{2}}{w-x \sqrt{2}} =
  \frac{u w - u x \sqrt{2} + v w \sqrt{2} - 2 v x}{w^2 -2 x^2} = & \\
  & \frac{uw -2vx}{w^2 -2 x^2} + \frac{vw-ux}{w^2 -2 x^2} \sqrt{2} & \\
  & (u+v \sqrt{2})(w+x \sqrt{2}) = uw + ux \sqrt{2} + vw \sqrt{2} + 2vx = (uw + 2vx) + (ux + vw) \sqrt{2} & \\
\end{flalign*}

Однако в алгоритме E нужно найти результат деления двух чисел на цело, что можно реализовать через подсчет количества вычитаний делителя из делимого до тех пор, пока делимое больше 0.

Как проверить, что делимое больше 0? Для сравнения двух чисел перенесем в левую часть неравенства свободные слагаемые, а в правую --- множители $\sqrt{2}$:

\begin{flalign*}
  & u + v \sqrt{2} \textrm{ (?) } w + x \sqrt{2}  & \\
  & u - w \textrm{ (?) } (x - v) \sqrt{2}  & \\
\end{flalign*}

Если знак правой и левой части неравенства отличается, то ответ очевиден. Если знаки совпадают, возведем в квадрат обе части неравенства:

\begin{flalign*}
  & y \textrm{ (?) } z \sqrt{2}  & \\
  & y^{2} \textrm{ (?) } 2z^{2}  & \\
\end{flalign*}

В результате получаем сравнение двух целых чисел.

Операция вычитания чисел кажется тривиальной:

\begin{flalign*}
  & (u+v \sqrt{2})-(w+x \sqrt{2}) = (u-w) + (v-x) \sqrt{2} & \\
\end{flalign*}

В остальном алгоритм остается прежним.

Для чисел $m=1$ и $n=\sqrt{2}$ первые итерации алгоритма Евклида выглядят следующим образом:

\begin{tabularx}{0.8\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X 
  | >{\centering\arraybackslash}X | }
 \hline  & $m$ & $n$ & $d$ & $q$ & $\lfloor \frac{m*10}{n} \rfloor$ & $\lfloor \frac{m*100}{n} \rfloor$ & $\frac{m}{n}$ \\
 \hline  1 & $1$  & $\sqrt{2}$  & $1$ & $0$ & $7$ & $70$ &  \\
 \hline  2 & $\sqrt{2}$  & $1$  & $-1+\sqrt{2}$ & $1$ & $14$ & $141$ &  \\
 \hline  3 & $1$  & $-1+\sqrt{2}$  & $3-2\sqrt{2}$ & $2$ & $24$ & $241$ & $1+\sqrt{2}$  \\
 \hline  4 & $-1+\sqrt{2}$ & $3-2\sqrt{2}$ & $-7+5\sqrt{2}$ & $2$ & $24$ & $241$ & $1 + \sqrt{2}$  \\
 \hline  5 & $3-2\sqrt{2}$ & $-7+5\sqrt{2}$ & $17-12\sqrt{2}$ & $2$ & $24$ & $241$ & $1+\sqrt{2}$ \\
 \hline
\end{tabularx}

Можно предположить, что при $n >= 3$ $\frac{m}{n} = 1 + \sqrt{2}$, $q=2$, $d = -2n + m = -2n + (1+\sqrt{2})n = n(-1+\sqrt{2})$. Проверим, для первых $n$:

\begin{flalign*}
  & (-1+\sqrt{2})(1+\sqrt{2}) = 2-1 = 1 = m_3& \\
  & (-1+\sqrt{2})(-1+\sqrt{2}) = 1-2\sqrt{2}+2 = 3-2\sqrt{2} = d_3& \\
  & (3-2\sqrt{2})(1+\sqrt{2}) = 3-2\sqrt{2}+3\sqrt{2}-4 = -1+\sqrt{2} = m_4 & \\
  & (3-2\sqrt{2})(-1+\sqrt{2}) = -3+2\sqrt{2}+3\sqrt{2}-4 = -7+5\sqrt{2} = d_4 & \\
  & (-7+5\sqrt{2})(1+\sqrt{2}) = -7+5\sqrt{2}-7\sqrt{2}+10 = 3-2\sqrt{2} = m_5 & \\
  & (-7+5\sqrt{2})(-1+\sqrt{2}) = 7-5\sqrt{2}-7\sqrt{2}+10 = 17-12\sqrt{2} = d_5 & \\
\end{flalign*}


Докажем $P(n+1)$.

\begin{flalign*}
  & n_{n+1} = d_{n} \textrm{, } m_{n+1} = n_{n} & \\
  & \frac{m_{n+1}}{n_{n+1}} = \frac{n_n}{d_n} = \frac{n_n}{n_n(-1+\sqrt{2})}=
  \frac{1}{\sqrt{2}-1} = \frac{1+\sqrt{2}}{(\sqrt{2}-1)(\sqrt{2}+1)} & \\
  & \frac{1+\sqrt{2}}{2-1} = 1+\sqrt{2} & \\
\end{flalign*}

Отсюда $q_{n+1}=2$ и, следовательно, $d_{n+1} = n_{n+1}(-1+\sqrt{2})$. $n_{n+1} \neq 0$, $-1+\sqrt{2} \neq 0$ и $d_{n+1} \neq 0$.

\subsubsection{13.}

Обобщите алгоритм E, введя новую переменную $T$ и добавив в начале каждого шага операцию $T \leftarrow T + 1$. (Таким образом, переменная $T$ --- счетчик выполненных шагов.)

Предположим, что первоначальное значение $T$ равно нулю, поэтому утверждение $A1$ на рис. 4 примет вид $m>0, n>0, T=0$. Аналогично к $A2$ следует добавить дополнительное условие $T=1$. Покажите, как добавить к утверждениям дополнительные условия таким образом, чтобы из любого утверждения $A1, A2, \cdots, A6$ следовало, что $T \leq 3n$, и чтобы можно было провести доказательство по индукции. (Следовательно, вычисления должны закончиться максимум через $3n$ шагов.)

\includegraphics[scale=0.3]{ex_1_2_1_img_4_block_schema_e}

\begin{flalign*}
  & A1: T=0, m>0, n>0 & \\
  & A2: T=1, c=m>0, d=n>0, a=b'=0, a'=b=1 & \\
  & A3: T + 2 <= n - r + 2, am+bn=d, a'm+b'n=c=qd+r, 0 \leq r < d, \textrm{gcd}(c, d) = \textrm{gcd}(m,n) & \\
\end{flalign*}

Заметим, что на каждом шаге E2 выполняется условие $r<d$,следовательно $d-r \geq 1$.
Нижняя граница $n-r$ увеличивается на $1$ на каждой итерации алгоритма и достигает $n$ при $r=0$ максимум за $n$ итераций.

\begin{tabularx}{0.8\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $i$ & $T_6$ & $T_3$ & $T_5$ & $\inf (n-r)$ \\
 \hline  1 & --  & 2  & 3 & 1  \\
 \hline  2 & 4  & 5  & 6 & 2  \\
 \hline  3 & 7  & 8  & 9 & 3  \\
 \hline  $\cdots$ & $\cdots$  & $\cdots$  & $\cdots$ & $\cdots$  \\
 \hline  $i$ & $3i-2$  & $3i-1$  & $3i$ & $i$  \\
 \hline  $\cdots$ & $\cdots$  & $\cdots$  & $\cdots$ & $\cdots$  \\
 \hline  $last$ & $T-2$  & $T-1$  & $T \leq 3n$ & $n$  \\
 \hline
\end{tabularx}

Предположим на основании данных в таблице, что $T_5 \leq 3(n-r)$. Из этого следует, что $T_3$, $T_4$ и $T_6$ также $\leq 3(n-r)$. На основе известных утверждений об алгоритме E $r \geq 0$ на любом шаге алгоритма, следовательно $n-r \leq n$. $P(2)$, $P(3)$ следует из таблицы. Докажем по индукции $P(i+1)$.


\begin{flalign*} 
  & r_{i+1} < r_i & \\
  & T_5 \leq 3(n-r_i)& \\
  & T_{5_{i+1}} = T_{5_i} + 3 \leq 3(n-r_i)+3 = 3(n-r_i +1) \leq 3(n-r_{i+1}) & \\
  & T_{5_{i+1}} \leq 3(n-r_{i+1}) \leq 3n& \\
\end{flalign*}

\subsection{Числа, степени и логарифмы}

\subsubsection{1.}

Чему равно наименьшее положительное рациональное число?

Наименьшего положительного рационального числа не существует, т.к. для любого числа $\frac{1}{n}$ существует меньшее число $\frac{1}{n+1}$.

\subsubsection{2.}

Может ли выражение $1+0.239999999 \cdots$ быть десятичным представлением действительного числа?

Две записи в виде бесконечных десятичных дробей $1+0.23999999 \cdots$ и $1+0.2400000 \cdots$ являются представлением одного рационального числа $1 \frac{24}{100}$. По соглашениям, приведенным в данном параграфе, представление числа в виде десятичной дроби не может заканчиваться бесконечной последовательностью девяток.

\subsubsection{3.}

Чему равно $(-3)^{-3}$?

\begin{flalign*} 
  & (-3)^{-3} = -\frac{1}{27} & \\
\end{flalign*}

\subsubsection{4.}

Чему равно $(0.125)^{-\frac{2}{3}}$?

\begin{flalign*} 
  & (0.125)^{-\frac{2}{3}} = \Bigl (\frac{1}{8} \Bigl )^{-\frac{2}{3}} =
  8^{\frac{2}{3}} = (\sqrt[3]{8})^2 = 2^2 = 4 & \\
\end{flalign*}

\subsubsection{5.}

Мы определили действительные числа в терминах десятичного представления. Подумайте, как можно определить их в терминах двоичного представления, и приведите аналог соотношения (2).

\begin{flalign*} 
  & n + \frac{d_1}{2} + \frac{d_2}{4} + \cdots + \frac{d_k}{2^k}  \leq x <
  n + \frac{d_1}{2} + \frac{d_2}{4} + \cdots + \frac{d_k}{2^k} + \frac{1}{2^k} & \\
\end{flalign*}

\subsubsection{6.}

Пусть $x=m+0.d_1 d_2 \cdots$ и $y=n+0.e_1 e_2 \cdots$ --- действительные числа. Сформулируйте правило, которое на основе десятичного представления позвооляет определить, какое из неравенств верно: $x=y$, $x<y$ или $x>y$.


Если $m>n$, то $x>y$, если $m<n$, то $x<y$.
Если существует число $k$ такое, что для всех $i<k$ $d_i = e_i$, а $d_k \neq e_k$, то, при $d_k < e_k$ $x<y$, а при $d_k > e_k$ $x>y$. Если $m=n$, $d_i = e_i$ для всех $i$, то $x=y$.

\subsubsection{7.}

Для заданных чисел $x$ и $y$ докажите правила возведения в степень на основе определения (4).

\begin{flalign*} 
  & b^0 = 1, & \\
  & b^n = b^{n-1}b \textrm{, если } n>0 & \\
  & b^n = b^{n+1}/b \textrm{, если } n<0 & \\
\end{flalign*}

\begin{flalign*} 
  & b^{x+y} = b^x b^y & \\
\end{flalign*}

Для любого числа $x$ и для $y=0:$ $b^{x+0} = b^x b^0 = b^x$, т.к. $b^0=1$. Для $y=1:$ $b^{x+1} = b^x b$ согласно определению. Таким образом, $P(0)$ и $P(1)$ выполняются. Предположим по индукции, что $P(0)$, $P(1)$, $\cdots$, $P(n)$ выполняются. Тогда докажем, что выполняется и $P(n+1): b^{x+n+1} = b^x b^{n+1}$.

\begin{flalign*} 
  & b^{x+n+1} = b^{x+n} b = b^x b^n b = b^x b^{n+1} & \\
\end{flalign*}

Для $y=-1:$ $b^{x-1} = b^x/b$ согласно определению. Таким образом, $P(0)$ и $P(-1)$ выполняются. Предположим по индукции, что $P(0)$, $P(-11)$, $\cdots$, $P(-n)$ выполняются. Тогда докажем, что выполняется и $P(-n-1): b^{x-n-1} = b^x / b^{n+1}$.

\begin{flalign*} 
  & b^{x-n-1} = b^{x-n} / b = (b^x / b^n) / b = b^x / b^{n+1} & \\
\end{flalign*}


\begin{flalign*} 
  & (b^x)^y = b^{xy} & \\
\end{flalign*}

Для любого числа $x$ и для $y=0:$ $(b^x)^0 = 1 = b^0 = b^{x \cdot 0}$. Для $y=1:$ $(b^x)^1 = b^x = b^{x \cdot 1}$. Таким образом, $P(0)$ и $P(1)$ выполняются. Предположим по индукции, что $P(0)$, $P(1)$, $\cdots$, $P(n)$ выполняются. Тогда докажем, что выполняется и $P(n+1): (b^x)^{n+1} = b^{x(n+1)}$.

\begin{flalign*} 
  & (b^x)^{n+1} = (b^x)^n (b^x)^1 = b^{xn} b^x = b^{xn+x} = b^{x(n+1)} & \\
\end{flalign*}

Для $y=-1:$ $(b^x)^{-1} = 1/b^x = b^{-x} = b^{x \cdot (-1)}$. Таким образом, $P(0)$ и $P(-1)$ выполняются. Предположим по индукции, что $P(0)$, $P(-1)$, $\cdots$, $P(-n)$ выполняются. Тогда докажем, что выполняется и $P(-n-1): (b^x)^{-n-1} = b^{x(-n-1)}$.

\begin{flalign*} 
  & (b^x)^{-n-1} = (b^x)^{-n} (b^x)^{-1} = b^{-xn} b^{-x} = b^{-xn-x} = b^{x(-n-1)} & \\
\end{flalign*}

\subsubsection{8.}

Пусть $m$ -- целое положительное число. \emph{Докажите}, что у любого положительного действительного числа $u$ есть единственный положительный корень $m$-й степени, описав метод последовательного вычисления элементов десятичного представления этого корня: $n$, $d_1$, $d_2$, $\cdots$

Существует единственное целое число $n$ такое, что $ n^m \leq u < (n+1)^m $. Существует единственное целое число $0 \leq d_1 < 10$ такое, что $ (n + \frac{d_1}{10})^m \leq u < (n + \frac{d_1}{10} + \frac{1}{10})^m $. И так далее существует единственное целое число $0 \leq d_k < 10$ такое, что $ (n + \frac{d_1}{10} + \frac{d_2}{100} + \cdots + \frac{d_k}{10^k})^m \leq u <  (n + \frac{d_1}{10} + \frac{d_2}{100} + \cdots + \frac{d_k}{10^k} + \frac{1}{10^k})^m $.

\subsubsection{9.}

Для заданных рациональных чисел $x$ и $y$ докажите правила возведения в степень, предполагая, что эти правила выполняются для целых чисел $x$ и $y$.

\begin{flalign*} 
  & b^{x+y} = b^x b^y & \\
  & x = \frac{p}{q}, y = \frac{r}{s} & \\
  & b^{x+y} = b^{\frac{p}{q} + \frac{r}{s}} = b^{\frac{sp+qr}{qs}} =
  \sqrt[qs]{b^{(sp+qr)}} = \sqrt[qs]{b^{sp} b^{qr}} =
  \sqrt[qs]{b^{sp}} \sqrt[qs]{b^{qr}} = b^{\frac{sp}{qs}} b^{\frac{qr}{qs}} =
  b^{\frac{p}{q}} b^{\frac{r}{s}} = b^x b^y & \\
\end{flalign*}


Для доказательства $(b^x)^y = b^{xy}$ предварительно докажем, что $\sqrt[s]{\sqrt[q]{b}} = \sqrt[sq]{b}$. Для $s=1$ соотношение выполняется: $\sqrt[1]{\sqrt[q]{b}} = \sqrt[q]{b} = \sqrt[1 \cdot q]{b} $. Докажем, $P(n+1)$. Пусть $ v^{n+1} = v \cdot v^n = \sqrt[q]{b} $. Тогда

\begin{flalign*}
  & v = \sqrt[n+1]{\sqrt[q]{b}} & \\
  & b = (v^{n+1})^q = v^{q(n+1)} & \\
  &  v = \sqrt[q(n+1)]{b} & \\
\end{flalign*}

\begin{flalign*} 
  & (b^x)^y = b^{xy} & \\
  & x = \frac{p}{q}, y = \frac{r}{s} & \\
  & (b^x)^y = (b^{\frac{p}{q}})^{\frac{r}{s}} = \sqrt[s]{(b^{\frac{p}{q}})^r} =
  \sqrt[s]{(\sqrt[q]{b^p})^r} =
  \sqrt[s]{\underbrace{\sqrt[q]{b^p} \sqrt[q]{b^p} \cdots \sqrt[q]{b^p}}_{r \textrm{ раз}}} =
  \sqrt[s]{\sqrt[q]{\underbrace{b^p b^p \cdots b^p}_{r \textrm{ раз}}}} =
  \sqrt[s]{\sqrt[q]{(b^p)^r}} = \sqrt[s]{\sqrt[q]{b^{pr}}} =
  \sqrt[sq]{b^{pr}} = & \\
  & b^{\frac{pr}{sq}} = b^{\frac{p}{q} \frac{r}{s}} = b^{xy} & \\
\end{flalign*}

\subsubsection{10.}

Докажите, что $\log_{10}{2}$ не является рациональным числом.

Предположим, что существует число $r=\frac{p}{q}$ ($p$ -- целое, $q$ -- положительное целое) такое, что $10^r = 2$. Тогда

\begin{flalign*} 
  & 2 = 10^{\frac{p}{q}} & \\
  & 2^q = 10^p = 2^p \cdot 5^p & \\
\end{flalign*}

Таким образом, для целых $p$ и $q$ ($q>0$) имеем с одной стороны неравенства число кратное $5$, а с другой -- некратное $5$, чего быть не может.

\subsubsection{11.}

Если $b=10$ и $x \approx \log_{10}{2}$, то сколько десятичных знаков числа $x$ нужно знать, чтобы определить три первых десятичных знака в десятичном представлении $b^x$? [\emph{Замечание}. Можете использовать результаты упр. 10.]

Т.к. $\log_{10}{2}$ не является рациональным числом, то оно представимо в виде бесконечной десятичной дроби $n + \frac{d_1}{10} + \frac{d_2}{100} + \cdots + \frac{d_k}{10^k} + \cdots$ и для любого $k$ найдется число $m > k$ такое, что $d_m > 0$. При этом для любого $k$ рациональное число $10^{n + \frac{d_1}{10} + \frac{d_2}{100} + \cdots + \frac{d_k}{10^k}} < \log_{10}{2}$, а $10^{n + \frac{d_1}{10} + \frac{d_2}{100} + \cdots + \frac{d_k}{10^k} + \frac{1}{10^k}} > \log_{10}{2}$.

\subsubsection{12.}

Объясните, почему равенство $\log_{10}{2} = 0.30102999 \dots $ следует из равенств $10^{0.30102999}=1.9999999739 \dots$, $10^{0.30103000}=2.0000000199$.

Число $b$, представимое бесконечной десятичной дробью $n + \frac{d_1}{10} + \frac{d_2}{100} + \dots + \frac{d_k}{10^k} + \dots$, должно для любого $k$ удовлетворять соотношениям $n + \frac{d_1}{10} + \frac{d_2}{100} + \dots + \frac{d_k}{10^k} \leq k < n + \frac{d_1}{10} + \frac{d_2}{100} + \dots + \frac{d_k}{10^k} + \frac{1}{10^k}$.

\begin{flalign*} 
  & 1.9999999739 \leq 2 < 2.0000000199 & \\
  & 10^{0.30102999} \leq 10^{\log_{10}{2}} < 10^{0.30103000} & \\
  & 0.30102999 \leq \log_{10}{2} < 0.30103000  \textrm{ для } k=8 & \\
\end{flalign*}

Следовательно, первые 8 цифр $\log_{10}{2} = 0.30102999$.

\subsubsection{13.}

(a) Пусть $x$ --- положительное действительное число, а $n$ --- положительное целое число. Докажите неравенство $\sqrt[n]{1+x} - 1 \leq x/n$.

Для $n=1$

\begin{flalign*} 
  & 1 + x - 1 \textrm{ (?) } x & \\
  & x = x & \\
\end{flalign*}

Для $n=2$

\begin{flalign*} 
  & \sqrt{1 + x} - 1 \textrm{ (?) } x/2 & \\
  & \sqrt{1 + x} \textrm{ (?) } 1 + x/2 & \\
  & 1 + x \textrm{ (?) } (2 + x)^2/4 & \\
  & 4 + 4x \textrm{ (?) } 4 + 4x + x^2 & \\
  & 0 \leq x^2 & \\
\end{flalign*}

Предположим, что выполняются утверждения $P(0)$, $P(1)$, $\dots$, $P(n)$. Тогда для $n+1$

\begin{flalign*} 
  & \sqrt[n+1]{1+x} - 1 \textrm{ (?) } \frac{x}{n+1} & \\
  & \sqrt[n+1]{1+x} \textrm{ (?) } \frac{n+1+x}{n+1} & \\
  & 1+x \textrm{ (?) } \Bigl (1 + \frac{x}{n+1} \Bigl )^{n+1} & \\
  & 1+x \leq \Bigl (1 + \frac{x}{n} \Bigl )^{n} \textrm{ (по предположению индукции)} & \\
  & \Bigl (1+\frac{x}{n} \Bigl )^{n} \textrm{ (?) } \Bigl (1+\frac{x}{n+1} \Bigl )^{n+1} & \\
  & \Bigl (\frac{n+x}{n} \Bigl )^{n} \textrm{ (?) } \Bigl (\frac{n+1+x}{n+1} \Bigl )^{n+1} & \\
  & \frac{(n+1)^{n+1}}{n^n} \textrm{ (?) } \frac{(n+1+x)^{n+1}}{(n+x)^n} & \\
  & (n+1)\Bigl (\frac{n+1}{n} \Bigl)^n \textrm{ (?) } (n+1+x)\Bigl (\frac{n+1+x}{n+x}\Bigl )^n & \\
  & 1 \textrm{ (?) } \frac{n+1+x}{n+1} \Bigl (\frac{n}{n+1} \Bigl)^n \Bigl (\frac{n+1+x}{n+x}\Bigl )^n & \\
  & (n+1)^{n+1}(n+x)^n \textrm{ (?) } (n+1+x)^{n+1} n^n & \\
  & n^n \leq (n+1)^{n+1} & \\
  & (n+x)^n \leq (n+1+x)^{n+1} & \\
\end{flalign*}

Мы зашли в тупик. Воспользуемся подсказкой из ответов. Обозначим $y = x/n$ и докажем $\sqrt[n]{1+ny} - 1 \leq y$.

\begin{flalign*}
  & \sqrt[n]{1+ny} - 1  \textrm{ (?) } y & \\
  & 1+ny \textrm{ (?) } (1+y)^n & \\
\end{flalign*}

Данная замена оставляет в силе наши предположения по индукции. Остается доказать, что $P(n+1): 1+(n+1)y \leq (1+y)^{n+1}$.

\begin{flalign*}
  & (1+y)^{n+1} = (1+y)(1+y)^n = \underbrace{(1+y)^n + (1+y)^n \dots (1+y)^n}_{(1+y) \textrm{ раз}}  & \\
\end{flalign*}

Т.к. по предположению индукции $1+ny \leq (1+y)^n$ выполняется, то остается сравнить $y$ и $\underbrace{(1+y)^n + (1+y)^n \dots (1+y)^n}_{y \textrm{ раз}}$.

\begin{flalign*}
  & y \leq \underbrace{(1+y)^n + (1+y)^n \dots (1+y)^n}_{y \textrm{ раз}} & \\
  & 1+ny \leq (1+y)^n & \\
  & 1+(n+1)y \leq (1+y)^{n+1} & \\
\end{flalign*}

Таким образом, мы доказали, что

\begin{flalign*}
  & 1+ny \leq (1+y)^n & \\
  & 1+x \leq (1+\frac{x}{n})^n & \\
  & \sqrt[n]{1+x} \leq 1+\frac{x}{n} & \\
  & \sqrt[n]{1+x} - 1 \leq \frac{x}{n} & \\
\end{flalign*}

(b) Используйте полученный результат для доказательства утверждения.

\begin{flalign*}
  & b^{n+d_1/10 + \dots + d_k/10^k} (b^{1/10^k}-1) < b^{n+1}(b-1)/10^k & \\
\end{flalign*}

Т.к. $b>1$, то

\begin{flalign*}
  & n+d_1/10 + \dots + d_k/10^k < n+1 & \\
  & b^{n+d_1/10 + \dots + d_k/10^k} < b^{n+1} & \\
\end{flalign*}

Остается сравнить $b^{1/10^k}-1$ и $(b-1)/10^k$. Обозначим $x=b-1$, $n=10^k$ и получим уже доказанное выражение: $(x+1)^{1/n}-1 = \sqrt[n]{x+1}-1 \leq x/n$.

\subsubsection{14.}

Докажите равенство $\log_{b}{(c^y)} = y \log_{b}{c}$, если $c>0$.

Представим степень через произведение и докажем утверждение с помощью свойства логарифма произведения.
\begin{flalign*}
  & \log_{b}{(c^y)} =
  \log_{b}{(\underbrace{c \cdot c \dots c}_{y \textrm{ раз}})}  =
  \underbrace{\log_{b}{c}+\log_{b}{c}+\cdots+\log_{b}{c}}_{y \textrm{ раз}} =
  y \log_{b}{c} & \\
\end{flalign*}

Другой вариант доказательства по определению логарифма. Пусть $\log_{b}{c} = x$, тогда
\begin{flalign*}
  & b^x = c & \\
  & (b^x)^y = b^{xy} = c^y . & \\
\end{flalign*}

Отсюда $xy = \log_{b}{(c^y)} = y \log_{b}{c}$.

\subsubsection{15.}

Докажите или опровергните следующее равенство:

\begin{flalign*}
  \log_{b}{x/y}=\log_{b}{x}-\log_{b}{y} \textrm{ при } x,y > 0. \\
\end{flalign*}

Используя свойства логарифмов получаем доказательство:
\begin{flalign*}
  & \log_{b}{x/y} = \log_{b}{\Bigl (x(y)^{-1} \Bigl )} = \log_{b}{x} + \log_{b}{(y^{-1})} =\log_{b}{x}-\log_{b}{y} . & \\
\end{flalign*}

\subsubsection{16.}

Как можно выразить $\log_{10}{x}$ через $\ln{x}$ и $\ln{10}$?

\begin{flalign*}
  & \log_{10}{x} = \frac{\ln{x}}{\ln{10}}, \textrm{ так как} & \\
  & (\log_{10}{x}) (\ln{10}) =  \ln{10^{\log_{10}{x}}} = \ln{x} & \\
\end{flalign*}

\subsubsection{17.}

Чему равны $\lg{32}$, $\log_{\pi}{\pi}$, $\ln{e}$, $\log_{b}{1}$ и $\log_{b}{(-1)}$?

\begin{flalign*}
  & \lg{32}=5, \ \ \log_{\pi}{\pi}=1, \ \ \ln{e}=1, \ \ \log_{b}{1}=0, & \\
  & \log_{b}{(-1)} \textrm{ --- не существует. } & \\
\end{flalign*}

\subsubsection{18.}

Докажите или опровергните следующее равенство: $\log_{8}{x}=\frac{1}{2}\lg{x}$.

\begin{flalign*}
  & \log_{8}{x} = \frac{\lg{x}}{\lg{8}} = \frac{\lg{x}}{3} = \frac{1}{3}\lg{x}
  \neq \frac{1}{2}\lg{x} .& \\
\end{flalign*}

\subsubsection{19.}

Поместится ли целое число $n$, десятичное представление которого состоит из 14 цифр, в компьютерном слове емкостью 47 бит плюс бит знака?

Один бит может хранить $2^1=2$ числа: $0$ и $1$, в $n$ бит можно записать $2^n$ чисел от $0$ до $2^n -1$. Добавление знакового бита позволяет сохранить ещё $2^n$ чисел от $-1$ до $-2^n$.

Один десятичный разряд может представлять $10$ чисел от $0$ до $9$. С помощью $n$ десятичных разрядов можно представить $10^n$ чисел от $0$ до $10^n-1$. Таким образом, нам нужно сравнить числа $2^{47}$ и $10^{14}$.

\begin{flalign*}
  & 0.30102999 \leq \log_{10}{2} < 0.30103 & \\
  & 14 / 0.30102999 = 46.5069942034679 < 46.6 & \\
  & 14 / 0.30103 = 46.50699265853901 < 46.6 & \\
  & 10^{0.30102999} \leq 2 < 10^{0.30103} & \\
  & (10^{0.30102999})^{47} \leq 2^{47} < (10^{0.30103})^{47} & \\
  & 10^{14} < (10^{0.30102999})^{46.6} < (10^{0.30102999})^{47} \leq 2^{47} & \\
\end{flalign*}

Таким образом, для хранения числа из $14$ десятичных знаков необходимо минимум $47$ бит.


\subsubsection{20.}

Существует ли простое соотношение, связывающее $\log_{10}{2}$ и $\log_{2}{10}$?

\begin{flalign*}
  & \log_{10}{2} = \frac{\ln{2}}{\ln{10}} & \\
  & \log_{2}{10} = \frac{\ln{10}}{\ln{2}} & \\
  & \log_{10}{2} = (\log_{2}{10})^{-1} & \\
\end{flalign*}

\subsubsection{21.} (\emph{Логарифмы от логарифмов}.) Выразите $\log_{b}{\log_{b}{x}}$ через $\ln{\ln{x}}$, $\ln{\ln{b}}$ и $\ln{b}$.

\begin{flalign*}
  & \log_{b}{x} = \frac{\ln{x}}{\ln{b}} & \\
  & \log_{b}{\log_{b}{x}} = \frac{\ln{\log_{b}{x}}}{\ln{b}} =
  \frac{\ln{\frac{\ln{x}}{\ln{b}}}}{\ln{b}} =
  \frac{\ln{\ln{x}}-\ln{\ln{b}}}{\ln{b}}. & \\
\end{flalign*}

\subsubsection{22.}

(Р.В. Хемминг (R.W. Hamming).) Докажите, что

\begin{flalign*}
  \lg{x} \approx \ln{x} + \log_{10}{x}
\end{flalign*}
с погрешностью, не превышающей $1\%$! (Такми образом, таблицы натуральных и десятичных логарифмов можно использовать и для получения приближенных значений двоичных логарифмов.)

\begin{flalign*}
  & \ln{x} = \frac{\lg{x}}{\lg e} & \\
  & \log_{10}{x} = \frac{\lg{x}}{\lg {10}} & \\
  & \ln{x} + \log_{10}{x} = \frac{\lg{x}}{\lg{e}} + \frac{\lg{x}}{\lg {10}} =
  \lg {x}((\lg{e})^{-1} + (\lg{10})^{-1}) =
  \lg{x}(\ln{2} + \log_{10}{2}) & \\
  & \lg{x} = \frac{\ln{x} + \log_{10}{x}}{\ln{2} + \log_{10}{2}} & \\
  & 0.69314718 \leq \ln{2}                < 0.69314719 & \\
  & 0.30102999 \leq \log_{10}{2}          < 0.30103 & \\
  & 0.99417716 \leq \ln{2} + \log_{10}{2} < 0.99417719 . & \\
\end{flalign*}

Оценим погрешность.

\begin{flalign*}
  & \frac{\Big|\lg{x} - (\ln{x} + \log_{10}{x})\Big|}{\lg{x}} =
  \frac
      {\Big|\frac{\ln{x} + \log_{10}{x}}{\ln{2} + \log_{10}{2}} -
        (\ln{x} + \log_{10}{x})\Big|}
      {\frac{\ln{x} + \log_{10}{x}}{\ln{2} + \log_{10}{2}}} =
  \frac
      {\Big|\ln{x} + \log_{10}{x} -
        (\ln{x} + \log_{10}{x})(\ln{2} + \log_{10}{2})\Big|}
      {\ln{x} + \log_{10}{x}} = & \\
  & \frac
      {\Big|(\ln{x} + \log_{10}{x})(1-(\ln{2} + \log_{10}{2}))\Big|}
      {\ln{x} + \log_{10}{x}} = 
  \Big|(1-(\ln{2} + \log_{10}{2}))\Big| & \\
  & -0.99417719 \leq -(\ln{2} + \log_{10}{2}) < -0.99417716 & \\
  & 1-(\ln{2} + \log_{10}{2}) < 1-0.99417716 = 0.00582284 < 0.01 & \\
  & 1-(\ln{2} + \log_{10}{2}) \geq 1-0.99417719 = 0.00582281 > -0.01 & \\
  & \Big|1-(\ln{2} + \log_{10}{2})\Big| < 0.01 & \\
\end{flalign*}

\subsubsection{23.}

\includegraphics[scale=0.3]{ex_1_2_2_img_6_natural_log}

С помощью рис. 6 дайте \emph{геометрическое} доказательство того, что
\begin{flalign*}
  \ln{xy} = \ln{x} + \ln{y}.
\end{flalign*}

\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{ex_1_2_2_img_6_1_Natural_log}
  \caption{Гипербола и логарифм ($x=4$, $y=25$).}
\end{figure}


Известно, что $\ln{xy}$ равен площади криволинейной трапеции под кривой $f(i) = \frac{1}{i}$ на отрезке $[1; \ xy]$, т.е. $\int\limits_1^{xy} \frac{1}{i} \ di $.

\begin{flalign*}
  & \int\limits_1^{xy} \frac{1}{i} \ di =
  \int\limits_1^{x} \frac{1}{i} \ di + \int\limits_{x}^{xy} \frac{1}{i} \ di =
  \int\limits_1^{y} \frac{1}{i} \ di + \int\limits_{y}^{xy} \frac{1}{i} \ di & \\
\end{flalign*}

Докажем, что

\begin{flalign*}
  & \int\limits_1^{x} \frac{1}{i} \ di = \int\limits_{y}^{xy} \frac{1}{i} \ di & \\
  & \int\limits_1^{y} \frac{1}{i} \ di = \int\limits_{x}^{xy} \frac{1}{i} \ di & \\
\end{flalign*}

\begin{figure}[h]
  \centering
  \includegraphics[width=\textwidth]{ex_1_2_2_img_6_2_log_x}
  \caption{Логарифм $x$ для $x=4$, $y=25$, $t_0=1$.}
\end{figure}

Рассмотрим $\ln{x}$. Его значение равно площади под гиперболой на отрезке $[1..x]$: $S [1..x] \frac{1}{i}$. Сожмем фигуру под гиперболой в $y$ раз относительно оси $OY$. Площадь фигуры $S [1..x] \frac{1}{y i}$ также уменьшится в $y$ раз. Затем растянем получившуюся фигуру вдоль оси $OX$ относительно вертикальной линии $y=1$ в $y$ раз (в результате площадь снова станет равной $\ln{x}$). Выполним соответствующие преобразования над кривой $\frac{1}{y i}$.

\begin{flalign*}
  & \textrm{Сначала сдвинем график влево на $1$: } && \frac{1}{y (i+1)}. & \\
  & \textrm{Длина исходной фигуры равна $x-1$.} &&& \\
  & \textrm{Длина растянутой фигуры: } && (x-1)*y & \\
\end{flalign*}

Нам нужно, чтобы значение функции равное $\ln{x}$, которое после смещения влево находится в $x-1$, переместилось в точку $y(x-1)$.

\begin{flalign*}
  & \textrm{Растянем график в $y$ раз: } && \frac{1}{y (\frac{i}{y}+1)}. & \\
  & \textrm{Сместим график вправо на $y$: } && \frac{1}{y (\frac{i-y}{y}+1)} =
  \frac{1}{i}. & \\
\end{flalign*}

Мы получили фигуру, которая лежит под кривой $\frac{1}{i}$ на отрезке $[y..xy]$. Её площадь равна $\ln{x}$. Но она же равна $\ln{xy}-\ln{y}$.

\subsubsection{24.}

Объясните, как нужно модифицировать метод вычисления логарифмов по основанию 10, приведенный в конце раздела, чтобы его можно было применить для вычисления логарифмов по основанию 2.

Предложенный метод основан на том, что
\begin{flalign*}
  & 1 \leq x_k = x^{2^k}/10^{2^k(n+b_1/2+\dots+b_k/2^k)} < 10 & \\
  & 10^{2^k(n+b_1/2+\dots+b_k/2^k)} \leq x^{2^k} <
    10^{2^k(n+b_1/2+\dots+b_k/2^k)+1} & \\
  & 10^{n+b_1/2+\dots+b_k/2^k} \leq x < 10^{n+b_1/2+\dots+b_k/2^k+1/2^k} & \\
\end{flalign*}

Действительно:
\begin{flalign*}
  & x_0 = \Bigl(\frac{x}{10^n}\Bigl); & \\
  & x_1 = \Bigl(\frac{x}{10^n}\Bigl)^2*\frac{1}{10^{b_1}} =
  \Bigl(\frac{x}{10^n}\Bigl)^2*\Bigl(\frac{1}{10^{\frac{b_1}{2}}}\Bigl)^2 =
  \frac{x^{2^1}}{10^{2^1(n+\frac{b_1}{2})}} & \\
  & x_2=\Bigl(\frac{x^{2}}{10^{2(n+\frac{b_1}{2})}}\Bigl)^2*\frac{1}{10^{b_2}} =
  \Bigl(\frac{x^{2}}{10^{2(n+\frac{b_1}{2})}}\Bigl)^2*
    \Bigl(\frac{1}{10^{\frac{b_2}{4}}}\Bigl)^4 =
    \frac{x^{2^2}}{10^{2^2(n+\frac{b_1}{2}+\frac{b_2}{4})}} & \\
  & \cdots & \\
  & x_k=\frac{x^{2^k}}{10^{2^k(n+b_1/2+\dots+b_k/2^k)}}  & \\
  & (x^{2^k})^2 = x^{2^k \cdot 2^1} = x^{2^{k+1}} & \\  
  & x_{k+1}=\Bigl(\frac{x^{2^k}}{10^{2^k(n+b_1/2+\dots+b_k/2^k)}}\Bigl)^2*
    \Bigl(\frac{1}{10^{\frac{b_{k+1}}{2^{k+1}}}}\Bigl)^{2^{k+1}} =
  \frac{x^{2^{k+1}}}{10^{2^{k+1}(n+b_1/2+\dots+b_k/2^k + b_{k+1}/2^{k+1})}} & \\  
\end{flalign*}

Модифицируем предложенный метод в соответствии с заданием.
\begin{flalign*}
  & 2^{n+b_1/2+\dots+b_k/2^k} \leq x < 2^{n+b_1/2+\dots+b_k/2^k+1/2^k} & \\
  & 2^{2^k(n+b_1/2+\dots+b_k/2^k)} \leq x^{2^k} <
    2^{2^k(n+b_1/2+\dots+b_k/2^k)+1} & \\
  & 1 \leq x_k = x^{2^k}/2^{2^k(n+b_1/2+\dots+b_k/2^k)} < 2 & \\
\end{flalign*}

Сначала сдвинем десятичную точку в числе $x$ влево или вправо, чтобы получить $1 \leq x/2^n < 2$; таким образом мы определим целую часть числа $\lg{x}$, т.е. $n$. Чтобы найти значения $b_1$, $b_2$, $\cdots$, положим $x_0=x/10^n$ и для $k \geq 1$ получим
\begin{flalign*}
  & b_k = 0, & x_k=x_{k-1}^2, && \textrm{если} && x_{k-1}^2 < 2; && \\
  & b_k = 1, & x_k=x_{k-1}^2/2, && \textrm{если} && x_{k-1}^2 \geq 2. && \\
\end{flalign*}

\subsubsection{25.}
Предположим, что у нас есть двоичный компьтер (т.е. компьютер, в котором используется двоичная система счисления. --- \textit{Прим. перев.}) и имеется некоторое число $x$, $1 \leq x < 2$. Покажите, что следующий алгоритм, в котором используются только операции сдвига, сложения и вычитания в объеме, пропорциональном числу разрядов, которое определяется требуемой степенью точности, можно применить для приближенного вычисления $y=\log_{b}{x}$.

\textbf{L1.} [Инициализация.] Присвоить $y \leftarrow 0$, $z \leftarrow x$ с помощью сдвига вправо на $1$, $k \leftarrow 1$.

\textbf{L2.} [Проверка окончания.] Если $x=1$, то прекратиь выполнение.

\textbf{L3.} [Сравнение.] Если $x-z<1$, то присвоить $z \leftarrow z$ с помощью сдвига вправо на $1$, $k \leftarrow k+1$, и повторить этот шаг.

\textbf{L4.} [Замещение значений.] Присвоить $x \leftarrow x-z$, $z \leftarrow x$ с помощью сдвига вправо на $k$, $y \leftarrow y+\log_{b}{2^k/(2^k-1)}$ и перейти к шагу L2. $\bigl \bracevert$

[\textit{Замечание.} Описанный метод очень похож на тот метод, который используется в компьютерах для выполнения операции деления. Эта идея, в сущности, принадлежит Генри Бриггсу (Henry Briggs); он применял данный метод (только не к двоичным, а к десятичным операциям) для вычисления таблиц логарифмов, опубликованных в 1624 году. Нам нужна дополнительная таблица констант $\log_b{2}$, $\log_b{(4/3)}$, $\log_b{(8/7)}$ и т.д. до значения, равного точности компьютера. В данном алгоритме преднамеренно делается ошибка, так как числа сдвигаются вправо с тем, чтобы в конечном счете $x$ свелось к $1$ и выполнение алгоритма прекратилось. В этом упражнении вы должны показать, что алгоритм конечен и вычисляет приближенное значение $\log_b{x}$.]

Рассмотрим условия, которые выполняются в процессе рабоы алгоритма.

A1. $1 \leq x < 2$, $y=0$, $0<z<1$, $k=1$, $z<x$, $\frac{x}{z}=2$.

A2.

A3. $0 \leq z < 1$, $k \geq 1$, $x-z \geq 1$, $z<x$.

A4. $1 \leq x<2$, $0 \leq z<1$, $k \geq 1$, $2^k \geq 2$, $1<\frac{2^k}{2^k-1} \leq 2$, $z<x$.

Доказать применимость алгоритма для вычисления приближенных значений $\log_{b}{x}$ можно, сравнив значения переменной $y$ на каждой итерации алгоритма с точным значением $\log_{b}{x}$.

\begin{flalign*}
  & y = \log_b{\frac{2^{k_1}}{2^{k_1}-1}} + \log_b{\frac{2^{k_2}}{2^{k_2}-1}} +
  \cdots + \log_b{\frac{2^{k_n}}{2^{k_n}-1}}.& \\
\end{flalign*}

Рассмотрим свойства последовательности $k_1$, $k_2$, $\cdots$, $k_n$.

В результате выполнения алгоритма число $x$ последовательно уменьшается на величину $z$:

\begin{flalign*}
  & x_1 = x - \frac{x}{2^{k_1}} = x(1 - \frac{1}{2^{k_1}}) = x \frac{2^{k_1}-1}{2^{k_1}}; & \\
  & x_2 = x_1(1 - \frac{1}{2^{k_2}}) = x_1 \frac{2^{k_2}-1}{2^{k_2}}; & \\
  & \cdots & \\
  & x_n = x_{n-1} \frac{2^{k_n}-1}{2^{k_n}} \approx 1. & \\
\end{flalign*}

Таким образом $x$ приближенно можно представить в виде дроби:
\begin{flalign} \label{eq:1_2_2__25_1}
  & x = \frac{2^{k_1}}{2^{k_1}-1} x_1 =
  \frac{2^{k_1} 2^{k_2}}{(2^{k_1}-1)(2^{k_2}-1)} x_2 =
  \cdots \approx
  \frac{2^{k_1} 2^{k_2}\cdots 2^{k_n}}{(2^{k_1}-1)(2^{k_2}-1)\cdots(2^{k_n}-1)}.&
\end{flalign}

Соответственно:
\begin{flalign*}
  & y = \log_b{x} \approx \log_b{
    \frac{2^{k_1}2^{k_2}\cdots 2^{k_n}}{(2^{k_1}-1)(2^{k_2}-1)\cdots(2^{k_n}-1)}}=
  \log_b{\frac{2^{k_1}}{2^{k_1}-1}} + \log_b{\frac{2^{k_2}}{2^{k_2}-1}} +
  \cdots + \log_b{\frac{2^{k_n}}{2^{k_n}-1}}.& \\
\end{flalign*}

Докажем конечность алгоритма. Считаем, что алгоритм будет выполняться бесконечно тогда и только тогда, когда на одной из итераций перед шагом \textbf{L4} $x>1$, а $z=0$.

На всех шагах алгоритма кроме последнего $x>1$. Если $x>1$, то такое число представляется в виде единицы перед запятой и некоторого количества единиц после. При сдвиге вправо на $k$ разрядов единица перед запятой будет сдвигаться вправо. При этом важно, чтобы $k$ не превышало числа разрядов после запятой до тех пор, пока число $x>1$. Это так, потому что $k$ последовательно увеличивается на $1$ только в том случае, если $z$ настолько велико, чтобы сделать $x < 1$. А в этом случае $z$ содержит хотя бы одну единицу не в последнем разряде, соответственно $k$ меньше числа разрядов.  Поэтому всегда найдется такое $z$, получаемое в результате сдвига числа $x$ на $k$ разрядов вправо, что либо $x-z < x$ и $z>0$, либо $x=1$.

\subsubsection{26.}

Определите верхние границы точности алгоритма из предыдущего упражнения, взяв за основу точность, используемую в арифметических операциях.

Предыдущий алгоритм вычисляет логарифмы с определенной погрешностью $\delta$. Истинное значение логарифма лежит в интервале $[y-\delta; y+\delta]$. Точностью алгоритма можно считать разность между верхней и нижней границами данного интервала $2\delta$. Требуется определить каким образом точность ограничена сверзху.

Пусть $p$ -- количество разрядов после двоичной точки. После выполнения шага \textbf{L4} $z=\frac{x_i}{2^k}$. Если $z=0$, то $k=p+1$, т.к. $x \geq 1$ и чтобы обнулить его сдвигом вправо нужно сдвинуть единицу в целой части на $k+1$ разрядов. Как уже показано, такого не может быть, т.е. $z>0$.

Действительное число $x$ может быть представлено в компьютере в виде числа в двоичной системе счисления с фиксированным количеством разрядов после запятой. В формуле \ref{eq:1_2_2__25_1} для представления $x$ используется деление на 2, а в алгоритме -- сдвиг вправо на 1. Сдвиг отличается от деления, например в двоичной системе счисления и четырьмя разрядами после точки $10.0001>>1=1.0000$, хотя истинное значение $10.0001/2=1.00001$. Таким образом, на каждой итерации значения $z$ и $x$ вычисляются с точностью $\frac{1}{2^p}$. Количество итераций не может превышать $p$, следовательно общая погрешность вычислений должна быть меньше $\frac{p}{2^p}$. С другой стороны мы ограничены точностью компьютера $\frac{1}{2^p}$.

\subsubsection{27.}

Рассмотрим метод вычисления $\log_{10}{x}$, описанный в этом разделе. Пусть $x_k'$ --- вычисленное приближенное значение $x_k$, причем $x_0$ определяется из соотношения $x(1-\delta) \leq 10^n x_0' \leq x(1+\epsilon)$, а $x_k'$ --- из соотношений
\begin{flalign*}
  & b_k = 0, & x_k=x_{k-1}^2, && \textrm{если} && x_{k-1}^2 < 10; && \\
  & b_k = 1, & x_k=x_{k-1}^2/10, && \textrm{если} && x_{k-1}^2 \geq 10, && \\
\end{flalign*}
где выражение $(x_{k-1}')^2$ нужно заменить на $y_k$ и $(x_{k-1}')^2(1-\delta) \leq y_k \leq (x_{k-1}')^2(1+\epsilon)$, где $1\leq y_k < 100$. В этих формулах $\delta$ и $\epsilon$ --- малые константы, соответствующие верхней и нижней границам погрешностей округления. Покажите, что если результат вычислений обозначить $\log'{x}$, то через $k$ шагов мы получим
\begin{flalign*}
  & \log_{10}{x} + 2 \log_{10}{(1-\delta)} - 1/2^{k} < \log'{x} \leq
  \log_{10}{x} + 2\log_{10}(1+\epsilon). & \\
\end{flalign*}

Данный метод вычислений логарифмов основан на том, что
\begin{flalign*}
  & 10^{n+b_1/2+b_2/4+\cdots+b_k/{2^k}} \leq x=10^y < 10^{n+b_1/2+b_2/4+\cdots+b_k/{2^k}+1/{2^k}}; & \\
  & 10^{2^k(n+b_1/2+b_2/4+\cdots+b_k/{2^k})} \leq x^{2^k} < 10^{2^k(n+b_1/2+b_2/4+\cdots+b_k/{2^k})+1}; & \\
  & 1 \leq x^{2^k}/10^{2^k(n+b_1/2+b_2/4+\cdots+b_k/{2^k})} < 10. & \\
\end{flalign*}

За $y$ мы обозначили точное значение $\log_{10}{x}$, а за $\log'{x}=n+b_1/2+b_2/4+\cdots+b_k/{2^k}$ приближенное значение. Тогда
\begin{flalign*}
  & \log'{x} \leq \log_{10}{x} < \log'{x}+1/2^k & \\
  & 0 \leq \log_{10}{x} -\log'{x} < 1/2^k & \\
  & -1/2^k < \log'{x} -\log_{10}{x} \leq 0  & \\
\end{flalign*}
\begin{flalign} \label{eq:1_2_2__27_1}
  & \log_{10}{x}-1/2^k < \log'{x} \leq \log_{10}{x}  &
\end{flalign}

Теперь введем в рассмотрение погрешность вычислений.
\begin{flalign*}
  & \Bigl(\frac{x(1-\delta)}{10^n}\Bigl) \leq x_0 \leq \Bigl(\frac{x(1+\epsilon)}{10^n}\Bigl); & \\
  & (x_0)^2*\frac{(1-\delta)}{10^{b_1}} = \frac{x^{2^1} (1-\delta)^3}{10^{2^1(n+\frac{b_1}{2})}} \leq
  x_1 \leq (x_0)^2*\frac{(1+\epsilon)}{10^{b_1}}=\frac{x^{2^1} (1+\epsilon)^3}{10^{2^1(n+\frac{b_1}{2})}} &\\
  & \frac{x^{2^2}(1-\delta)^7}{10^{2^2(n+\frac{b_1}{2}+\frac{b_2}{4})}} \leq x_2
  \leq \frac{x^{2^2}(1+\epsilon)^7}{10^{2^2(n+\frac{b_1}{2}+\frac{b_2}{4})}} & \\
  & \cdots & \\
\end{flalign*}
\begin{flalign*}
  & k: && 0,&& 1,&& 2,&& 3,&& 4,&& \dots  & \\
  & n=2(n-1)+1: && 1,&& 3,&& 7,&& 15,&& 31,&& \dots  & \\
  & n=2(n-1): && 0,&& 2,&& 6,&& 14,&& 30,&& \dots  & \\
  & n=2^k: && 1,&& 2,&& 4,&& 8,&& 16,&& \dots & \\
  & n=2^{k+1}-1: && 1,&& 3,&& 7,&& 15,&& 31,&& \dots & \\
\end{flalign*}
\begin{flalign*}
  & 1 \leq \frac{x^{2^k}(1-\delta)^{2^{k+1}-1}}{10^{2^k(n+b_1/2+\dots+b_k/2^k)}}
  \leq x_k \leq
  \frac{x^{2^k}(1+\epsilon)^{2^{k+1}-1}}{10^{2^k(n+b_1/2+\dots+b_k/2^k)}}= & \\
  & \frac{x^{2^k}\Bigl((1+\epsilon)^2\Bigl)^{2^k}}{10^{2^k(n+b_1/2+\dots+b_k/2^k)}(1+\epsilon)} \leq
  \frac{x^{2^k}\Bigl((1+\epsilon)^2\Bigl)^{2^k}}{10^{2^k(n+b_1/2+\dots+b_k/2^k)}}
  <10& \\
\end{flalign*}

Таким образом вместо $\log_{10}{x}$ получаем выражения $\log_{10}{x(1-\delta)^2}$ и $\log_{10}{x(1+\epsilon)^2}$ соответственно, которые нужно подставить в \ref{eq:1_2_2__27_1}.

\subsubsection{28.}

(Р. Фейман (R. Feynman).) Придумайте метод вычисления $b^x$, где $0 \leq x < 1$, используя только операции сдвига, сложения и вычитания (аналогично алгоритму из упр. 25), и проанализируйте его точность.

В упражнении 25 мы получили приближенное значение логарифма

\begin{flalign*}
  & x = \log_b{\frac{2^{k_1}}{2^{k_1}-1}} + \log_b{\frac{2^{k_2}}{2^{k_2}-1}} +
  \cdots + \log_b{\frac{2^{k_n}}{2^{k_n}-1}};& \\
  & y = b^x \approx
  \frac{2^{k_1} 2^{k_2}\cdots 2^{k_n}}{(2^{k_1}-1)(2^{k_2}-1)\cdots(2^{k_n}-1)}.&
\end{flalign*}

Таким образом, базовая идея состоит в том, чтобы при наличии таблицы логарифмов последовательно уменьшать $x$ на величину $\log_{b}{\frac{2^{k_i}}{2^{k_i}-1}}$ до тех пор, пока он не станет равным $0$. Одновременно с этим умножать $y$ на $\frac{2^{k_i}}{2^{k_i}-1}$. Проблема заключается в том, чтобы вычислить $y$, не прибегая к умножению:
\begin{flalign*}
  & y_1 = 1 \frac{2^{k_1}}{2^{k_1}-1}; & \\
  & \frac{1}{y_1} = \frac{2^{k_1}-1}{2^{k_1}} = 1 - \frac{1}{2^{k_1}}. & \\
\end{flalign*}

В ответе к упражнению в качестве начального значения $y$ берется не $1$, а некоторое приближенное значение $b^{(1-\epsilon)}$, где $1-\epsilon \approx x$. Тогда алгоритм состоит в последовательном вычитании из $y_{i-1}$ $\frac{y_{i-1}}{2^{k_i}}$, как в упражнении 25. Как вычислить приближенное значение $b^{(1-\epsilon)}$ в ответах умалчивается.

\subsubsection{29.}
Пусть $x$ --- действительное число, большее, чем $1$. (a) При каком действительном $b > 1$ величина $b \log_{b}{x}$ минимальна? (b) При каком \emph{целом} $b>1$ эта величина минимальна? (c) При каком целом $b>1$ величина $(b+1)\log_{b}{x}$ минимальна?

(a) Функция $\log_{b}{x}$ является монотонно возрастающей. Чем больше значение $b$, тем меньше значение функции. С другой стороны, чем больше $b$, тем больше значение функции $b \cdot t$. Зафиксируем $x=t_0 > 1$ и рассмотрим функцию $f(b) = b \log_{b}{t_0}$.
\begin{flalign*}
  & (b \log_{b}{t_0})' = b'\log_{b}{t_0} + b (\log_{b}{t_0})' = 
  \log_{b}{t_0} + b\Bigl(\frac{\ln{t_0}}{\ln{b}} \Bigl)' =
  \log_{b}{t_0} -\frac{b\ln{t_0}}{(\ln{b})^2} (\ln{b})' = \log_{b}{t_0} -\frac{b\ln{t_0}}{b(\ln{b})^2} = & \\
  & \frac{\ln{t_0}}{\ln{b}} - \frac{\ln{t_0}}{(\ln{b})^2} =
  \ln{t_0}\frac{\ln{b}-1}{(\ln{b})^2} & \\
  & (b \log_{b}{t_0})' =  \Bigl( \frac{b \ln{t_0}}{\ln{b}}\Bigl)'=
  \frac{\ln{t_0}\ln{b} - \frac{b\ln{t_0}}{b}}{(\ln{b})^2} =
  \ln{t_0}\frac{\ln{b}-1}{(\ln{b})^2}& \\
\end{flalign*}

Производная функции равна $0$, когда $b=e$.

(b) Так как в точке $e$ функция $f(b) = b \log_{b}{t_0}$ имеет локальный экстремум, то при $b < e$ функция убывает, а при $b > e$ -- возрастает. Следовательно при $b = 2$ и $b = 3$ функция ближе всего к своему минимальному значению.
\begin{flalign*}
  & 2 \log_{2}{x} \textrm{ (?) } 3 \log_{3}{x} & \\
  & 2 \frac{\log_{3}{x}}{\log_{3}{2}} \textrm{ (?) } 3 \log_{3}{x} & \\
  & \frac{2}{3} \textrm{ (?) } \log_{3}{2} & \\
  & 0.666 > 0.630 & \\
  & 2 \log_{2}{x} > 3 \log_{3}{x} & \\
\end{flalign*}

Таким образом, при $b=3$ функция минимальна.

(c) Найдем производную функции $f(b) = (b+1) \log_{b}{t_0}$.
\begin{flalign*}
  & ((b+1) \log_{b}{t_0})' =  \ln{t_0} \Bigl( \frac{(b+1)}{\ln{b}}\Bigl)'=
  \ln{t_0} \frac{\ln{b} - \frac{b+1}{b}}{(\ln{b})^2} =
  \ln{t_0}\frac{\ln{b}-1-\frac{1}{b}}{(\ln{b})^2}& \\
  & \ln{b} = 1+\frac{1}{b} & \\
  & e^{\ln{b}} = e^{1+\frac{1}{b}} & \\
  & b = e \sqrt[b]{e} & \\
  & b^b = e^b e & \\
  & \Bigl(\frac{b}{e}\Bigl)^b = e & \\
  & t = \frac{b}{e} & \\
  & t^{et} = e& \\
  & t^t = e^{\frac{1}{e}}& \\
\end{flalign*}

Выразить $t$ простым способом не получилось.

Сравним последовательно функцию $f(b)$ при разных значениях $b$.

\begin{flalign*}
  & 3 \log_{2}{x} \textrm{ (?) } 4 \log_{3}{x} & \\
  & \frac{3}{4} \textrm{ (?) } \log_{3}{2} & \\
  & 0.75 > 0.63 & \\
  & 3 \log_{2}{x} > 4 \log_{3}{x} & \\
\end{flalign*}

На отрезке $2 \leq b \leq 3$ функция убывает. Сравниваем дальше.
\begin{flalign*}
  & 4 \log_{3}{x} \textrm{ (?) } 5 \log_{4}{x} & \\
  & \frac{4}{5} \textrm{ (?) } \log_{4}{3} & \\
  & 0.8 > 0.792 & \\
  & 4 \log_{3}{x} > 5 \log_{4}{x} & \\
\end{flalign*}

\begin{flalign*}
  & 5 \log_{4}{x} \textrm{ (?) } 6 \log_{5}{x} & \\
  & \frac{5}{6} \textrm{ (?) } \log_{5}{4} & \\
  & 0.833 < 0.861 & \\
  & 5 \log_{4}{x} < 6 \log_{5}{x} & \\
\end{flalign*}

Таким образом, при $b=4$ функция минимальна.

\subsection{Суммы и произведения}

\subsubsection{1.}

Что означает запись $\sum_{1 \leq j \leq n}{a_j}$ для $n=3.14$?
\begin{flalign*}
  & \sum_{1 \leq j \leq 3.14}{a_j} = a_1 + a_2 + a_3. & \\
\end{flalign*}

\subsubsection{2.}

Не пользуясь знаком $\sum$, запишите эквивалент выражения
\begin{flalign*}
  & \sum_{0 \leq n \leq 5}{\frac{1}{2n+1}}, & \\
\end{flalign*}
а также выражения
\begin{flalign*}
  & \sum_{0 \leq n^2 \leq 5}{\frac{1}{2n^2+1}}. & \\
\end{flalign*}

\begin{flalign*}
  & \sum_{0 \leq n \leq 5}{\frac{1}{2n+1}} = \frac{1}{1} + \frac{1}{3} + \frac{1}{5} + \frac{1}{7} + \frac{1}{9} + \frac{1}{11} = 1 + \frac{4}{9} + \frac{12}{35}+\frac{1}{11} = 1 + \frac{4}{9} + \frac{167}{385} = 1 \frac{3043}{3465}; & \\
  & \sum_{0 \leq n^2 \leq 5}{\frac{1}{2n^2+1}} = \sum_{-\sqrt{5} \leq n \leq \sqrt{5}}{\frac{1}{2n^2+1}} = \frac{1}{2(-2)^2+1}+\frac{1}{2(-1)^2+1}+\frac{1}{2(0)^2+1}+\frac{1}{2(1)^2+1}+\frac{1}{2(2)^2+1} = \frac{2}{9} + \frac{2}{3} + \frac{1}{1}. & \\
\end{flalign*}

\subsubsection{3.}

Объясните, почему несмотря на правило (b) результаты предыдущего упражнения различны.

Стоит отметить, что $\sum_{0 \leq n^2 \leq 5}{\frac{1}{2n^2+1}} \neq \sum_{0 \leq i \leq 5}{\frac{1}{2i+1}}$, т.к. $i = p(n)=n^2$ ($ n=\pm \sqrt{i} $) не является перестановкой в области суммирования.
\begin{flalign*}
  & R(p(n)) = [0 \leq n^2 \leq 5]; & \\
  & R(i) = [0 \leq i \leq 5]; & \\
  & i=0: \ \ \sum_{n}{[i=p(n)]} = \sum_{n=0}{[i=p(n)]} = 1; & \\
  & i=1: \ \ \sum_{n}{[i=p(n)]} = \sum_{n=\pm 1}{[i=p(n)]} = 2; & \\
  & i \in \{2,3,5\}: \ \ \sum_{n}{[i=p(n)]} = 0; & \\
  & i=4: \ \ \sum_{n}{[i=p(n)]} = \sum_{n=\pm 2}{[i=p(n)]} = 2; & \\
  & \sum_{0 \leq n^2 \leq 5}{\frac{1}{2n^2+1}} = \sum_{0 \leq i \leq 5}{\frac{1}{2i+1} \sum_{n}{[i=p(m)]}} = \frac{1}{2 \cdot 0+1}+\frac{2}{2 \cdot 1+1}+\frac{2}{2 \cdot 4+1} = \frac{2}{9} + \frac{2}{3} + \frac{1}{1}. & \\
\end{flalign*}

\subsubsection{4.}

Не пользуясь знаком ``$\sum$'', запишите эквиваленты каждой части равенства (10) как суммы сумм для случая $n=3$.
\begin{flalign*}
  & \sum_{i=1}^{3}{\sum_{j=1}^{i}{a_{ij}}} = \sum_{j=1}^{3}{\sum_{i=j}^{3}{a_{ij}}}; & \\
  & \sum_{i=1}^{3}{\sum_{j=1}^{i}{a_{ij}}} = \sum_{j=1}^{1}{a_{1j}} + \sum_{j=1}^{2}{a_{2j}} + \sum_{j=1}^{3}{a_{3j}} = (a_{11}) + (a_{21}+a_{22}) + (a_{31}+a_{32}+a_{33}); & \\
  & \sum_{j=1}^{3}{\sum_{i=j}^{3}{a_{ij}}} = \sum_{i=1}^{3}{a_{i1}} + \sum_{i=2}^{3}{a_{i2}} + \sum_{i=3}^{3}{a_{i3}} = (a_{11}+a_{21}+a_{31})+(a_{22}+a_{32})+(a_{33}); & \\
\end{flalign*}

\subsubsection{5.}

Докажите, что правило (a) справедливо для произвольного бесконечного ряда при условии, что этот ряд сходится.
\begin{flalign*}
  & \Bigl(\sum_{R(i)}{a_i}\Bigl)\Bigl(\sum_{S(j)}{b_j}\Bigl) = \sum_{R(i)}{\sum_{S(j)}{a_i b_j}}. & \\
\end{flalign*}
Если бесконечный ряд $a_i$ сходится, то
\begin{flalign*}
  & \sum_{i \geq 0}{a_i} = \lim_{n \rightarrow \infty}{\sum_{0 \leq i < n}{a_i}} = S_a & \\
\end{flalign*}
и данный предел существует. Аналогично для ряда $b_j$ существует предел
\begin{flalign*}
  & \sum_{j \geq 0}{b_j} = \lim_{n \rightarrow \infty}{\sum_{0 \leq j < n}{b_j}} = S_b. & \\
\end{flalign*}
Тогда
\begin{flalign*}
  & \Bigl(\sum_{R(i)}{a_i}\Bigl)\Bigl(\sum_{S(j)}{b_j}\Bigl)=S_a \cdot S_b=
  \lim_{n \rightarrow \infty}{\sum_{0 \leq i < n}{a_i}} \cdot \lim_{n \rightarrow \infty}{\sum_{0 \leq j < n}{b_j}} =
  \lim_{n \rightarrow \infty}{\Bigl(\sum_{0 \leq i < n}{a_i}\Bigl)\Bigl( \sum_{0 \leq j < n}{b_j}\Bigl)} =
  \lim_{n \rightarrow \infty}{\sum_{0 \leq i < n}\Bigl({a_i} \sum_{0 \leq j < n}{b_j}\Bigl)} = & \\
 & \lim_{n \rightarrow \infty}{\sum_{0 \leq i < n}{\sum_{0 \leq j < n}{a_i b_j}}}.& \\
\end{flalign*}

\subsubsection{6.}

Докажите, что правило (d) справедливо для произвольного бесконечного ряда при условии, что сходятся любые три суммы из четырех.
\begin{flalign*}
  & \sum_{R(j)}{a_j} + \sum_{S(j)}{a_j} = \sum_{R(j) \textrm{ или } S(j)}{a_j} + \sum_{R(j) \textrm{ и } S(j)}{a_j}; & \\
  & \lim{\sum_{R(j)}{a_j}} + \lim{\sum_{S(j)}{a_j}} = \lim{\Bigl(\sum_{R(j)}{a_j} + \sum_{S(j)}{a_j}\Bigl)}. & \\
\end{flalign*}
Возьмем один элемент $a_{j_1}$ из второй суммы, который не встречается в первой сумме, и перенесем его в первую сумму: 
\begin{flalign*}
  & \lim{\Bigl(\sum_{R(j) \textrm{ или } j \in \{j_1\}}{a_j} + \sum_{S(j) \textrm{ и } j \notin \{j_1\}}{a_j} \Bigl)}. & \\
\end{flalign*}
Продолжим переносить таким образом элементы до тех пор, пока во второй сумме останутся только те элементы, которые есть и в первой сумме:
\begin{flalign*}
  & \lim{\Bigl(\sum_{R(j) \textrm{ или } j \in \{j_1, j_2\}}{a_j} + \sum_{S(j) \textrm{ и } j \notin \{j_1, j_2\}}{a_j} \Bigl)}; & \\
  & \cdots & \\
  & \lim{\Bigl(\sum_{R(j) \textrm{ или } j \in \{j_1, j_2, \dots, j_k\}}{a_j} + \sum_{S(j) \textrm{ и } j \notin \{j_1, j_2, \dots, j_k\}}{a_j} \Bigl)}. & \\
\end{flalign*}

Утверждение $[R(j) \textrm{ или } j \in \{j_1, j_2, \dots, j_k\}]$ эквивалентно $[R(j) \textrm{ или } S(j)]$ т.к. все остальные элементы $j_{k+1}, j_{k+2}, \dots$ в $S(j)$ уже входят в $R(j)$. А утверждение $[S(j) \textrm{ и } j \notin \{j_1, j_2, \dots, j_k\}]$ эквивалентно $[R(j) \textrm{ и } S(j) ]$, т.к. все элементы $j_{k+1}, j_{k+2}, \dots$ входят и в $R(j)$, и в $S(j)$. Таким образом, мы получаем
\begin{flalign*}
  & \lim{\Bigl(\sum_{R(j)\textrm{ или }S(j)}{a_j}+\sum_{S(j)\textrm{ и }R(j)}{a_j} \Bigl)} = \lim{\sum_{R(j)\textrm{ или }S(j)}{a_j}}+\lim{\sum_{S(j)\textrm{ и }R(j)}{a_j}}. & \\
\end{flalign*}

\subsubsection{7.}
Покажите, что если $c$ --- любое целое число, то $\sum_{R(j)}{a_j}=\sum_{R(c-j)}{a_{c-j}}$, даже если оба ряда бесконечны.

Пусть $i = p(j) = c-j$. При этом каждому значению $j$ соответствует одно и только одно значение $i$. Тогда для бесконечного ряда $a_{p(j)}$
\begin{flalign*}
  & \lim_{n \rightarrow \infty} {\sum_{\substack{R(p(j))\\-n<j<n}}{a_{p(j)}}} =
  \sum_{i}{a_i [R(i)] \sum_{j}{[i=p(j)=c-j]}} =
  \sum_{i}{a_i [R(i)]} = \sum_{j}{a_j [R(j)]} =
  & \lim_{n \rightarrow \infty} {\sum_{\substack{R(j)\\-n<j<n}}{a_{j}}}. & \\
\end{flalign*}

\subsubsection{8.}
Приведите пример бесконечного ряда, для которого равенство (7) ложно.
\begin{flalign*}
  & \sum_{R(i)}{\sum_{S(j)}{a_{ij}}} = \sum_{S(j)}{\sum_{R(i)}{a_{ij}}}. & \\
\end{flalign*}

Утверждается, что равенство (7) справедливо для абсолютно сходящихся бесконечных рядов.
Возьмем условно сходящийся ряд
\begin{flalign*}
  & 1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \frac{1}{5} \cdots =
  \lim_{n \rightarrow \infty}{\sum_{i=0}^{n}{\frac{(-1)^i}{i+1}}} =
  \lim_{n \rightarrow \infty}{\sum_{i=0}^{n}{ \Bigl( \frac{1}{2i+1} + \frac{-1}{2i+2} \Bigl)}} =
  \lim_{n \rightarrow \infty}{\sum_{i=0}^{n}{\sum_{j=0}^{1}{\frac{(-1)^j}{2i+1+j}}}}= \ln2. & \\
\end{flalign*}

Так как ряд условно сходящийся, то ряды $1 + \frac{1}{3} + \frac{1}{5} \cdots$ и $-\frac{1}{2}-\frac{1}{4}-\frac{1}{6} \cdots$ расходятся. Поэтому
\begin{flalign*}
  & \lim_{n \rightarrow \infty}{\sum_{i=0}^{n}{\sum_{j=0}^{1}{\frac{(-1)^j}{2i+1+j}}}} \neq
  \lim_{n \rightarrow \infty}{\sum_{j=0}^{1}{\sum_{i=0}^{n}{\frac{(-1)^j}{2i+1+j}}}}=
  \sum_{j=0}^{1}{\lim_{n \rightarrow \infty}{\sum_{i=0}^{n}{\frac{(-1)^j}{2i+1+j}}}}= & \\
  & \lim_{n \rightarrow \infty}{\sum_{i=0}^{n}{\frac{1}{2i+1}}} - \lim_{n \rightarrow \infty}{\sum_{i=0}^{n}{\frac{1}{2i+2}}} = \infty -\infty. & \\
\end{flalign*}

Другой пример приводится в ответе к упражнению. Пусть $a_{(i+1)i} = 1$, $a_{i(i+1)}=-1$:
\begin{flalign*}
  & i \textrm{\textbackslash} j & 0 && 1 && 2 && 3 && 4 && \cdots && \sum & \\
  & 0 & 0 &&-1 && 0 && 0 && 0 && \cdots && -1 &\\
  & 1 & 1 && 0 &&-1 && 0 && 0 && \cdots && 0\\
  & 2 & 0 && 1 && 0 &&-1 && 0 && \cdots && 0\\
  & 3 & 0 && 0 && 1 && 0 &&-1 && \cdots && 0\\
  & 4 & 0 && 0 && 0 && 1 && 0 && \cdots && 0\\
  & \cdots & \cdots && \cdots && \cdots && \cdots && \cdots && \cdots && 0 & \\
  & \sum & 1 && 0 && 0 && 0 && 0 && 0 && 1\textrm{\textbackslash} -1 &\\
\end{flalign*}
Тогда сумма по строкам даст нам $-1$, а по столбцам --- $1$.

\subsubsection{9.}
Справедливо ли доказательство формулы (14) для $n=-1$?
\begin{flalign*}
  & \sum_{0 \leq j \leq n}{ax^j} = a \Bigl( \frac{1-x^{n+1}}{1-x} \Bigl) & \\
\end{flalign*}

Если подходить к определению суммы формально, то при $n=-1$ ни одно $j$ не удовлетворяет условию $0 \leq j \leq n = -1$. Следовательно сумма в левой части равенства равна $0$. Первое же преобразование в доказательстве становится корректным только при $a=0$.
\begin{flalign*}
  & \sum_{0 \leq j \leq -1}{ax^j} \neq a + \sum_{1 \leq j \leq -1}{ax^j} \textrm{ при } a \neq 0. & \\
\end{flalign*}

Однако стоит заметить, что $ax^{n+1} = ax^0 = a$. Таким образом, начиная с выражения
\begin{flalign*}
  & \sum_{0 \leq j \leq -1}{ax^j} = a + x \sum_{0 \leq j \leq -1}{ax^j} -ax^{n+1} &
\end{flalign*}
и заканчивая последней формулой все преобразования выполняются корректно. Таким образом доказательство можно считать справедливым, если исключить из него несколько неверных выражений.

\subsubsection{10.}
Справедливо ли доказательство формулы (14) для $n=-2$?

При $n=-2$ все преобразования в ходе доказательства справедливы только при $a=0$. Несколько выражений, включая предпоследнее, справедливы при $x=1$ и $a \neq 0$:
\begin{flalign*}
  & (1-x) \sum_{0 \leq j \leq -2}{ax^j} = a - ax^{-2+1}. &
\end{flalign*}
Но финальную формулу из этого равенства вывести нельзя, т.к. при этом пришлось бы делить обе части выражения на $0$.

\subsubsection{11.}
Чему равна правая часть формулы (14) при $x=1$?

При $x=1$ переход от $(1-x) \sum_{j=0}^{n}{ax^j} = a - ax^{n+1}$ к $\sum_{j=0}^{n}{ax^j} = a \Bigl(  \frac{1-x^{n+1}}{1-x} \Bigl)$ является некорректным, т.к. при этом обе части равенства нужно поделить на $0$.
При этом вычислить значение суммы не представляет труда:
\begin{flalign*}
  & \sum_{0 \leq j \leq n}{ax^j} = \sum_{0 \leq j \leq n}{a} = a(n+1). &
\end{flalign*}

\subsubsection{12.}
Чему равна сумма $1+\frac{1}{7}+\frac{1}{49}+\frac{1}{343}+\cdots+(\frac{1}{7})^n$?

Ряд представляет собой геометрическую прогрессию с параметрами $a=1$, $x=\frac{1}{7}$. Тогда $\sum_{j=0}^{n}{(\frac{1}{7})^j} = \frac{1-(\frac{1}{7})^{n+1}}{1-\frac{1}{7}} = \frac{7(7^{n+1}-1)}{7^{n+1}(7-1)} = \frac{7^{n+1}-1}{7^n (7-1)}. $

\subsubsection{13.}
Используя формулу (15) и предполагая, что $m \leq n$, вычислите сумму $\sum_{j=m}^{n}{j}$.

Формула суммы арифметической прогрессии:
\begin{flalign*}
  &\sum_{0\leq j \leq n}{(a+bj)}=(n+1)\frac{a+(a+bn)}{2}=(n+1)(a+\frac{bn}{2}).& \\
\end{flalign*}
Преобразуем нашу сумму к форме суммы арифметической прогрессии:
\begin{flalign*}
  & \sum_{m \leq j \leq n}{j} = \sum_{m \leq j+m \leq n}{j+m} =
  \sum_{0 \leq j \leq n-m}{m+j}. & \\
\end{flalign*}
В нашем случае параметры принимают следующие значения: $n=n-m$, $a=m$, $b=1$.
\begin{flalign*}
  & \sum_{0 \leq j \leq n-m}{m+j} = (n-m+1)(m+\frac{n-m}{2}) =
  \frac{1}{2}(n+m)(n-m+1) = & \\
  & \frac{1}{2}(n^2-nm+n+nm-m^2+m) = \frac{1}{2}(n^2-m^2+n+m) =
  \frac{1}{2}(n(n+1)-m(m-1)). & \\
\end{flalign*}

\subsubsection{14.}
Используя результат предыдущего упражнения, вычислите сумму $\sum_{j=m}^{n}{\sum_{k=r}^{s}{jk}}$.

\begin{flalign*}
  & \sum_{m \leq j \leq n}{\sum_{r \leq k \leq s}{jk}} =
  \sum_{m \leq j \leq n}{j \sum_{r \leq k \leq s}{k}} =
  \sum_{m \leq j \leq n}{j } =  & \\
  & \frac{1}{2}(s(s+1)-r(r-1)) \frac{1}{2}(n(n+1)-m(m-1)) =
  \frac{1}{4}(n(n+1)-m(m-1))(s(s+1)-r(r-1)). & \\
\end{flalign*}

\subsubsection{15.}
Вычислите сумму $1 \times 2 + 2 \times 2^2 + 3 \times 2^3 + \cdots + n2^n$ для малых значений $n$. Заметили ли вы какую-либо закономерность в этих числах? Если нет, постарайтесь обнаружить ее с помощью действий, аналогичных тем, которые применялись при выводе формулы (14).

\begin{flalign*}
  & 1 \times 2=2; & \\
  & 1 \times 2+2 \times 2^2=2+8=10; & \\
  & 1 \times 2+2 \times 2^2+3 \times 2^3=2+8+24=34;  & \\
  & 1 \times 2+2 \times 2^2+3 \times 2^3+4 \times 2^4=2+8+24+64=98;  & \\
\end{flalign*}

Сумма представляет собой смесь арифметической и геометрической прогрессии. Формулы для суммы арифметической прогрессии (15) и геометрической прогрессии (14) выводились с помощью выделения констант и последующего приведения к выражению, содержащему исходную сумму.
\begin{flalign*}
  & \sum_{0\leq j\leq n}{j2^j} = \sum_{1\leq j\leq n}{j2^j} =
  2\sum_{1\leq j\leq n}{j2^{j-1}} = 2\sum_{1\leq j+1\leq n}{(j+1)2^{j+1-1}} =
  2\sum_{0\leq j\leq n-1}{(j+1)2^{j}} = & \\
  & 2\sum_{0\leq j\leq n-1}{j2^{j}} + 2\sum_{0\leq j\leq n-1}{2^{j}} =
  2\Bigl(\sum_{0\leq j\leq n}{j2^{j}}-n2^n\Bigl)+\sum_{0\leq j\leq n-1}{2^{j+1}}=
  2\sum_{0\leq j\leq n}{j2^{j}}-n2^{n+1}+\sum_{1\leq j\leq n}{2^{j}}=
  \sum_{0\leq j\leq n}{j2^j}; & \\
  & \sum_{0\leq j\leq n}{j2^{j}}=n2^{n+1}-\sum_{0\leq j\leq n}{2^{j}}+1=
  n2^{n+1}-\frac{1-2^{n+1}}{1-2}+1 = n2^{n+1}+1-2^{n+1}+1 = (n-1)2^{n+1}+2. & \\
\end{flalign*}

\subsubsection{16.}
Не применяя метод математической индукции, докажите, что
\begin{flalign*}
  & \sum_{j=0}^{n}{jx^j}=\frac{nx^{n+2}-(n+1)x^{n+1}+x}{(x-1)^2}, & \\
\end{flalign*}
если $x \neq 1$.
\begin{flalign*}
  & \sum_{1\leq j\leq n}{jx^j}=x\sum_{1\leq j\leq n}{jx^{j-1}} =
  x\sum_{1\leq j+1\leq n}{(j+1)x^{j+1-1}}=x\sum_{0\leq j\leq n-1}{(j+1)x^{j}}= & \\
  & x\sum_{0\leq j\leq n-1}{jx^{j}} + x\sum_{0\leq j\leq n-1}{x^{j}} =
  x\Bigl(\sum_{0\leq j\leq n}{jx^{j}}-nx^n\Bigl)+\sum_{0\leq j\leq n-1}{x^{j+1}}=
  x\sum_{0\leq j\leq n}{jx^{j}}-nx^{n+1}+\sum_{1\leq j\leq n}{x^{j}}=
  \sum_{0\leq j\leq n}{jx^j}; & \\
  & (x-1)\sum_{0\leq j\leq n}{jx^{j}}=nx^{n+1}-\sum_{0\leq j\leq n}{x^{j}}+1=
  nx^{n+1}-\frac{1-x^{n+1}}{1-x}+1=\frac{nx^{n+1}(1-x)-1+x^{n+1}+1-x}{1-x} = &\\
  &\frac{nx^{n+1}-nx^{n+2}+x^{n+1}-x}{1-x}=
  \frac{-nx^{n+2}+(n+1)x^{n+1}-x}{1-x}=
  \frac{nx^{n+2}-(n+1)x^{n+1}+x}{x-1}. & \\
\end{flalign*}

\subsubsection{17.}
Пусть S --- множество целых чисел. Чему равна сумма $\sum_{j \in S}{1}$?

Сумма равна числу элементов множества S. Если множество содержит бесконечное число элементов, то сумма представляет собой бесконечное число единиц, т.е. равна $\infty$.

\subsubsection{18.}
Покажите, как изменить порядок суммирования в равенстве (9), если $R(i)$ --- это соотношение ``$n$ кратно $i$'', а $S(i,j)$ --- это соотношение ``$1 \leq j<i$''.

\begin{flalign*}
  & \sum_{R(i)}{\sum_{S(i,j)}{a_{ij}}} = \sum_{S'(j)}{\sum_{R'(i,j)}{a_{ij}}}. & \\
\end{flalign*}
Если $n$ кратно $i$, то $i\leq n$. 
\begin{flalign*}
  & \sum_{n\textrm{ кратно }i}{\sum_{1\leq j<i}{a_{ij}}} =
  \sum_{\substack{1\leq i\leq n\\n\textrm{ кратно }i}}{\sum_{1\leq j<i}{a_{ij}}}=
  \sum_{i,j}{a_{ij}[1\leq i\leq n][i\textrm{ кратно }n][1\leq j<i]}= & \\
  & \sum_{i,j}{a_{ij}[1\leq j\leq n][j<i\leq n][i\textrm{ кратно }n]}=
  \sum_{1\leq j\leq n}{\sum_{\substack{j<i\leq n\\n\textrm{ кратно }i}}{a_{ij}}}=
  \sum_{1\leq j\leq n}{\sum_{\substack{j<i\\n\textrm{ кратно }i}}{a_{ij}}}=& \\
  &\sum_{1\leq j<n}{\sum_{\substack{j<i\\n\textrm{ кратно }i}}{a_{ij}}}.& \\
\end{flalign*}
Для $j=n$ внутренняя сумма обращается в $0$.

\subsubsection{19.}
Чему равна сумма $\sum_{j=m}^{n}{(a_j-a_{j-1})}$?
\begin{flalign*}
  & \sum_{m\leq j\leq n}{(a_j-a_{j-1})} =
  \sum_{m\leq j\leq n}{a_j}-\sum_{m\leq j\leq n}{a_{j-1}}= & \\
  & (a_m+a_{m+1}+\cdots+a_{n-2}+a_{n-1}+a_n)-& \\
  & (a_{m-1}+a_m+a_{m+1}+\cdots+a_{n-2}+a_{n-1})=& \\
  & a_n-a_{m-1}. & \\
\end{flalign*}
Но возможен и другой вариант решения:
\begin{flalign*}
  & \sum_{m\leq j\leq n}{a_j}-\sum_{m\leq j\leq n}{a_{j-1}}=
  \sum_{m\leq j\leq n}{a_j}-\sum_{m\leq j+1\leq n}{a_{j+1-1}}=
  \sum_{m\leq j\leq n}{a_j}-\sum_{m-1\leq j\leq n-1}{a_{j}}=& \\
  & \sum_{m\leq j\leq n-1}{a_j}+a_n-a_{m-1}-\sum_{m\leq j\leq n-1}{a_{j}}=
  a_n-a_{m-1}.& \\
\end{flalign*}

\subsubsection{20.}
Д-р Матрица обнаружил удивительную закономерность:
\begin{flalign*}
  &9\times 1+2=11,\ 9\times 12+3=111,\ 9\times 123+4=1111,\ 9\times 1234+5=11111.&\\
\end{flalign*}
\begin{enumerate}[label=\alph*)]
\item Запишите это великое открытие доктора с помощью знака суммы ``$\sum$''.
  \begin{flalign*}
    & 0:\ 1=1;\ 11=1+10;& \\
    & 1:\ 12=1+11=1+(1+10);\ 111=1+10+100;& \\
    & 2:\ 123=1+11+111=1+(1+10)+(1+10+100);\ 1111=1+10+100+1000;& \\
    & 3:\ 1234=1+(1+10)+(1+10+100)+(1+10+100+1000);\ 11111=1+10+100+1000+10000;& \\
    & \cdots & \\
    & n:\ \sum_{0\leq i\leq n}{\sum_{0\leq j\leq i}{10^j}};
    \ \sum_{-1\leq i\leq n}{10^{i+1}}=\sum_{0\leq i\leq n+1}{10^{i}}=;& \\
  \end{flalign*}
  Таким образом итоговая формула примет вид:
  \begin{flalign*}
    & 9\sum_{0\leq i\leq n}{\sum_{0\leq j\leq i}{10^j}}+n+2=\sum_{0\leq i\leq n+1}{10^{i}}. & \\
  \end{flalign*}
\item В вашем ответе у п. (a), без сомнения, фигурирует число $10$ как основание десятичной системы. Обобщите полученную формулу так, чтобы ее можно было применять для любого основания $b$.
  \begin{flalign*}
    & (b-1)\sum_{0\leq i\leq n}{\sum_{0\leq j\leq i}{b^j}}+n+2=\sum_{0\leq i\leq n+1}{b^{i}}. & \\
  \end{flalign*}
\item Докажите формулу из п. (b) с помощью формул, выведенных в тексте раздела или в упр. 16.
  \begin{flalign*}
    & \sum_{0\leq i\leq n}{\sum_{0\leq j\leq i}{b^j}}=
    \sum_{0\leq j\leq n}{\sum_{j\leq i\leq n}{b^j}}=
    \sum_{0\leq j\leq n}{\bigl((n-j+1)b^j\bigl)}=
    (n+1)\sum_{0\leq j\leq n}{b^j}-\sum_{0\leq j\leq n}{jb^j};& \\
    & \sum_{0\leq j\leq n}{jb^j}=\frac{nb^{n+2}-(n+1)b^{n+1}+b}{(1-b)^2}; & \\
    & \sum_{0\leq j\leq n}{b^j} = \frac{1-b^{n+1}}{1-b}; & \\
    & \sum_{0\leq j\leq n+1}{b^j} = \frac{1-b^{n+2}}{1-b}; & \\
  \end{flalign*}
  \begin{flalign*}
    & -(1-b)\Bigl((n+1)\frac{1-b^{n+1}}{1-b}-\frac{nb^{n+2}-(n+1)b^{n+1}+b}{(1-b)^2}\Bigl)+n+2=\frac{1-b^{n+2}}{1-b}; & \\
    &-(n+1)(1-b^{n+1})(1-b)+nb^{n+2}-(n+1)b^{n+1}+b+(1-b)(n+2)=1-b^{n+2}; & \\
    &(n+1)b^{n+1}-(n+1)(1-b)-(n+1)b^{n+2}+(n+1)b^{n+2}-(n+1)b^{n+1}+(1-b)(n+1)=0;&\\
    &b^{n+1}-b^{n+1}+b^{n+2}-b^{n+2}+(1-b)-(1-b)=0;&\\
  \end{flalign*}
\end{enumerate}
Получаем верное тождество. Формула доказана.

\subsubsection{21.}
Выведите правило (d) из правил (a) и (c) с помощью обозначения Айверсона (16).

Правила (a), (c) и (d):
\begin{flalign*}
  & \Bigl(\sum_{R(i)}{a_i}\Bigl)\Bigl(\sum_{S(j)}{b_j}\Bigl)=
  \Bigl(\sum_{i}{a_i[R(i)]}\Bigl)\Bigl(\sum_{j}{b_j[S(j)]}\Bigl)=
  \sum_{R(i)}{\sum_{S(j)}{a_ib_j}}=\sum_{i,j}{a_ib_j[R(i)][S(j)]}; & \\
  & \sum_{R(i)}{\sum_{S(j)}{a_{ij}}}=\sum_{i,j}{a_{ij}[R(i)][S(j)]}=
  \sum_{S(j)}{\sum_{R(i)}{a_{ij}}}=\sum_{i,j}{a_{ij}[S(j)][R(i)]}; & \\
  & \sum_{R(j)}{a_j}+\sum_{S(j)}{a_j}=\sum_{R(j)\textrm{ или }S(j)}{a_j}+\sum_{R(j)\textrm{ и }S(j)}{a_j}. & \\
\end{flalign*}
Добавление $[R(j)\textrm{ или }S(j)]$ не меняет следующие суммы:
\begin{flalign*}
  &\sum_{R(j)}{a_j}=\sum_{j}{a_j[R(j)]}=
  \sum_{j}{a_j[R(j)][R(j)\textrm{ или }S(j)]}; &\\
  &\sum_{S(j)}{a_j}=\sum_{j}{a_j[S(j)]}=
  \sum_{j}{a_j[S(j)][R(j)\textrm{ или }S(j)]}. &\\
\end{flalign*}
Сложив два выражения с помощью правила (a), получаем левую часть правила (d):
\begin{flalign*}
  & \sum_{j}{a_j[R(j)\textrm{ или }S(j)][R(j)]}+\sum_{j}{a_j[R(j)\textrm{ или }S(j)][S(j)]}=
  \sum_{i,j}{a_{ij}[R(j)\textrm{ или }S(j)][T(i,j)]};& \\
  & T(i,j)=R(j)\textrm{ при }i=0; & \\
  & T(i,j)=S(j)\textrm{ при }i=1; & \\
  & T(i,j)=0\textrm{ при }i<0,\ i>1. & \\
\end{flalign*}
С помощью правила (с) перейдем от суммирования по $i$ к суммированию по $j$. Введем функцию $P(j)$:
\begin{flalign*}
  &P(j) = 1,\textrm{ если }[R(j)\textrm{ и }S(j)]=0; & \\
  &P(j) = 2,\textrm{ если }[R(j)\textrm{ и }S(j)]=1; & \\
  &a_{0j}+a_{1j} = a_jP(j)& \\
  &\sum_{i,j}{a_{ij}[R(j)\textrm{ или }S(j)][T(i,j)][0\leq i\leq 1]}=
  \sum_{j,i}{a_{j}P(i)[R(j)\textrm{ или }S(j)][0\leq i\leq 1]}= & \\
  &\sum_{j}{a_{j}[R(j)\textrm{ или }S(j)]}+\sum_{j}{a_{j}[R(j)\textrm{ и }S(j)][R(j)\textrm{ или }S(j)]}=& \\
  &\sum_{j}{a_{j}[R(j)\textrm{ или }S(j)]}+\sum_{j}{a_{j}[R(j)\textrm{ и }S(j)]}=
  \sum_{R(j)\textrm{ или }S(j)}{a_j}+\sum_{R(j)\textrm{ и }S(j)}{a_j}.&\\
\end{flalign*}

\subsubsection{22.}
Сформулируйте аналоги равенств (5), (7), (8) и (11) для \emph{произведений}.

Замена индекса:
\begin{flalign*}
  & \sum_{R(i)}{a_i}=\sum_{R(j)}{a_j}=\sum_{R(p(j))}{a_{p(j)}}; & \\
  & \prod_{R(i)}{a_i}=\prod_{R(j)}{a_j}=\prod_{R(p(j))}{a_{p(j)}}. & \\
\end{flalign*}

Изменение порядка суммирования/произведения:
 \begin{flalign*}
  & \sum_{R(i)}{\sum_{S(j)}{a_{ij}}}=\sum_{S(j)}{\sum_{R(i)}{a_{ij}}}; & \\
  & \prod_{R(i)}{\prod_{S(j)}{a_{ij}}}=\prod_{S(j)}{\prod_{R(i)}{a_{ij}}}. & \\
\end{flalign*}
Если представить числа $a_{ij}$ в виде элементов матрицы, то выражение в левой части означает произведение элементов по строкам, а в правой --- по столбцам.
\begin{flalign*}
  &\prod_{R(i)}{\prod_{j=1}^{2}{a_{ij}}}=\prod_{R(i)}{(a_{i1}\times a_{i2})};&\\
  &\prod_{j=1}^{2}{\prod_{R(i)}{a_{ij}}}=\prod_{R(i)}{a_{i1}}\prod_{R(i)}{a_{i2}}; & \\
  &\prod_{R(i)}{(a_{i1}\times a_{i2})}=\prod_{R(i)}{a_{i1}}\prod_{R(i)}{a_{i2}}.& \\
\end{flalign*}

Манипуляции областью суммирования/произведения:
\begin{flalign*}
  &\sum_{R(j)}{a_j}+\sum_{S(j)}{a_j}=\sum_{R(j)\textrm{ или }S(j)}{a_j}+\sum_{R(j)\textrm{ и }S(j)}{a_j};& \\
  &\prod_{R(j)}{a_j}\times\prod_{S(j)}{a_j}=\prod_{R(j)\textrm{ или }S(j)}{a_j}\times\prod_{R(j)\textrm{ и }S(j)}{a_j}.& \\
\end{flalign*}

\subsubsection{23.}
Объясните, почему целесообразно определить $\sum_{R(j)}{a_j}$ и $\prod_{R(j)}{a_j}$ как нуль и единицу соответственно, если соотношению $R(j)$ не удовлетворяет ни одно целое число.

Предположим, что условию $S(j)$ удовлетворяет несколько элементов $a_{j}$ с индексами $k_1, k_2, \cdots, k_n$. Тогда $\sum_{S(j)}{a_j}=a_{k_1}+a_{k_2}+\cdots+a_{k_n}$.  Сумма $\sum_{S(j)}{a_j}+\sum_{R(j)}{a_j}$ не должна измениться, так как условию $R(j)$ не удовлетворяет ни один элемент, т.е. $\sum_{S(j)}{a_j}+\sum_{R(j)}{a_j}=a_{k_1}+a_{k_2}+\cdots+a_{k_n}$. Отсюда $\sum_{R(j)}{a_j}=0$.

Произведение $\prod_{S(j)}{a_j}=a_{k_1}\times a_{k_2}\times\cdots\times a_{k_n}$.  Произведение $\prod_{S(j)}{a_j}\times\prod_{R(j)}{a_j}$ не должно измениться, так как условию $R(j)$ не удовлетворяет ни один элемент, т.е. $\prod_{S(j)}{a_j}\times\prod_{R(j)}{a_j}=a_{k_1}\times a_{k_2}\times \cdots+a_{k_n}$. Отсюда $\prod_{R(j)}{a_j}=1$.

\subsubsection{24.}
Предположим, что $R(j)$ верно только для конечного числа $j$. Индукцией по числу целых чисел, удовлетворяющих $R(j)$, докажите равенство $\log_{b}{\prod_{R(j)}{a_j}}=\sum_{R(j)}{(\log_{b}{a_j})}$ при условии, что все $a_j>0$.

Обозначим за $n$ количество элементов, удовлетворяющих $R(j)$. Для $n=0$ $\prod_{R(j)}{a_j}=1$, $\log_{b}{\prod_{R(j)}{a_j}}=\log_{b}{1}=0$ и $\sum_{R(j)}{(\log_{b}{a_j})}=0$.

Предполагая по индукции, что равенство выполняется для всех $n\in[0;\ n]$, докажем утверждение для $n+1$. Пусть $R(j)$ выполняется для $n+1$ элементов $a_1,\ a_2,\ \cdots,\ a_n,\ a_{n+1}$, а $R'(j)$ выполняется для $n$ элементов $a_1,\ a_2,\ \cdots,\ a_n$.

\begin{flalign*}
  & \log_{b}{\prod_{R(j)}{a_j}}=\log_{b}{\Bigl(a_{n+1}\prod_{R'(j)}{a_j}\Bigl)}=
  \log_{b}{a_{n+1}}+\log_{b}{\prod_{R'(j)}{a_j}}=
  \log_{b}{a_{n+1}}+\sum_{R'(j)}{\log_{b}{a_j}}=\sum_{R(j)}{\log_{b}{a_j}}.& \\
\end{flalign*}

\subsubsection{25.}
Есть ли ошибка в следующей цепочке преобразований?
\begin{flalign*}
  & \biggl(\sum_{i=1}^{n}{a_i}\biggl)\biggl(\sum_{j=1}^{n}{\frac{1}{a_j}}\biggl)=
  \sum_{1\leq i\leq n}{\sum_{1\leq j\leq n}{\frac{a_i}{a_j}}}=
  \sum_{1\leq i\leq n}{\sum_{1\leq i\leq n}{\frac{a_i}{a_i}}}=
  \sum_{i=1}^{n}{1}=n& \\
\end{flalign*}
Замена индекса $\sum_{1\leq i\leq n}{\sum_{1\leq j\leq n}{\frac{a_i}{a_j}}}=\sum_{1\leq i\leq n}{\sum_{1\leq i\leq n}{\frac{a_i}{a_i}}}$ не является корректной, так как индекс $i$ уже используется во внешней сумме. До преобразования в $1$ обращается только одна дробь при $i=j$.

Преобразование $\sum_{1\leq i\leq n}{\sum_{1\leq i\leq n}{\frac{a_i}{a_i}}}=\sum_{i=1}^{n}{1}$ также выполнено неверно, т.к. в правая часть выражения должна быть $\sum_{i=1}^{n}{n}=n^2$.

\subsubsection{26.}
Покажите, что с помощью соотношений из упр. 22 $\prod_{i=0}^{n}{\prod_{j=0}^{i}{a_ia_j}}$ можно выразить через $\prod_{i=0}^{n}{a_i}$.

Имеем ряд чисел $a_0,\ a_1,\ \cdots,\ a_n$. Тогда произведение будет выглядеть следующим образом:
\begin{flalign*}
  &\prod_{i=0}^{n}{\prod_{j=0}^{i}{a_ia_j}}=&\\
  &a_0a_0&\\
  &a_1a_0a_1a_1&\\
  &a_2a_0a_2a_1a_2a_2&\\
  &\cdots&\\
  &a_na_0a_na_1a_na_2\cdots a_na_n.&\\
\end{flalign*}
Видно что любое $a_k$ встречается в произведении $n+2$ раз. Докажем это.
\begin{flalign*}
  &\prod_{i=0}^{n}{\prod_{j=0}^{i}{a_ia_j}}=\prod_{i=0}^{n}{a_i^{i+1}\prod_{j=0}^{i}{a_j}}=
  \biggl(\prod_{i=0}^{n}{a_i^{i+1}}\biggl)\biggl(\prod_{i=0}^{n}{\prod_{j=0}^{i}{a_j}}\biggl)=
  \biggl(\prod_{i=0}^{n}{a_i^{i+1}}\biggl)\biggl(\prod_{j=0}^{n}{\prod_{i=j}^{n}{a_j}}\biggl)=
  \biggl(\prod_{i=0}^{n}{a_i^{i+1}}\biggl)\biggl(\prod_{j=0}^{n}{a_j^{n-j+1}}\biggl)=&\\
  &\biggl(\prod_{i=0}^{n}{a_i^{i+1}}\biggl)\biggl(\prod_{i=0}^{n}{a_i^{n-i+1}}\biggl)=
  \prod_{i=0}^{n}{a_i^{i+1}a_i^{n-i+1}}=\prod_{i=0}^{n}{a_i^{n+2}}=\biggl(\prod_{i=0}^{n}{a_i}\biggl)^{n+2}&\\
\end{flalign*}

\subsubsection{27.}
Обобщите результат упр. 1.2.1--9, доказав неравенство
\begin{flalign*}
  &\prod_{j=1}^{n}{(1-a_j)}\geq 1-\sum_{j=1}^{n}{a_j}&\\
\end{flalign*}
при условии, что $0<a_j<1$.

Для $n=1$ равенство обращается в верное тождество $1-a_j=1-a_j$. Предполагая по индукции, что равенство справедливо для $n=1,\ 2, \dots,\ n$, докажем его для $n+1$.
\begin{flalign*}
  &\prod_{j=1}^{n+1}{(1-a_j)}=(1-a_{n+1})\prod_{j=1}^{n}{(1-a_j)}=\prod_{j=1}^{n}{(1-a_j)}-a_{n+1}\prod_{j=1}^{n}{(1-a_j)};&\\
  &1-\sum_{j=1}^{n+1}{a_j}=1-\sum_{j=1}^{n}{a_j}-a_{n+1}.&\\
\end{flalign*}
Выражения в левой и правой частях неравенства раскладываются на суммы двух слагаемых. Первые слагаемые сумм представляют собой части исходного выражения для $n$, соотношение которых cчитается известным. Остается выяснить соотношения вторых слагаемых $-a_{n+1}\prod_{j=1}^{n}{(1-a_j)}$ и $-a_{n+1}$. Заметим, что $0<\prod_{j=1}^{n}{(1-a_j)}<1$. Отсюда
\begin{flalign*}
  &a_{n+1}\prod_{j=1}^{n}{(1-a_j)} < a_{n+1};&\\
  &-a_{n+1}\prod_{j=1}^{n}{(1-a_j)} > -a_{n+1};&\\
  &\prod_{j=1}^{n}{(1-a_j)}-a_{n+1}\prod_{j=1}^{n}{(1-a_j)}\geq1-\sum_{j=1}^{n}{a_j}-a_{n+1};&\\
  &\prod_{j=1}^{n+1}{(1-a_j)}\geq 1-\sum_{j=1}^{n+1}{a_j}.&\\
\end{flalign*}

\subsubsection{28.}
Найдите простую формулу для $\prod_{j=2}^{n}{(1-1/j^2)}$.
\begin{flalign*}
  &\prod_{2\leq j\leq n}{\Bigl(1-\frac{1}{j^2}\Bigl)}=
  \prod_{2\leq j\leq n}{\frac{j^2-1}{j^2}}=
  \prod_{2\leq j\leq n}{\frac{(j-1)(j+1)}{j^2}}=
  \prod_{2\leq j\leq n}{(j-1)}\prod_{2\leq j\leq n}{(j+1)}\prod_{2\leq j\leq n}{(j^{-2})}=&\\
  &\prod_{2\leq j+1\leq n}{(j+1-1)}\prod_{2\leq j-1\leq n}{(j-1+1)}\Bigl(\prod_{2\leq j\leq n}{j}\Bigl)^{-2}=
  \prod_{1\leq j\leq n-1}{j}\prod_{3\leq j\leq n+1}{j}\Bigl(\prod_{2\leq j\leq n}{j}\Bigl)^{-2}=&\\
  &\prod_{1\leq j\leq 2}{j}\Bigl(\prod_{3\leq j\leq n-1}{j}\Bigl)^2\prod_{n\leq j\leq n+1}{j}\Bigl(\prod_{3\leq j\leq n-1}{j}\Bigl)^{-2}2^{-2}n^{-2}=
  \frac{1\cdot 2\cdot n\cdot(n+1)}{2^2n^2}=\frac{n+1}{2n}.&\\
\end{flalign*}

\subsubsection{29.}
(a) Выразите сумму $\sum_{i=0}^{n}{\sum_{j=0}^{i}{\sum_{k=0}^{j}{a_ia_ja_k}}}$, используя способ записи с несколькими индексами, который приведен в конце данного раздела. (b) Выразите эту же сумму через $\sum_{i=0}^{n}{a_i}$, $\sum_{i=0}^{n}{a_i^2}$ и $\sum_{i=0}^{n}{a_i^3}$ [см. формулу (13)].

\begin{flalign*}
  &\textrm{(a) }\sum_{0\leq i\leq n}{\sum_{0\leq j\leq i}{\sum_{0\leq k\leq j}{a_ia_ja_k}}}=\sum_{0\leq k\leq j\leq i\leq n}{a_ia_ja_k}.&\\
\end{flalign*}
(b) Согласно формуле (13)
\begin{flalign*}
  &\sum_{0\leq i\leq n}{\sum_{0\leq j\leq i}{a_ia_j}}=\frac{1}{2}\biggl(\Bigl(\sum_{0\leq i\leq n}{a_i}\Bigl)^2+\Bigl(\sum_{0\leq i\leq n}{a_i^2}\Bigl)\biggl).&\\
\end{flalign*}
Заметим, что данную формулу можно было бы получить из формулы для квадрата суммы $n$ слагаемых.

Рассмотрим куб суммы двух слагаемых:
\begin{flalign*}
  &(a+b)^3=(a+b)(a+b)(a+b)=(a+b)(a^2+2ab+b^2)=&\\
  &a^3+2a^2b+ab^2+a^2b+2ab^2+b^3=a^3+b^3+3a^2b+3ab^2;&\\
\end{flalign*}
Для трех слагаемых:
\begin{flalign*}
  &(a+b+c)^3=(a+b+c)(a+b+c)(a+b+c)=(a+b+c)(a^2+b^2+c^2+2ab+2ac+2bc)=&\\
  &a^3+ab^2+ac^2+2a^2b+2a^2c+2abc+&\\
  &a^2b+b^3+bc^2+2ab^2+2abc+2b^2c+&\\
  &a^2c+b^2c+c^3+2abc+2ac^2+2bc^2=&\\
  &a^3+b^3+c^3+3a^2b+3a^2c+3ab^2+3b^2c+3ac^2+3bc^2+6abc;&\\
\end{flalign*}
Для четырех слагаемых:
\begin{flalign*}
  &(a+b+c+d)^3=(a+b+c+d)(a+b+c+d)(a+b+c+d)=&\\
  &(a+b+c+d)(a^2+b^2+c^2+d^2+2ab+2ac+2ad+2bc+2bd+2cd)=&\\
  &a^3+ab^2+ac^2+ad^2+2a^2b+2a^2c+2a^2d+2abc+2abd+2acd+&\\
  &a^2b+b^3+bc^2+bd^2+2ab^2+2abc+2abd+2b^2c+2b^2d+2bcd+&\\
  &a^2c+b^2c+c^3+cd^2+2abc+2ac^2+2acd+2bc^2+2bcd+2c^2d+&\\
  &a^2d+b^2d+c^2d+d^3+2abd+2acd+2ad^2+2bcd+2bd^2+2cd^2=&\\
  &a^3+b^3+c^3+d^3+3a^2b+3a^2c+3a^2d+3ab^2+3b^2c+3b^2d+3ac^2+3bc^2+3c^2d+3ad^2+3bd^2+3cd^2+&\\
  &6abc+6abd+6acd+6bcd&\\
\end{flalign*}
Для $n$ слагаемых:
\begin{flalign*}
  &(a_1+a_2+\dots+a_n)^3=(a_1+a_2+\dots+a_n)(a_1+a_2+\dots+a_n)(a_1+a_2+\dots+a_n)=&\\
  &\sum_{0\leq i\leq n}{a_i^3}+
  3\biggl(\sum_{0\leq i\leq n}{a_i^2}\biggl)\biggl(\sum_{0\leq i\leq n}{a_i}\biggl)-
  3\sum_{0\leq i\leq n}{a_i^3}+
  6\sum_{0\leq i\leq n}{\sum_{i+1\leq j\leq n}{\sum_{j+1\leq k\leq n}{a_ia_ja_k}}}=
  &\\
  &-2\sum_{0\leq i\leq n}{a_i^3}+
  3\biggl(\sum_{0\leq i\leq n}{a_i^2}\biggl)\biggl(\sum_{0\leq i\leq n}{a_i}\biggl)+
  6\sum_{0\leq i\leq n}{\sum_{i+1\leq j\leq n}{\sum_{j+1\leq k\leq n}{a_ia_ja_k}}}.
  &\\
\end{flalign*}
Мы получили одним из слагаемых тройную сумму, похожую на ту, которую требуется преобразовать. Приведем её к нужному нам виду.
\begin{flalign*}
  &\sum_{0\leq i\leq n}{\sum_{i+1\leq j\leq n}{\sum_{j+1\leq k\leq n}{a_ia_ja_k}}}=
  \sum_{0\leq i\leq n}{\sum_{i\leq j\leq n}{\sum_{j\leq k\leq n}{a_ia_ja_k}}}-
  \biggl(\sum_{0\leq i\leq n}{a_i^2}\biggl)\biggl(\sum_{0\leq i\leq n}{a_i}\biggl).
  &\\
\end{flalign*}
Кроме того,
\begin{flalign*}
  &\sum_{0\leq i\leq n}{\sum_{0\leq j\leq i}{\sum_{0\leq k\leq j}{a_ia_ja_k}}}=
  \sum_{0\leq i\leq n}{\sum_{i\leq j\leq n}{\sum_{j\leq k\leq n}{a_ia_ja_k}}}.&\\
\end{flalign*}

Итого имеем
\begin{flalign*}
  &\biggl(\sum_{0\leq i\leq n}{a_i}\biggl)^3=
  -2\sum_{0\leq i\leq n}{a_i^3}+
  3\biggl(\sum_{0\leq i\leq n}{a_i^2}\biggl)\biggl(\sum_{0\leq i\leq n}{a_i}\biggl)+
  6\sum_{0\leq i\leq n}{\sum_{i\leq j\leq n}{\sum_{j\leq k\leq n}{a_ia_ja_k}}}-
  6\biggl(\sum_{0\leq i\leq n}{a_i^2}\biggl)\biggl(\sum_{0\leq i\leq n}{a_i}\biggl);
  &\\
  &6\sum_{0\leq i\leq n}{\sum_{i\leq j\leq n}{\sum_{j\leq k\leq n}{a_ia_ja_k}}}=
  \biggl(\sum_{0\leq i\leq n}{a_i}\biggl)^3+
  3\biggl(\sum_{0\leq i\leq n}{a_i^2}\biggl)\biggl(\sum_{0\leq i\leq n}{a_i}\biggl)+
  2\sum_{0\leq i\leq n}{a_i^3};&\\
  &\sum_{0\leq i\leq n}{\sum_{0\leq j\leq i}{\sum_{0\leq k\leq j}{a_ia_ja_k}}}=
  \frac{1}{6}\biggl(\sum_{0\leq i\leq n}{a_i}\biggl)^3+\frac{1}{2}
  \biggl(\sum_{0\leq i\leq n}{a_i^2}\biggl)\biggl(\sum_{0\leq i\leq n}{a_i}\biggl)+
  \frac{1}{3}\sum_{0\leq i\leq n}{a_i^3}.&\\
\end{flalign*}

\subsubsection{30.}
(Ж. Бине (J. Binet), 1812.) Не пользуясь индукцией, докажите тождество
\begin{flalign*}
  &\biggl(\sum_{j=1}^{n}{a_jx_j}\biggl)\biggl(\sum_{j=1}^{n}{b_jy_j}\biggl)=
  \biggl(\sum_{j=1}^{n}{a_jy_j}\biggl)\biggl(\sum_{j=1}^{n}{b_jx_j}\biggl)+
  \sum_{1\leq j<k\leq n}{(a_jb_k-a_kb_j)(x_jy_k-x_ky_j)}.&\\
\end{flalign*}
    [У этого тождества есть важный частный случай: если положить $a_j=w_j,\ b_j=\bar{z}_j,\ x_j=\bar{w}_j,\ y_j=z_j$, то для произвольных комплексных чисел $w_1,\ \dots,\ w_n,\ z_1,\ \dots,\ z_n$ выполняется равенство
      \begin{flalign*}
        &\biggl(\sum_{j=1}^{n}{|w_j|^2}\biggl)\biggl(\sum_{j=1}^{n}{|z_j|^2}\biggl)=
        \biggl|\sum_{j=1}^{n}{w_jz_j}\biggl|^2+
        \sum_{1\leq j<k\leq n}{|w_j\bar{z}_k-w_k\bar{z}_j|^2}.&\\
      \end{flalign*}
      Члены $|w_j\bar{z}_k-w_k\bar{z}_j|^2$ неотрицательны, поэтому знаменитой \emph{неравенство Коши-Шварца}
      \begin{flalign*}
        &\biggl(\sum_{j=1}^{n}{|w_j|^2}\biggl)\biggl(\sum_{j=1}^{n}{|z_j|^2}\biggl)
        \geq
        \biggl|\sum_{j=1}^{n}{w_jz_j}\biggl|^2&\\
      \end{flalign*}
      является следствием формулы Бине.]

Нам даны четыре ряда чисел $A,\ B,\ X,\ Y$ по $n$ элементов в каждом:
    
\begin{tabularx}{0.8\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $j$ & $A$   & $X$  & $B$  & $Y$   \\
 \hline  $1$ & $a_1$ & $x_1$& $b_1$& $y_1$ \\
 \hline  $2$ & $a_2$ & $x_2$& $b_2$& $y_2$ \\
 \hline  $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$ \\
 \hline  $n$ & $a_n$ & $x_n$& $b_n$& $y_n$ \\
 \hline
\end{tabularx}

\begin{flalign*}
  &\biggl(\sum_{j=1}^{n}{a_jx_j}\biggl)\biggl(\sum_{j=1}^{n}{b_jy_j}\biggl)=
  \sum_{1\leq j\leq n}{\sum_{1\leq k\leq n}{a_jx_jb_ky_k}}=
  \sum_{j,k}{a_jx_jb_ky_k[1\leq j\leq n][1\leq k\leq n]}. &\\
\end{flalign*}

Выражение в левой части равенства представляет собой $n^2$ слагаемых:

\begin{tabularx}{0.8\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $j\backslash k$ & $1$   & $2$  & $\cdots$  & $n$   \\
 \hline  $1$ & $a_1x_1b_1y_1$ & $a_1x_1b_2y_2$& $a_1x_1\cdots$& $a_1x_1b_ny_n$ \\
 \hline  $2$ & $a_2x_2b_1y_1$ & $a_2x_2b_2y_2$& $a_2x_2\cdots$& $a_2x_2b_ny_n$ \\
 \hline  $\cdots$ & $\cdots b_1y_1$ & $\cdots b_2y_2$& $\cdots$& $\cdots b_ny_n$ \\
 \hline  $n$ & $a_nx_nb_1y_1$ & $a_nx_nb_2y_2$& $a_nx_n\cdots$& $a_nx_nb_ny_n$ \\
 \hline
\end{tabularx}

\begin{flalign*}
  &\biggl(\sum_{j=1}^{n}{a_jy_j}\biggl)\biggl(\sum_{j=1}^{n}{b_jx_j}\biggl)=
  \sum_{1\leq j\leq n}{\sum_{1\leq k\leq n}{a_jy_jb_kx_k}}=
  \sum_{j,k}{a_jy_jb_kx_k[1\leq j\leq n][1\leq k\leq n]}. &\\
\end{flalign*}

Первое слагаемое в правой части равенства также представляет собой сумму $n^2$ слагаемых:

\begin{tabularx}{0.8\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $j\backslash k$ & $1$   & $2$  & $\cdots$  & $n$   \\
 \hline  $1$ & $a_1y_1b_1x_1$ & $a_1y_1b_2x_2$& $a_1y_1\cdots$& $a_1y_1b_nx_n$ \\
 \hline  $2$ & $a_2y_2b_1x_1$ & $a_2y_2b_2x_2$& $a_2y_2\cdots$& $a_2y_2b_nx_n$ \\
 \hline  $\cdots$ & $\cdots b_1x_1$ & $\cdots b_2x_2$& $\cdots$& $\cdots b_nx_n$ \\
 \hline  $n$ & $a_ny_nb_1x_1$ & $a_ny_nb_2x_2$& $a_ny_n\cdots$& $a_ny_nb_nx_n$ \\
 \hline
\end{tabularx}

Вычтем из левой части равенства первое слагаемое в правой части:

\begin{flalign*}
  &\sum_{j,k}{a_jx_jb_ky_k[1\leq j\leq n][1\leq k\leq n]}-
  \sum_{j,k}{a_jy_jb_kx_k[1\leq j\leq n][1\leq k\leq n]}=&\\
  &\sum_{j,k}{(a_jx_jb_ky_k-a_jy_jb_kx_k)[1\leq j\leq n][1\leq k\leq n]}=
  \sum_{j,k}{a_jb_k(x_jy_k-x_ky_j)[1\leq j\leq n][1\leq k\leq n]}.&\\
\end{flalign*}

Мы получили также сумму $n^2$ слагаемых. Если представить её в виде таблицы, то диагональные элементы её будут равны $0$.

\begin{tabularx}{1.1\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $j\backslash k$ & $1$   & $2$  & $\cdots$  & $n$   \\
 \hline  $1$ & $0$ & $a_1b_2(x_1y_2-x_2y_1)$& $\cdots$& $a_1b_n(x_1y_n-x_ny_1)$ \\
 \hline  $2$ & $a_2b_1(x_2y_1-x_1y_2)$ & $0$& $\cdots$& $a_2b_n(x_2y_n-x_ny_2)$ \\
 \hline  $\cdots$ & $\cdots$ & $\cdots$& $0$& $\cdots$ \\
 \hline  $n$ & $a_nb_1(x_ny_1-x_1y_n)$ & $a_nb_2(x_ny_2-x_2y_n)$& $\cdots$& $0$ \\
 \hline
\end{tabularx}

Рассмотрим элементы данной суммы, находящиеся выше диагонали:
\begin{flalign*}
  &\sum_{j,k}{a_jb_k(x_jy_k-x_ky_j)[1\leq j\leq n][j< k\leq n]}.&\\
\end{flalign*}
Рассмотрим элементы, находящиеся ниже диагонали:
\begin{flalign*}
  &\sum_{j,k}{a_jb_k(x_jy_k-x_ky_j)[1\leq j\leq n][0\leq k<j]}=
  \sum_{j,k}{a_jb_k(x_jy_k-x_ky_j)[1\leq k\leq n][k<j\leq n]}=&\\
  &\sum_{j,k}{a_kb_j(x_ky_j-x_jy_k)[1\leq j\leq n][j<k\leq n]}=
  -\sum_{j,k}{a_kb_j(x_jy_k-x_ky_j)[1\leq j\leq n][j<k\leq n]}.&\\
\end{flalign*}
Две полусуммы (сверху и снизу от диагонали) составляют второе слагаемое в правой части равенства:
\begin{flalign*}
  &\sum_{j,k}{a_jb_k(x_jy_k-x_ky_j)[1\leq j\leq n][1\leq k\leq n]}=&\\
  &\sum_{j,k}{a_jb_k(x_jy_k-x_ky_j)[1\leq j\leq n][j< k\leq n]}-
  \sum_{j,k}{a_kb_j(x_jy_k-x_ky_j)[1\leq j\leq n][j<k\leq n]}=&\\
  &\sum_{j,k}{(a_jb_k-a_kb_j)(x_jy_k-x_ky_j)[1\leq j\leq n][j< k\leq n]}=
  \sum_{1\leq j<k\leq n}{(a_jb_k-a_kb_j)(x_jy_k-x_ky_j)}.&\\
\end{flalign*}

\subsubsection{31.}
С помощью формулы Бине выразите сумму $\sum_{1\leq j<k\leq n}{(u_j-u_k)(v_j-v_k)}$ через $\sum_{j=1}^{n}{u_jv_j}$, $\sum_{j=1}^{n}{u_j}$ и $\sum_{j-1}^{n}{v_j}$.

Обозначим в формуле Бине $a_j=u_j$, $a_k=u_k$, $x_j=v_j$, $x_k=v_k$, $b_k=b_j=y_k=y_j=1$:
\begin{flalign*}
  &\biggl(\sum_{j=1}^{n}{a_jx_j}\biggl)\biggl(\sum_{j=1}^{n}{b_jy_j}\biggl)=
  \biggl(\sum_{j=1}^{n}{a_jy_j}\biggl)\biggl(\sum_{j=1}^{n}{b_jx_j}\biggl)+
  \sum_{1\leq j<k\leq n}{(a_jb_k-a_kb_j)(x_jy_k-x_ky_j)};&\\
  &\biggl(\sum_{j=1}^{n}{u_jv_j}\biggl)\biggl(\sum_{j=1}^{n}{1\cdot 1}\biggl)=
  \biggl(\sum_{j=1}^{n}{u_j\cdot 1}\biggl)\biggl(\sum_{j=1}^{n}{1\cdot v_j}\biggl)+
  \sum_{1\leq j<k\leq n}{(u_j-u_k)(v_j-v_k)};&\\
  &\sum_{1\leq j<k\leq n}{(u_j-u_k)(v_j-v_k)}=n\sum_{j=1}^{n}{u_jv_j}-
  \biggl(\sum_{j=1}^{n}{u_j}\biggl)\biggl(\sum_{j=1}^{n}{v_j}\biggl).&\\
\end{flalign*}

\subsubsection{32.}
Докажите, что
\begin{flalign*}
  &\prod_{j=1}^{n}{\sum_{i=1}^{m}{a_{ij}}}=
  \sum_{1\leq i_1,\dots,i_n\leq m}{a_{i_11} \dots a_{i_nn}}.&\\
\end{flalign*}

Ряд чисел из $m$ элементов умножается на другие ряды из $m$ элементов $n$ раз. При $n=1$ итоговая сумма должна иметь $m$ слагаемых, при $n=2$ --- $m^2$, при $n$ --- $m^n$ слагаемых. В сумме в правой части равенства как раз $m^n$ слагаемых.

Для $n=1$:
\begin{flalign*}
  &\prod_{j=1}^{1}{\sum_{i=1}^{m}{a_{ij}}}=\sum_{i=1}^{m}{a_{i1}}=
  \sum_{1\leq i_1\leq m}{a_{i_11}}.&\\
\end{flalign*}

Предполагая по индукции, что равенство справедливо для $n\in[1..n]$ докажем его для $n+1$:
\begin{flalign*}
  &\prod_{j=1}^{n+1}{\sum_{i=1}^{m}{a_{ij}}}=
  \biggl(\sum_{1\leq i\leq m}{a_{i(n+1)}}\biggl)
  \biggl(\sum_{1\leq i_1,\dots,i_n\leq m}{a_{i_11} \dots a_{i_nn}}\biggl)=
  \sum_{1\leq i_1,\dots,i_n,i_{n+1}\leq m}{a_{i_11} \dots a_{i_nn}a_{i_{n+1}(n+1)}}.
  &\\
\end{flalign*}

\subsubsection{33.}
Однажды вечером д-р Матрица открыл формулы, которые можно считать ещё более замечательными по сравнению с формлами, приведенными в упр. 20:
\begin{flalign*}
  &\frac{1}{(a-b)(a-c)}+\frac{1}{(b-a)(b-c)}+\frac{1}{(c-a)(c-b)}=0,&\\
  &\frac{a}{(a-b)(a-c)}+\frac{b}{(b-a)(b-c)}+\frac{c}{(c-a)(c-b)}=0,&\\
  &\frac{a^2}{(a-b)(a-c)}+\frac{b^2}{(b-a)(b-c)}+\frac{c^2}{(c-a)(c-b)}=1,&\\
  &\frac{a^3}{(a-b)(a-c)}+\frac{b^3}{(b-a)(b-c)}+\frac{c^3}{(c-a)(c-b)}=a+b+c.&\\
\end{flalign*}
Докажите, что эти формулы являются частными случаями более общего закона. Покажите, что если $x_1,\ x_2,\ \dots,\ x_n$ --- различные числа, то
\begin{flalign*}
  &\sum_{j=1}^{n}{\left(
    x_j^r \middle/ \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}\right)}=
  \begin{cases}
    0,& \textrm{если }0\leq r<n-1;\\
    1,& \textrm{если }r=n-1;\\
    \sum_{j=1}^{n}{x_j},& \textrm{если }r=n.
  \end{cases}&\\
\end{flalign*}

Для $n=1$ имеем следующие соотношения:
\begin{flalign*}
  &\frac{1}{1}=1,&\\
  &\frac{a}{1}=a.&\\
\end{flalign*}

Для $n=2$ имеем следующие соотношения:
\begin{flalign*}
  &\frac{1}{a-b}+\frac{1}{b-a}=0,&\\
  &\frac{a}{a-b}+\frac{b}{b-a}=1,&\\
  &\frac{a^2}{a-b}+\frac{b^2}{b-a}=a+b.&\\
\end{flalign*}

Рассмотрим все возможные комбинации чисел $x_1,\ x_2,\ \dots,\ x_n$ в произведении:

\begin{tabularx}{0.8\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $i\backslash j$ & $1$   & $2$  & $\cdots$  & $n$   \\
 \hline  $1$ & $0$ & $x_1-x_2$& $\cdots$& $x_1-x_n$ \\
 \hline  $2$ & $x_2-x_1$ & $0$& $\cdots$& $x_2-x_n$ \\
 \hline  $\cdots$ & $\cdots$ & $\cdots$& $0$& $\cdots$ \\
 \hline  $n$ & $x_n-x_1$ & $x_n-x_2$& $\cdots$& $0$ \\
 \hline
\end{tabularx}

Элементы, симметричные относительно диагонали отличаются знаком $(x_i-x_j)=-(x_j-x_i)$. Между сомножителями, встречающимеся в знаменателе, и элементами, лежащими по одну из сторон от диагонали, существует взаимно однозначное соответствие с учетом знака.

В знаменателе в каждом слагаемом находится произведение всех элементов соответствующей строки за исключением одного, обращающегося в $0$.

Составим таблицу из первых слагаемых каждого элемента:

\begin{tabularx}{0.8\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $i\backslash j$ & $1$   & $2$  & $\cdots$  & $n$   \\
 \hline  $1$ & $x_1$ & $x_1$& $\cdots$& $x_1$ \\
 \hline  $2$ & $x_2$ & $x_2$& $\cdots$& $x_2$ \\
 \hline  $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$ \\
 \hline  $n$ & $x_n$ & $x_n$& $\cdots$& $x_n$ \\
 \hline
\end{tabularx}

Составим таблицу из вторых слагаемых каждого элемента:

\begin{tabularx}{0.8\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $i\backslash j$ & $1$   & $2$  & $\cdots$  & $n$   \\
 \hline  $1$ & $-x_1$ & $-x_2$& $\cdots$& $-x_n$ \\
 \hline  $2$ & $-x_1$ & $-x_2$& $\cdots$& $-x_n$ \\
 \hline  $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$ \\
 \hline  $n$ & $-x_1$ & $-x_2$& $\cdots$& $-x_n$ \\
 \hline
\end{tabularx}

Наибольшим общим кратным знаменателей всех слагаемых в левой части равенства является произведение всех элементов, лежащих выше диагонали: $\prod_{1\leq j\leq n}{\prod_{j<k\leq n}{(x_j-x_k)}}$. При сокращении дробей из произведения уходят элементы лежащие на соответствующей строке и соответствующем столбце.

Все сомножители в знаменателе сокращаются с соответствующими сомножителями в числителе. При этом часть из них при сокращении должна дать $-1$.

Количество таких сомножителей равно количеству сомножителей для которых $k<j$. В первом слагаемом таких сомножителей нет, во втором -- появляется одно слагаемое, во втором -- два и т.д. Таким образом, каждое слагаемое нужно домножить на $(-1)^{j+1}$.


\begin{flalign*}
  &\left(\prod_{1\leq i<k\leq n}{(x_i-x_k)} \middle/
  \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}\right)=
  (-1)^{j+1}\prod_{\substack{1\leq i<k\leq n\\i,k\neq j}}{(x_i-x_k)}=
  (-1)^{j+1}\prod_{\substack{1\leq i<k\leq n\\i,k\neq j}}{\sum_{l\in{i,k}}{x_{lik}}};&\\
  &x_{lik}=(-1)^{[l=k]}x_l;&\\
\end{flalign*}

Предполагая по индукции, что соотношения справедливы для всех $n\in[1..n]$, докажем их справедливость для случая $n+1$. Заметим, что с увеличением $n$ на единицу в левые части каждого соотношения добавляется по одному слагаемому, а количество соотношений также  увеличивается на единицу. Существующие слагаемые в левых частях соотношений видоизменяются следующим образом: $S_j'=\frac{S_j}{x_j-x_{n+1}}$.
Возьмем соотношение для $n$ слагаемых при $r=n$ и поделим каждое слагаемое в левой части на $x_j-x_{n+1}$:
\begin{flalign*}
  &\sum_{j=1}^{n}{\left(x_j^n \middle/
    \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}\right)}=
  \sum_{j=1}^{n}{x_j};&\\
  &\sum_{j=1}^{n}{\left(x_j^n \middle/
    (x_j-x_{n+1})\prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}\right)}=
  \sum_{j=1}^{n}{\left(x_j^n \middle/
    \prod_{\substack{1\leq k\leq n+1\\k\neq j}}{(x_j-x_k)}\right)};&\\
\end{flalign*}

Идеи связанные с представлением произведения $\prod_{1\leq i<k\leq n}{(x_i-x_k)}$ в виде суммы произведений не дали нужного результата. Последуем подсказке в ответах:
\begin{flalign*}
  &\sum_{j=1}^{n}{\left(
    x_j^r \middle/ \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}\right)}=
  \frac{1}{x_n-x_{n-1}}\left(\sum_{j=1}^{n}{
    \frac{x_j^r(x_n-x_{n-1})}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}\right)=&\\
  &\frac{1}{x_n-x_{n-1}}\left(\sum_{j=1}^{n}{
    \frac{x_j^rx_n}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}-
  \sum_{j=1}^{n}{
    \frac{x_j^rx_{n-1}}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}\right)=&\\
  &\frac{1}{x_n-x_{n-1}}\left(\sum_{j=1}^{n}{
    \frac{x_j^rx_j}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}-
  \sum_{j=1}^{n}{
    \frac{x_j^rx_j}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}+
  \sum_{j=1}^{n}{
    \frac{x_j^rx_n}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}-
  \sum_{j=1}^{n}{
    \frac{x_j^rx_{n-1}}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}\right)=&\\
  &\frac{1}{x_n-x_{n-1}}\left(\sum_{j=1}^{n}{
    \frac{x_j^r(x_j-x_{n-1})}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}-
  \sum_{j=1}^{n}{
    \frac{x_j^r(x_j-x_n)}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}\right).&\\
\end{flalign*}
\begin{flalign*}
  &\sum_{j=1}^{n}{
    \frac{x_j^r(x_j-x_n)}{
      \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}}}=
  \sum_{j=1}^{n-1}{\left(
    x_j^r \middle/ \prod_{\substack{1\leq k\leq n-1\\k\neq j}}{(x_j-x_k)}\right)}.&\\
\end{flalign*}
...
\subsubsection{34.}
...
\subsubsection{35.}
Запись $\sup_{R(j)}{a_j}$ применяется для обозначения точной верхней грани элементов $a_j$; при этом используется тот же принцип, что и в случае применения знаков ``$\sum$'' и ``$\prod$''. (Если $R(j)$ выполняется только для конечного числа $j$, то вместо записи $\sup_{R(j)}{a_j}$ часто используется запись $\max_{R(j)}{a_j}$.) Покажите, как нужно видоизменить правила (a), (b), (c) и (d) для выполнения операций с \emph{этим} обозначением. В частности, рассмотрите аналог правила (a)
\begin{flalign*}
  (\sup_{R(i)}{a_i})+(\sup_{S(j)}{b_j})=\sup_{R(i)}{(\sup_{S(j)}{(a_i+b_j)})}
\end{flalign*}
и дайте соответствующее определение $\sup_{R(j)}{a_j}$ для случая, когда $R(j)$ не выполняется \emph{ни для одного} $j$.

Правило (b):
\begin{flalign*}
  &\sup_{R(i)}{a_i}=\sup_{R(j)}{a_j}=\sup_{R(p(j))}{a_{p(j)}}.&\\
\end{flalign*}

Правило (c):
\begin{flalign*}
  &\sup_{R(i)}{(\sup_{S(j)}{(a_{ij})})}=\sup_{S(j)}{(\sup_{R(i)}{(a_{ij})})}.&\\
\end{flalign*}

Правило (d):
\begin{flalign*}
  &\sup{\left((\sup_{R(i)}{a_i}),(\sup_{S(j)}{a_j})\right)}=\sup_{R(j)\textrm{ или }S(j)}{a_j}.&\\
\end{flalign*}
Если $R(j)$ не удовлетворяет ни один элемент, то $\sup_{R(j)}{a_j}=-\infty$.

\subsubsection{36.}
Покажите, что определитель комбинаторной матрицы равен $x^{n-1}(x+ny)$.

Комбинаторная матрица состоит из элементов $a_{ij}=y+\delta_{ij}x$ и имеет вид
\begin{flalign*}
  A=
\begin{pmatrix}
  x+y & y & \cdots & y \\
  y & x+y & \cdots & y \\
  \vdots & \vdots & \ddots & \vdots \\
  y & y & \cdots & x+y
\end{pmatrix}
\end{flalign*}

Для вычисления определителя попробуем привести матрицу к треугольному виду. Сначала будем последовательно, начиная с последней строки, вычитать из $i$-й строки $i-1$-ю. Затем будем последовательно, начиная с предпоследнего столбца, прибавлять к $j$-му столбцу $j+1$-й.

\begin{flalign*}
  & \Delta_A=
  \begin{vmatrix}
    x+y & y & y & \cdots &y&y& y \\
    y & x+y & y &\cdots &y&y& y \\
    y & y & x+y &\cdots &y&y& y \\
    \vdots & \vdots & \vdots & \ddots &\vdots&\vdots& \vdots \\
    y & y & y & \cdots & x+y& y& y \\
    y & y & y & \cdots & y& x+y& y \\
    y & y & y & \cdots & y& y& x+y
  \end{vmatrix}=
  \begin{vmatrix}
    x+y & y & y & \cdots &y&y& y \\
    y & x+y & y &\cdots &y&y& y \\
    y & y & x+y &\cdots &y&y& y \\
    \vdots & \vdots & \vdots & \ddots &\vdots&\vdots& \vdots \\
    y & y & y & \cdots & x+y& y& y \\
    y & y & y & \cdots & y& x+y& y \\
    0 & 0 & 0 & \cdots & 0& -x& x
  \end{vmatrix}=\cdots=
  &\\
  &
  \begin{vmatrix}
    x+y & y & y & \cdots &y&y& y \\
    -x & x & 0 &\cdots &0&0& 0 \\
    0 & -x & x &\cdots &0&0& 0 \\
    \vdots & \vdots & \vdots & \ddots &\vdots&\vdots& \vdots \\
    0 & 0 & 0 & \cdots & x& 0& 0 \\
    0 & 0 & 0 & \cdots & -x& x& 0 \\
    0 & 0 & 0 & \cdots & 0& -x& x
  \end{vmatrix}=
  \begin{vmatrix}
    x+y & y & y & \cdots &y&2y& y \\
    -x & x & 0 &\cdots &0&0& 0 \\
    0 & -x & x &\cdots &0&0& 0 \\
    \vdots & \vdots & \vdots & \ddots &\vdots&\vdots& \vdots \\
    0 & 0 & 0 & \cdots & x& 0& 0 \\
    0 & 0 & 0 & \cdots & -x& x& 0 \\
    0 & 0 & 0 & \cdots & 0& 0& x
  \end{vmatrix}=\cdots=
  &\\
  &
  \begin{vmatrix}
    x+ny   & (n-1)y & (n-2)y &\cdots &3y    &2y    & y      \\
    0      & x      & 0      &\cdots &0     &0     & 0      \\
    0      & 0      & x      &\cdots &0     &0     & 0      \\
    \vdots & \vdots & \vdots &\ddots &\vdots&\vdots& \vdots \\
    0      & 0      & 0      &\cdots &x     & 0    & 0      \\
    0      & 0      & 0      &\cdots &0     & x    & 0      \\
    0      & 0      & 0      &\cdots &0     & 0    & x
  \end{vmatrix}=
  (x+ny)x^{n-1}.&\\
\end{flalign*}
Матрица $A$ приведена к треугольному виду, при этом определитель равен произведению элементов, стоящих на главной диагонали. В $n-1$ строках, начиная со второй, соответствующие элементы равны $x$.

\subsubsection{37.}
Покажите, что определитель матрицы Вандермонда равен
\begin{flalign*}
  \prod_{1\leq j\leq n}{x_j\prod_{1\leq i<j\leq n}{(x_j-x_i)}}.
\end{flalign*}
Матрица Вандермонда состоит из элементов $a_{ij}=x_j^i$ и имеет вид
\begin{flalign*}
  A=
\begin{pmatrix}
  x_1 & x_2 & \cdots & x_n \\
  x_1^2 & x_2^2 & \cdots & x_n^2 \\
  \vdots & \vdots & \ddots & \vdots \\
  x_1^n & x_2^n & \cdots & x_n^n
\end{pmatrix}
\end{flalign*}

\emph{Вариант 1}.
\begin{flalign*}
  &\Delta_A=
  \begin{vmatrix}
    x_1 & x_2 & \cdots & x_n \\
    x_1^2 & x_2^2 & \cdots & x_n^2 \\
    \vdots & \vdots & \ddots & \vdots \\
    x_1^n & x_2^n & \cdots & x_n^n
  \end{vmatrix}=
  x_1x_2\cdots x_n
  \begin{vmatrix}
    1 & 1 & \cdots & 1 \\
    x_1^1 & x_2^1 & \cdots & x_n^1 \\
    \vdots & \vdots & \ddots & \vdots \\
    x_1^{n-1} & x_2^{n-1} & \cdots & x_n^{n-1}
  \end{vmatrix}=
  \left(\prod_{1\leq j\leq n}{x_j}\right)
  \begin{vmatrix}
    1 & x_1 & \cdots & x_1^{n-1} \\
    1 & x_2 & \cdots & x_2^{n-1} \\
    \vdots & \vdots & \ddots & \vdots \\
    1 & x_n & \cdots & x_n^{n-1}
  \end{vmatrix}=
  &\\
  &
  \left(\prod_{1\leq j\leq n}{x_j}\right)
  \begin{vmatrix}
    1 & x_1 & \cdots & x_1^{n-1} \\
    0 & x_2-x_1 & \cdots & x_2^{n-1}-x_1^{n-1} \\
    \vdots & \vdots & \ddots & \vdots \\
    0 & x_n-x_1 & \cdots & x_n^{n-1}-x_1^{n-1}
  \end{vmatrix}=\cdots;
  &\\
\end{flalign*}

\begin{flalign*}
  &\arraycolsep=0.01em
\begin{array}{rrrrrrrr@{\,}r|l}
b^n&-&a^n&&&&&&&\,b-a\\
\cline{10-10}
b^n&-&ab^{n-1}&&&&&&&\,b^{n-1}+ab^{n-2}+\cdots+a^{n-2}b+a^{n-1}\\
\cline{1-4}
&ab^{n-1}&-&a^n\\
&ab^{n-1}&-&a^2b^{n-2}\\
\cline{2-4}
&&a^2b^{n-2}&-&a^n\\
&&&&\cdots\\
\cline{3-5}
&&&&a^{n-2}b^2&-&a^n\\
&&&&a^{n-2}b^2&-&a^{n-1}b\\
\cline{5-7}
&&&&&a^{n-1}b&-&a^n\\
&&&&&a^{n-1}b&-&a^n\\
\cline{6-8}
&&&&&&0
\end{array}&\\
&b^n-a^n=(b-a)(b^{n-1}+ab^{n-2}+\cdots+a^{n-2}b+a^{n-1}).&\\
\end{flalign*}

Таким образом, получается, что элементы в каждой $j$-й строке, начиная со второй, делятся на $(x_j-x_1)$.
\begin{flalign*}
  &\cdots=
  \left(\prod_{1\leq j\leq n}{x_j}\right)
  \left(\prod_{2\leq j\leq n}{x_j-x_1}\right)
  \begin{vmatrix}
    1 & x_1 & \cdots & x_1^{n-1} \\
    0 & 1 & \cdots & x_2^{n-2}+x_1x_2^{n-3}+\cdots+x_1^{n-3}x_2+x_1^{n-2} \\
    \vdots & \vdots & \ddots & \vdots \\
    0 & 1 & \cdots & x_n^{n-2}+x_1x_n^{n-3}+\cdots+x_1^{n-3}x_n+x_1^{n-2}
  \end{vmatrix}=
  &\\
  &
  \left(\prod_{1\leq j\leq n}{x_j}\right)
  \left(\prod_{2\leq j\leq n}{x_j-x_1}\right)
  \begin{vmatrix}
    1 & x_1 &x_1^2& \cdots & x_1^{n-1} \\
    0 & 1 & x_2+x_1& \cdots & x_2^{n-2}+x_1x_2^{n-3}+\cdots+x_1^{n-3}x_2+x_1^{n-2} \\
    0 & 0 & x_3-x_2& \cdots & x_3^{n-2}-x_2^{n-2}+x_1(x_3^{n-3}-x_2^{n-3})+\cdots+
    x_1^{n-3}(x_3-x_2) \\
    \vdots & \vdots &\vdots & \ddots & \vdots \\
    0 & 0 & x_n-x_2& \cdots & x_n^{n-2}-x_2^{n-2}+x_1(x_n^{n-3}-x_2^{n-3})+\cdots+
    x_1^{n-3}(x_n-x_2)
  \end{vmatrix};
  &\\
\end{flalign*}
Мы снова получили матрицу, в которой элементы в строках, начиная с третьей, делятся на $x_j-x_2$.

Таким образом, последовательно применяя вынесение общего множителя и сложение строк, мы приходим к формуле
\begin{flalign*}
  &
  \left(\prod_{1\leq j\leq n}{x_j}\right)
  \left(\prod_{2\leq j\leq n}{x_j-x_1}\right)
  \left(\prod_{3\leq j\leq n}{x_j-x_2}\right)
  \cdots
  \left(\prod_{n\leq j\leq n}{x_j-x_{n-1}}\right)=
  &\\
  &\left(\prod_{1\leq j\leq n}{x_j}\right)
  \left(\prod_{1\leq i<j\leq n}{(x_j-x_i)}\right)&\\
\end{flalign*}

\emph{Вариант 2}.
\begin{flalign*}
  &\Delta_A=
  \begin{vmatrix}
    x_1 & x_2 & \cdots & x_n \\
    x_1^2 & x_2^2 & \cdots & x_n^2 \\
    \vdots & \vdots & \ddots & \vdots \\
    x_1^n & x_2^n & \cdots & x_n^n
  \end{vmatrix}=
  \begin{vmatrix}
    x_1 & x_2-x_1 & \cdots & x_n-x_1 \\
    x_1^2 & x_2^2-x_1^2 & \cdots & x_n^2-x_1^2 \\
    \vdots & \vdots & \ddots & \vdots \\
    x_1^n & x_2^n-x_1^n & \cdots & x_n^n-x_1^n
  \end{vmatrix}=
  &\\
  &
  \begin{vmatrix}
    x_1 & x_2-x_1 & \cdots & x_n-x_1 \\
    x_1^2-x_1x_1 & x_2^2-x_1^2-x_1(x_2-x_1) & \cdots & x_n^2-x_1^2-x_1(x_n-x_1) \\
    \vdots & \vdots & \ddots & \vdots \\
    x_1^n-x_1x_1^{n-1} & x_2^n-x_1^n-x_1(x_2^{n-1}-x_1^{n-1}) & \cdots & x_n^n-x_1^n-x_1(x_n^{n-1}-x_1^{n-1})
  \end{vmatrix}=
  &\\
  &
  x_1(x_2-x_1)\cdots(x_n-x_1)
  \begin{vmatrix}
    1 & 1 & \cdots & 1 \\
    0 & x_2 & \cdots & x_n \\
    \vdots & \vdots & \ddots & \vdots \\
    0 & x_2^{n-1} & \cdots & x_{n-1}
  \end{vmatrix}=
  x_1\prod_{1<j\leq n}{(x_j-x_1)}
  \begin{vmatrix}
    x_2 & \cdots & x_n \\
    \vdots & \ddots & \vdots \\
    x_2^{n-1} & \cdots & x_{n-1}
  \end{vmatrix}=
  &\\
  &
  x_1x_2\prod_{1<j\leq n}{(x_j-x_1)}\prod_{2<j\leq n}{(x_j-x_2)}
  \begin{vmatrix}
    x_3 & \cdots & x_n \\
    \vdots & \ddots & \vdots \\
    x_3^{n-2} & \cdots & x_{n-2}
  \end{vmatrix}=\cdots=
  \left(\prod_{1\leq j\leq n}{x_j}\right)
  \left(\prod_{1\leq i<j\leq n}{(x_j-x_i)}\right).&\\
\end{flalign*}

\subsubsection{38.}
Покажите, что определитель матрицы Коши равен
\begin{flalign*}
  \left. \prod_{1\leq i<j\leq n}{(x_j-x_i)(y_j-y_i)} \middle/
  \prod_{1\leq i,j\leq n}{(x_i+y_j)} \right.
\end{flalign*}

Матрица Коши состоит из элементов $a_{ij}=1/(x_i+y_j)$ и имеет вид
\begin{flalign*}
  A=
  \begin{pmatrix}
    1/(x_1+y_1) & 1/(x_1+y_2) & \cdots & 1/(x_1+y_n) \\
    1/(x_2+y_1) & 1/(x_2+y_2) & \cdots & 1/(x_2+y_n) \\
    \vdots & \vdots & \ddots & \vdots \\
    1/(x_n+y_1) & 1/(x_n+y_2) & \cdots & 1/(x_n+y_n)
  \end{pmatrix}
\end{flalign*}

\begin{flalign*}
  &\Delta_A=
  \begin{vmatrix}
    1/(x_1+y_1) & 1/(x_1+y_2) & \cdots & 1/(x_1+y_n) \\
    1/(x_2+y_1) & 1/(x_2+y_2) & \cdots & 1/(x_2+y_n) \\
    \vdots & \vdots & \ddots & \vdots \\
    1/(x_n+y_1) & 1/(x_n+y_2) & \cdots & 1/(x_n+y_n)
  \end{vmatrix}=
  \begin{vmatrix}
    1/(x_1+y_1) & 1/(x_1+y_2) & \cdots & 1/(x_1+y_n) \\
    \frac{x_1-x_2}{(x_2+y_1)(x_1+y_1)} & \frac{x_1-x_2}{(x_2+y_2)(x_1+y_2)} & \cdots & \frac{x_1-x_2}{(x_2+y_n)(x_1+y_n)} \\
    \vdots & \vdots & \ddots & \vdots \\
    \frac{x_1-x_n}{(x_n+y_1)(x_1+y_1)} & \frac{x_1-x_n}{(x_n+y_2)(x_1+y_2)} & \cdots & \frac{x_1-x_n}{(x_n+y_n)(x_1+y_n)} \\
  \end{vmatrix}=
  &\\
  &
  \frac{1}{x_1+y_1}\frac{1}{x_1+y_2}\cdots\frac{1}{x_1+y_n}
  (x_1-x_2)(x_1-x_3)\cdots(x_1-x_n)
  \begin{vmatrix}
    1 & 1 & \cdots & 1 \\
    \frac{1}{(x_2+y_1)} & \frac{1}{(x_2+y_2)} & \cdots & \frac{1}{(x_2+y_n)} \\
    \vdots & \vdots & \ddots & \vdots \\
    \frac{1}{(x_n+y_1)} & \frac{1}{(x_n+y_2)} & \cdots & \frac{1}{(x_n+y_n)} \\
  \end{vmatrix}=
  &\\
  &
  \prod_{1\leq j\leq n}{\frac{1}{x_1+y_j}}\prod_{1<i\leq n}{(x_1-x_i)}
  \begin{vmatrix}
    1 & 0 & \cdots & 0 \\
    \frac{1}{(x_2+y_1)} & \frac{y_1-y_2}{(x_2+y_2)(x_2+y_1)} & \cdots & \frac{y_1-y_n}{(x_2+y_n)(x_2+y_1)} \\
    \vdots & \vdots & \ddots & \vdots \\
    \frac{1}{(x_n+y_1)} & \frac{y_1-y_2}{(x_n+y_2)(x_n+y_1)} & \cdots & \frac{y_1-y_n}{(x_n+y_n)(x_n+y_1)} \\
  \end{vmatrix}=
  &\\
  &
  \prod_{1\leq j\leq n}{\frac{1}{x_1+y_j}}\prod_{1<i\leq n}{(x_1-x_i)}
  \prod_{1<i\leq n}{\frac{1}{x_i+y_1}}\prod_{1<i\leq n}{(y_1-y_i)}
  \begin{vmatrix}
    1 & 0 & \cdots & 0 \\
    1 & \frac{1}{(x_2+y_2)} & \cdots & \frac{1}{(x_2+y_n)} \\
    \vdots & \vdots & \ddots & \vdots \\
    1 & \frac{1}{(x_n+y_2)} & \cdots & \frac{1}{(x_n+y_n)} \\
  \end{vmatrix}
  .&\\
\end{flalign*}

Получили матрицу Коши $n-1$-го порядка. Последовательно применяя подобные преобразования к матрицам меньших порядков получим:

\begin{flalign*}
  &\left(
  \prod_{1\leq j\leq n}{\frac{1}{x_1+y_j}}\prod_{1<i\leq n}{\frac{1}{x_i+y_1}}
  \prod_{1<i\leq n}{(x_1-x_i)(y_1-y_i)} \right)&\\
  &\left(
  \prod_{2\leq j\leq n}{\frac{1}{x_2+y_j}}\prod_{2<i\leq n}{\frac{1}{x_i+y_2}}
  \prod_{2<i\leq n}{(x_2-x_i)(y_2-y_i)} \right)&\\
  &\cdots&\\
  &\left(
  \prod_{n-1\leq j\leq n}{\frac{1}{x_{n-1}+y_j}}\prod_{n-1<i\leq n}{\frac{1}{x_i+y_{n-1}}}
  \prod_{n-1<i\leq n}{(x_{n-1}-x_i)(y_{n-1}-y_i)} \right)&\\
  &\left( \frac{1}{x_n+y_n} \right)=&\\
  &\prod_{1\leq i,j\leq n}{\frac{1}{x_i+y_j}}\prod_{1\leq j<i\leq n}{(x_j-x_i)(y_j-y_i)}=
  \prod_{1\leq i,j\leq n}{\frac{1}{x_i+y_j}}\prod_{1\leq j<i\leq n}{(x_i-x_j)(y_i-y_j)}= &\\
  &\prod_{1\leq i,j\leq n}{\frac{1}{x_i+y_j}}\prod_{1\leq i<j\leq n}{(x_j-x_i)(y_j-y_i)}.&\\
\end{flalign*}

\subsubsection{39.}

Покажите, что матрица, обратная комбинаторной, --- это комбинаторная матрица с элементами $b_{ij}=\left.\left(-y+\delta_{ij}(x+ny)\right)\middle/x(x+ny)\right.$.

Рассмотрим матрицу $B$, которая имеет вид:
\begin{flalign*}
  &B=
  \begin{pmatrix}
    \frac{x+(n-1)y}{x(x+ny)} & \frac{-y}{x(x+ny)}& \cdots & \frac{-y}{x(x+ny)} \\
    \frac{-y}{x(x+ny)}& \frac{x+(n-1)y}{x(x+ny)} &\cdots & \frac{-y}{x(x+ny)} \\
    \vdots & \vdots & \ddots & \vdots \\
    \frac{-y}{x(x+ny)}& \frac{-y}{x(x+ny)} &\cdots & \frac{x+(n-1)y}{x(x+ny)} \\
  \end{pmatrix}&\\
\end{flalign*}

\begin{flalign*}
  &A*B=
  \begin{pmatrix}
  x+y & y & \cdots & y \\
  y & x+y & \cdots & y \\
  \vdots & \vdots & \ddots & \vdots \\
  y & y & \cdots & x+y
  \end{pmatrix}
  \begin{pmatrix}
    \frac{x+(n-1)y}{x(x+ny)} & \frac{-y}{x(x+ny)}& \cdots & \frac{-y}{x(x+ny)} \\
    \frac{-y}{x(x+ny)}& \frac{x+(n-1)y}{x(x+ny)} &\cdots & \frac{-y}{x(x+ny)} \\
    \vdots & \vdots & \ddots & \vdots \\
    \frac{-y}{x(x+ny)}& \frac{-y}{x(x+ny)} &\cdots & \frac{x+(n-1)y}{x(x+ny)} \\
  \end{pmatrix}=
  &\\
  &
  \begin{pmatrix}
    \frac{(x+y)(x+(n-1)y)-y^2(n-1)}{x(x+ny)} & \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)}& \cdots & \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)} \\
    \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)}& \frac{(x+y)(x+(n-1)y)-y^2(n-1)}{x(x+ny)} &\cdots & \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)} \\
    \vdots & \vdots & \ddots & \vdots \\
    \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)}& \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)} &\cdots & \frac{(x+y)(x+(n-1)y)-y^2(n-1)}{x(x+ny)} \\
  \end{pmatrix}.
  &\\
\end{flalign*}

\begin{flalign*}
  &\frac{(x+y)(x+(n-1)y)-y^2(n-1)}{x(x+ny)}=
  \frac{x^2+xy(n-1)+xy+y^2(n-1)-y^2(n-1)}{x(x+ny)}=&\\
  &\frac{x^2+xyn}{x(x+ny)}=\frac{x(x+ny)}{x(x+ny)}=1;&\\
  &\frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)}=
  \frac{-yx-y^2+yx+(n-1)y^2-y^2(n-2)}{x(x+ny)}=&\\
  &\frac{(n-1)y^2-y^2(n-1)}{x(x+ny)}=0.&\\
\end{flalign*}

\begin{flalign*}
  &A*B=
  \begin{pmatrix}
  1 & 0 & \cdots & 0 \\
  0 & 1 & \cdots & 0 \\
  \vdots & \vdots & \ddots & \vdots \\
  0 & 0 & \cdots & 1
  \end{pmatrix}
  &\\
\end{flalign*}

\begin{flalign*}
  &B*A=
  \begin{pmatrix}
    \frac{x+(n-1)y}{x(x+ny)} & \frac{-y}{x(x+ny)}& \cdots & \frac{-y}{x(x+ny)} \\
    \frac{-y}{x(x+ny)}& \frac{x+(n-1)y}{x(x+ny)} &\cdots & \frac{-y}{x(x+ny)} \\
    \vdots & \vdots & \ddots & \vdots \\
    \frac{-y}{x(x+ny)}& \frac{-y}{x(x+ny)} &\cdots & \frac{x+(n-1)y}{x(x+ny)} \\
  \end{pmatrix}
  \begin{pmatrix}
  x+y & y & \cdots & y \\
  y & x+y & \cdots & y \\
  \vdots & \vdots & \ddots & \vdots \\
  y & y & \cdots & x+y
  \end{pmatrix}
  =
  &\\
  &
  \begin{pmatrix}
    \frac{(x+y)(x+(n-1)y)-y^2(n-1)}{x(x+ny)} & \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)}& \cdots & \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)} \\
    \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)}& \frac{(x+y)(x+(n-1)y)-y^2(n-1)}{x(x+ny)} &\cdots & \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)} \\
    \vdots & \vdots & \ddots & \vdots \\
    \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)}& \frac{-y(x+y)+y(x+(n-1)y)-y^2(n-2)}{x(x+ny)} &\cdots & \frac{(x+y)(x+(n-1)y)-y^2(n-1)}{x(x+ny)} \\
  \end{pmatrix}=
  &\\
  &
  \begin{pmatrix}
  1 & 0 & \cdots & 0 \\
  0 & 1 & \cdots & 0 \\
  \vdots & \vdots & \ddots & \vdots \\
  0 & 0 & \cdots & 1
  \end{pmatrix}
  &\\
\end{flalign*}
Так как $A*B=B*A=1$, $B=A^{-1}$.

\subsubsection{40.}
Покажите, что элементы матрицы, обратной матрице Вандермонда, имеют вид
\begin{flalign*}
  b_{ij}=\left.\left(\sum_{\substack{1\leq k_1<\cdots<k_{n-j}\leq n\\k_1,\cdots,k_{n-j}\neq i}}{(-1)^{j-1}x_{k_1}\cdots x_{k_{n-j}}}\right)\middle/x_i\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_k-x_i)}\right. .
\end{flalign*}
Пусть вас не пугает сложная сумма в числителе --- это просто коэффициент при $x^{j-1}$ в многочлене $(x_1-x)\cdots(x_n-x)/(x_i-x)$.

\begin{flalign*}
  &\frac{\prod_{1\leq k\leq n}{(x_k-x)}}{x_i-x}=
  \prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_k-x)}=
  S_0+S_1x+S_2x^2+\cdots S_{n-1}x^{n-1}=\sum_{0\leq j<n}{S_jx^j}=
  \sum_{1\leq j\leq n}{S_{j-1}x^{j-1}}.&\\
\end{flalign*}

Если вместо переменной $x$ подставить $x_1,\ x_2,\ \cdots,\ x_n$, то вместо $S_{0},\ S_{1},\ \cdots,\ S_{n-1}$ можно использовать $S_{10},\ S_{11},\ \cdots,\ S_{1n-1},\ S_{20},\ S_{21},\ \cdots,\ S_{2n-1},\ \cdots,\ S_{n0},\ S_{n1},\ \cdots,\ S_{nn-1}$. 

Элементы матрицы $B$ имеют вид $b_{ij}=\frac{b_{c_{ij}}}{b_{r_i}}$.
\begin{flalign*}
  &b_{r_{1}}=x_1(x_2-x_1)(x_3-x_1)\cdots(x_n-x_1)=
  x_1\prod_{1<k\leq n}{(x_k-x_1)}=x_1P_1; &\\
  &b_{r_{2}}=x_2(x_1-x_2)(x_3-x_2)\cdots(x_n-x_2)=
  x_2\prod_{\substack{1\leq k\leq n\\k\neq 2}}{(x_k-x_2)}=x_2P_2; &\\
  &\cdots&\\
  &b_{r_{n-1}}=x_{n-1}(x_1-x_{n-1})(x_2-x_{n-1})\cdots(x_{n}-x_{n-1})=
  x_{n-1}\prod_{\substack{1\leq k\leq n\\k\neq n-1}}{(x_k-x_{n-1})}=x_{n-1}P_{n-1};
  &\\
  &b_{r_{n}}=x_n(x_1-x_n)(x_2-x_n)\cdots(x_{n-1}-x_n)=
  x_n\prod_{1\leq k<n}{(x_k-x_n)}=x_nP_n. &\\
\end{flalign*}

Мы знаем, что $\sum_{\substack{1\leq k_1<\cdots<k_{n-j}\leq n\\k_1,\cdots,k_{n-j}\neq i}}{(-1)^{j-1}x_{k_1}\cdots x_{k_{n-j}}}$ --- коэффициент при $x_i^{j-1}$ в многочлене $\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_k-x_i)}$, т.е. $S_{ij-1}$.

\begin{flalign*}
  &b_{c_{11}}=S_{10}; && b_{c_{12}}=S_{11}; && \cdots && b_{c_{1n}}=S_{1n-1}; &\\
  &b_{c_{21}}=S_{20}; && b_{c_{22}}=S_{21}; && \cdots && b_{c_{2n}}=S_{2n-1}; &\\
  &\cdots&\\
  &b_{c_{n1}}=S_{n0}; && b_{c_{n2}}=S_{n1}; && \cdots && b_{c_{nn}}=S_{nn-1}. &\\
\end{flalign*}

Таким образом, матрица $B$ имеет вид:
\begin{flalign*}
  &B=
  \begin{pmatrix}
    \frac{S_{10}}{x_1P_1}&\frac{S_{11}}{x_1P_1}&\cdots&\frac{S_{1n-1}}{x_1P_1}\\
    \frac{S_{20}}{x_2P_2}&\frac{S_{21}}{x_2P_2}&\cdots&\frac{S_{2n-1}}{x_2P_2}\\
    \vdots&\vdots&\ddots&\vdots\\
    \frac{S_{n0}}{x_nP_n}&\frac{S_{n1}}{x_nP_n}&\cdots&\frac{S_{nn-1}}{x_nP_n}\\
  \end{pmatrix}
  &\\
\end{flalign*}

Рассмотрим произведение $B$ на $A$. Диагональные элементы обращаются в $1$:
\begin{flalign*}
  &\frac{S_{i0}}{x_iP_i}x_i+\frac{S_{i1}}{x_iP_i}x_i^2+\cdots+\frac{S_{in-1}}{x_iP_i}x_i^n=\frac{x_i(S_{i0}+S_{i1}x_i+\cdots+S_{in-1}x_i^{n-1})}{x_iP_i}=
  \frac{P_i}{P_i}=1.&\\
\end{flalign*}
Остальные элементы обращаются в $0$:
\begin{flalign*}
  &\frac{S_{i0}}{x_iP_i}x_l+\frac{S_{i1}}{x_iP_i}x_l^2+\cdots+\frac{S_{in-1}}{x_iP_i}x_l^n=\frac{x_l(S_{i0}+S_{i1}x_l+\cdots+S_{in-1}x_l^{n-1})}{x_iP_i}=
  \frac{x_l\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_k-x_l)}}{x_iP_i}=0,&\\
\end{flalign*}
так как $l\neq i$ и $1\leq l\leq n$.

Произведение $A$ на $B$ подобным образом не сокращается. Например, диагональные элементы:
\begin{flalign*}
  &\frac{S_{1j-1}}{x_1P_1}x_1^j+\frac{S_{2j-1}}{x_2P_2}x_2^j+\cdots+\frac{S_{nj-1}}{x_nP_n}x_n^j=
  \frac{S_{1j-1}}{P_1}x_1^{j-1}+\frac{S_{2j-1}}{P_2}x_2^{j-1}+\cdots+\frac{S_{nj-1}}{P_n}x_n^{j-1}.&\\
\end{flalign*}

\subsubsection{41.}
Покажите, что элементы матрицы, обратной матрице Коши, имеют вид
\begin{flalign*}
  b_{ij}=\left.\left(\prod_{1\leq k\leq n}{(x_j+y_k)(x_k+y_i)}\right)\middle/(x_j+y_i)\left(\prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}\right)\left(\prod_{\substack{1\leq k\leq n\\k\neq i}}{(y_i-y_k)}\right)\right. .
\end{flalign*}

Найдем алгебраические дополнения для матрицы Коши. Определитель матрицы Коши равен:
\begin{flalign*}
  &\left. \prod_{1\leq i<j\leq n}{(x_j-x_i)(y_j-y_i)} \middle/
  \prod_{1\leq i,j\leq n}{(x_i+y_j)} \right. .&\\
\end{flalign*}

При вычеркивании любой строки или любого столбца в матрице Коши получается матрица Коши меньшего порядка. Дополнительные миноры и элементы присоединенной матрицы имеют вид:
\begin{flalign*}
  &\\
  &M_{ij}=\left.
  \prod_{\substack{1\leq k<l\leq n\\k,l\neq i}}{(x_l-x_k)}
  \prod_{\substack{1\leq k<l\leq n\\k,l\neq j}}{(y_l-y_k)}
  \middle/
  \prod_{\substack{1\leq k,l\leq n\\k\neq i,\ l\neq j}}{(x_k+y_l)} \right. ;&\\
  &A_{ij}^*=(-1)^{i+j}M_{ji}.&\\
\end{flalign*}

Элементы обратной матрицы равны:
\begin{flalign*}
  &B_{ij}=\frac{A_{ij}^*}{\Delta_A}=&\\
  &\left.
  (-1)^{i+j}\left(
  \prod_{\substack{1\leq k<l\leq n\\k,l\neq j}}{(x_l-x_k)}
  \prod_{\substack{1\leq k<l\leq n\\k,l\neq i}}{(y_l-y_k)}
  \middle/\prod_{\substack{1\leq k,l\leq n\\k\neq j,\ l\neq i}}{(x_k+y_l)} \right)
  \middle/\right.&\\
  &
  \left( \prod_{1\leq k<l\leq n}{(x_l-x_k)(y_l-y_k)} \middle/
  \prod_{1\leq k,l\leq n}{(x_k+y_l)} \right)=&\\
  &(-1)^{i+j}\left.
  \prod_{\substack{1\leq k<l\leq n\\k,l\neq j}}{(x_l-x_k)}
  \prod_{\substack{1\leq k<l\leq n\\k,l\neq i}}{(y_l-y_k)}
  \prod_{1\leq k,l\leq n}{(x_k+y_l)}
  \middle/
    \prod_{\substack{1\leq k,l\leq n\\k\neq j,\ l\neq i}}{(x_k+y_l)}
    \prod_{1\leq k<l\leq n}{(x_l-x_k)(y_l-y_k)}
  \right. .&\\
\end{flalign*}
\begin{flalign*}
  &\left.
  \prod_{1\leq k,l\leq n}{(x_k+y_l)}
  \middle/
  \prod_{\substack{1\leq k,l\leq n\\k\neq j,\ l\neq i}}{(x_k+y_l)}
  \right. =
  \left.
  \prod_{1\leq l\leq n}{(x_j+y_l)} \prod_{1\leq k\leq n}{(x_k+y_i)}
  \middle/
  (x_j+y_i)
  \right.=&\\
  &\left.\prod_{1\leq k\leq n}{(x_j+y_k)(x_k+y_i)}\middle/(x_j+y_i)\right..&\\
\end{flalign*}
\begin{flalign*}
  &\left.
  \prod_{1\leq k<l\leq n}{(x_l-x_k)}
  \middle/
  \prod_{\substack{1\leq k<l\leq n\\k,l\neq j}}{(x_l-x_k)}
  \right.=
  \prod_{j<l\leq n}{(x_l-x_j)}\prod_{1\leq k<j}{(x_j-x_k)}=&\\
  &(-1)^{n-j}\prod_{j<l\leq n}{(x_j-x_l)}\prod_{1\leq k<j}{(x_j-x_k)}=
  (-1)^{n-j}\prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)};&\\
  &\left.
  \prod_{1\leq k<l\leq n}{(y_l-y_k)}
  \middle/
  \prod_{\substack{1\leq k<l\leq n\\k,l\neq i}}{(y_l-y_k)}
  \right.=
  (-1)^{n-i}\prod_{\substack{1\leq k\leq n\\k\neq i}}{(y_i-y_k)}.&\\
\end{flalign*}

Итого мы получили все части формулы. Остается разобраться с $-1$:
\begin{flalign*}
  &\frac{(-1)^{i+j}}{(-1)^{2n-i-j}}=(-1)^{i+j-2n+i+j}=\left((-1)^{i+j-n}\right)^2=1.
\end{flalign*}

\subsubsection{42.}
Чему равна сумма всех $n^2$ элементов матрицы, обратной комбинаторной?

Матрица, обратная комбинаторной, --- это комбинаторная матрица с элементами $b_{ij}=\left.\left(-y+\delta_{ij}(x+ny)\right)\middle/x(x+ny)\right.$.
Комбинаторная матрица состоит из элементов $a_{ij}=y+\delta_{ij}x$.

Сумма всех элементов комбинаторной матрицы $\sum_A=n(n-1)y+n(x+y)=n(x+ny)$.
Подставим в эту формулу вместо $x$ $1/x$, а вместо $y$ --- $-y/x(x+ny)$.
\begin{flalign*}
  &\sum_B=n\left(\frac{1}{x}-\frac{ny}{x(x+ny)}\right)=
  n\frac{x+ny-ny}{x(x+ny)}=\frac{n}{x+ny}.&\\
\end{flalign*}

\subsubsection{43.}
Чему равна сумма всех $n^2$ элементов матрицы, обратной матрице Вандермонда? [\emph{Указание}. Воспользуйтесь упр. 33.]

Элементы матрицы $B$ имеют вид $b_{ij}=\frac{S_{ij-1}}{x_iP_i}$. Сумма элементов $i$-й строки равна
\begin{flalign*}
  &\sum_{1\leq j\leq n}{\frac{S_{ij-1}}{x_i\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_k-x_i)}}}=
  \frac{\sum_{1\leq j\leq n}{S_{ij-1}}}{x_i\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_k-x_i)}}=
  \frac{\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_k-1)}}{x_i\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_k-x_i)}}=
  \frac{\prod_{\substack{1\leq k\leq n\\k\neq i}}{(1-x_k)}}{x_i\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_i-x_k)}}=&\\
  &\frac{\prod_{1\leq k\leq n}{(1-x_k)}}{x_i(1-x_i)\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_i-x_k)}}.&\\
\end{flalign*}

Просуммируем полученные выражения по строкам. Числитель не зависит от $i$ и может быть вынесен за знак суммы.
\begin{flalign*}
  &\prod_{1\leq k\leq n}{(1-x_k)}\sum_{1\leq i\leq n}{\left(1\middle/x_i(1-x_i)\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_i-x_k)}\right)}.&\\
\end{flalign*}

Согласно упражнению 33:
\begin{flalign*}
  &\sum_{j=1}^{n}{\left(
    x_j^r \middle/ \prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}\right)}=
  \begin{cases}
    0,& \textrm{если }0\leq r<n-1;\\
    1,& \textrm{если }r=n-1;\\
    \sum_{j=1}^{n}{x_j},& \textrm{если }r=n.
  \end{cases}&\\
\end{flalign*}

...

\subsubsection{44.}
Чему равна сумма всех $n^2$ элементов матрицы, обратной матрице Коши?

Элементы матрицы, обратной матрице Коши, имеют вид
\begin{flalign*}
  b_{ij}=\left.\left(\prod_{1\leq k\leq n}{(x_j+y_k)(x_k+y_i)}\right)\middle/(x_j+y_i)\left(\prod_{\substack{1\leq k\leq n\\k\neq j}}{(x_j-x_k)}\right)\left(\prod_{\substack{1\leq k\leq n\\k\neq i}}{(y_i-y_k)}\right)\right. .
\end{flalign*}

Сумма элементов в $i$-й строке равна
\begin{flalign*}
  &\frac{\prod_{1\leq k\leq n}{(x_k+y_i)}}{\prod{\substack{1\leq k\leq n\\ k\neq i}}{(y_i-y_k)}}\sum_{1\leq j\leq n}{\frac{\prod_{\substack{1\leq k\leq n\\k\neq i}}{(x_j+y_k)}}{\prod{\substack{1\leq k\leq n\\ k\neq j}}{(x_j-x_k)}}}.
  &\\
\end{flalign*}

...

\subsubsection{45.}
...

\subsubsection{46.}
...

\subsubsection{47.}
...

\subsection{Целочисленные функции и элементарная теория чисел }

\subsubsection{1.}
Чему равны $\lfloor 1.1 \rfloor,\ \lfloor -1.1 \rfloor,\ \lceil -1.1 \rceil,\ \lfloor 0.99999 \rfloor$ и $\lfloor \lg{35} \rfloor$?

\begin{flalign*}
  &\lfloor 1.1 \rfloor = 1;&\\
  &\lfloor -1.1 \rfloor = -2;&\\
  &\lceil -1.1 \rceil = -1;&\\
  &\lfloor 0.99999 \rfloor = 0;&\\
  &\lfloor \lg{35} \rfloor = 5.&\\
\end{flalign*}

\subsubsection{2.}
Чему равно $\bigl \lceil \lfloor x \rfloor \bigl \rceil$?

$\lfloor x \rfloor$ --- целое число, следовательно $\bigl \lceil \lfloor x \rfloor \bigl \rceil = \lfloor x \rfloor$.

\subsubsection{3.}
Пусть $n$ --- целое, а $x$ --- действительное число. Докажите, что:
\begin{enumerate}[label=\alph*)]
  \item $\lfloor x\rfloor<n$ тогда и только тогда, когда $x<n$;
  \item $n\leq\lfloor x\rfloor$ тогда и только тогда, когда $n\leq x$;
  \item $\lceil x\rceil\leq n$ тогда и только тогда, когда $x\leq n$;
  \item $n<\lceil x\rceil$ тогда и только тогда, когда $n<x$;
  \item $\lfloor x\rfloor=n$ тогда и только тогда, когда $x-1<n\leq x$, а также тогда и только тогда, когда $n\leq x<n+1$;
  \item $\lceil x\rceil=n$ тогда и только тогда, когда $x\leq n<x+1$, а также тогда и только тогда, когда $n-1<x\leq n$.
\end{enumerate}
[\textit{Эти формулы являются самыми важными инструментами доказательства утверждений, касающихся $\lfloor x \rfloor$ и $\lceil x \rceil$}. ]

\begin{enumerate}[label=\alph*)]
\item
  Если $x<n$, то $\lfloor x\rfloor\leq x<n$.
  Если $x=n$, то $x$ --- целое число, следовательно $\lfloor x\rfloor=x=n$.
  Если $n<x<n+1$, то $\lfloor x\rfloor=n$.
  Если $n+1\leq x$, то $n<n+1\leq\lfloor x\rfloor$.

  Если $\lfloor x\rfloor<n$, то $\lfloor x\rfloor\leq x<\lfloor x\rfloor+1\leq n$, т.е. $x<n$.
  Если $\lfloor x\rfloor=n$, значит $n\leq x<n+1$.
  Если $\lfloor x\rfloor>n$, значит $n<\lfloor x\rfloor\leq x$, т.е. $x>n$.
\item Мы уже показали, что $n\leq x\Longleftrightarrow n\leq\lfloor x\rfloor$.
\item
  Если $x<n$, то $\lceil x\rceil\leq n$.
  Если $x=n$, то $x$ --- целое число и $\lceil x\rceil=n$.
  Если $x>n$, то $\lceil x\rceil>n$.
  
  Если $\lceil x\rceil=n$, то $n-1<x\leq n$.
  Если $\lceil x\rceil<n$, то $x\leq\lceil x\rceil<n$.
  Если $\lceil x\rceil>n$, то $x>n$.
\item Мы уже показали, что $n<x\Longleftrightarrow n<\lceil x\rceil$.
\item
  Если $x-1<n\leq x$, то возможны два случая.
  Либо $x=n$, тогда $\lfloor x\rfloor=n$.
  Либо $x>n$. В этом случае $x<n+1$, т.к. в противном случае имели бы противоречие $x\geq n+1 \Rightarrow x-1\geq n$, хотя по условию $x-1<n$.
  Следовательно $\lfloor x\rfloor=n$.

  Если $n\leq x<n+1$, то соотношение $\lfloor x\rfloor=n$ очевидно.

  Если $\lfloor x\rfloor=n$, то, очевидно, $n\leq x<n+1$, отсюда $x-1<n$, т.е. $x-1<n\leq x$.
\item
  Если $x\leq n<x+1$, то возможны два случая.
  Либо $x=n$, тогда $\lceil x\rceil=n$.
  Либо $x<n$. В этом случае $x>n-1$, т.к. в противном случае имели бы противоречие $x\leq n-1\Rightarrow x+1\leq n$, хотя по условию $x+1>n$.
  Следовательно $\lceil x\rceil=n$.

  Если $n-1<x\leq n$, то соотношение $\lceil x\rceil=n$ очевидно.

  Если $\lceil x\rceil=n$, то, очевидно $n-1<x\leq n$, отсюда $n<x+1$, т.е. $x\leq n<x+1$.
\end{enumerate}

\subsubsection{4.}
Используя предыдущее упражнение, докажите, что $\lfloor -x\rfloor =-\lceil x\rceil$.

Пусть $n=\lceil x\rceil$. Тогда
\begin{flalign*}
  &n-1<x\leq n<x+1;&\\
  &-n+1>-x\geq -n>-x-1;&\\
  &-x-1<-n\leq -x<-n+1;&\\
  &m\leq y<m+1 \Rightarrow \lfloor y\rfloor=m;&\\
  &m=-n;\ y=-x;&\\
  &\lfloor -x\rfloor=-n=-\lceil x\rceil.&\\
\end{flalign*}

\subsubsection{5.}
Пусть $x$ --- положительное действительное число. Найдите простую формулу \emph{округления $x$ до ближайшего целого числа}. Искомое правило округления должно давать $\lfloor x\rfloor$ в случае, если $x\mod 1<\frac{1}{2}$, и $\lceil x\rceil$, если $x\mod 1\geq\frac{1}{2}$. Вы должны получить единую формулу, включающую в себя оба случая. Рассмотрите, как ваша формула будет выполнять округление для отрицательного $x$.

Будем использовать функцию \emph{floor}, для округления. Если $\lfloor x \rfloor=n$, то $x-1<n\leq x<n+1$. Обозначим через $n'=\lfloor x+\frac{1}{2}\rfloor$, тогда $x+\frac{1}{2}-1=x-\frac{1}{2}<n'\leq x+\frac{1}{2}<n'+1$.

Переход функции $\lfloor x+\frac{1}{2}\rfloor$ к следющему значению происходит, если $x\mod 1=\frac{1}{2}$.

Из формулы $0\leq\frac{x}{y}-\left\lfloor\frac{x}{y}\right\rfloor=\frac{x\mod y}{y}<1$ для отрицательных $x$ $0\leq x\mod1<1$ (как и для положительных чисел), однако $(-x)\mod 1=1-(x\mod 1)$. Т.е. $x\mod 1<\frac{1}{2}$ выполняется, например, для $-1\leq x<-\frac{1}{2}$, а $x\mod 1\geq\frac{1}{2}$ --- для $-\frac{1}{2}\leq x<0$. Поэтому, предложенная функция работает в соответствии с условиями и для отрицательных чисел, например:
\begin{flalign*}
  &f\left(-\frac{1}{3}\right)=\left\lfloor -\frac{1}{3}+\frac{1}{2}\right\rfloor=
  \left\lfloor \frac{1}{6}\right\rfloor=0;&\\
  &f\left(-\frac{2}{3}\right)=\left\lfloor -\frac{2}{3}+\frac{1}{2}\right\rfloor=
  \left\lfloor -\frac{1}{6}\right\rfloor=-1;&\\
  &f\left(-\frac{1}{2}\right)=\left\lfloor -\frac{1}{2}+\frac{1}{2}\right\rfloor=
  \left\lfloor 0\right\rfloor=0\textrm{ (а не $-1$)};&\\
  &f\left(-1\right)=\left\lfloor -1+\frac{1}{2}\right\rfloor=
  \left\lfloor -\frac{1}{2}\right\rfloor=-1.&\\
\end{flalign*}

\subsubsection{6.}
Какие из следующих равенств верны для всех положительных дейсвительных чисел $x$: (a) $\left\lfloor\sqrt{\lfloor x\rfloor}\right\rfloor=\left\lfloor\sqrt{x}\right\rfloor$; (b) $\left\lceil\sqrt{\lceil x\rceil}\right\rceil=\left\lceil\sqrt{x}\right\rceil$; (c) $\left\lceil\sqrt{\lfloor x\rfloor}\right\rceil=\left\lceil\sqrt{x}\right\rceil$?

(a) Рассмотрим значения функций в левой и правой частях равенства для различных значений $x$:

\begin{tabularx}{1\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $x$ & $\left\lfloor\sqrt{\lfloor x\rfloor}\right\rfloor$ & $\left\lfloor\sqrt{x}\right\rfloor$ \\
 \hline  $0.5$ & $0$ & $0$ \\
 \hline  $1$ & $\left\lfloor\sqrt{1}\right\rfloor=\lfloor\pm 1\rfloor=\pm 1$ & $\lfloor\pm 1\rfloor=\pm 1$ \\
 \hline  $1.21$ & $\left\lfloor\sqrt{1}\right\rfloor=\lfloor\pm 1\rfloor=\pm 1$ & $\lfloor\pm 1.1\rfloor=\{1;\ -2\}$ \\
 \hline
\end{tabularx}

(b) Рассмотрим значения функций в левой и правой частях равенства для различных значений $x$:

\begin{tabularx}{1\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $x$ & $\left\lceil\sqrt{\lceil x\rceil}\right\rceil$ & $\left\lceil\sqrt{x}\right\rceil$ \\
 \hline  $0.04$ & $\left\lceil\sqrt{1}\right\rceil=\lceil\pm 1\rceil=\pm 1$ & $\lceil\pm 0.2\rceil=\{1;\ 0\}$ \\
 \hline  $1.21$ & $\left\lceil\sqrt{2}\right\rceil=\lceil\pm 1.4142\rceil=\{2; -1\}$ & $\lceil\pm 1.1\rceil=\{2;\ -1\}$ \\
 \hline  $99.1$ & $\left\lceil\sqrt{100}\right\rceil=\lceil\pm 10\rceil=\pm 10$ & $\lceil\pm 9.95\rceil=\{10;\ -9\}$ \\
 \hline  $100.99$ & $\left\lceil\sqrt{101}\right\rceil=\lceil\pm 10.05\rceil=\{11;\ -10\}$ & $\lceil\pm 10.05\rceil=\{11;\ -10\}$ \\
 \hline
\end{tabularx}

(c) Рассмотрим значения функций в левой и правой частях равенства для различных значений $x$:

\begin{tabularx}{1\textwidth} { 
  | >{\raggedright\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $x$ & $\left\lceil\sqrt{\lfloor x\rfloor}\right\rceil$ & $\left\lceil\sqrt{x}\right\rceil$ \\
 \hline  $0.04$ & $\left\lceil\sqrt{0}\right\rceil=\lceil0\rceil=0$ & $\lceil\pm 0.2\rceil=\{1;\ 0\}$ \\
 \hline  $1.21$ & $\left\lceil\sqrt{1}\right\rceil=\lceil\pm 1\rceil=\pm 1$ & $\lceil\pm 1.1\rceil=\{2;\ -1\}$ \\
 \hline
\end{tabularx}

Для случая (c) при $x=1.21$ функции дают различные значения даже для абсолютных значений квадратного корня. Равенства (a) и (b) выполняются для всех действительных $x$ если рассматривать только положительные значения квадратного корня. Для отрицательных значений соотношения не выполняются. Докажем это.

\begin{flalign*}
  &\sqrt{x}=\sqrt{\lfloor x\rfloor+ x\mod 1}=n \Longrightarrow
  x=\lfloor x\rfloor+ x\mod 1=n^2 \Longrightarrow
  \lfloor x\rfloor=n^2-x\mod 1;&\\
  &\sqrt{n^2-x\mod 1}\leq\sqrt{n^2};&\\
  &\sqrt{\lfloor x\rfloor}\leq n;&\\
  &\left\lfloor\sqrt{x}\right\rfloor=\lfloor n \rfloor \Longrightarrow
  (\lfloor n \rfloor)^2\leq x< (\lfloor n \rfloor+1)^2 \Longrightarrow
  (\lfloor n\rfloor)^2\leq\lfloor x\rfloor<(\lfloor n\rfloor+1)^2;&\\
\end{flalign*}
Если $x$ лежит между целой частью квадратного корня из $y$, возведенной в квадрат, и квадратом следующего целого числа, то целая часть корня из $y$ равна целой части корня из $x$.
\begin{flalign*}
  &\left\lfloor\sqrt{x}\right\rfloor=\lfloor n \rfloor \Longleftrightarrow
  (\lfloor n \rfloor)^2\leq x< (\lfloor n \rfloor+1)^2 \Longleftrightarrow
  (\lfloor n\rfloor)^2\leq\lfloor x\rfloor<(\lfloor n\rfloor+1)^2\Longleftrightarrow
  \lfloor n\rfloor=\left\lfloor\sqrt{\lfloor x\rfloor}\right\rfloor.&\\
\end{flalign*}
Аналогично
\begin{flalign*}
  &\left\lceil\sqrt{x}\right\rceil=n\Longleftrightarrow
  (n-1)^2<x\leq n^2\Longleftrightarrow
  (n-1)^2<\lceil x\rceil\leq n^2\Longleftrightarrow
  n=\left\lceil\sqrt{\lceil x\rceil}\right\rceil.&\\
\end{flalign*}

\subsubsection{7.}

Покажите, что $\lfloor x\rfloor + \lfloor y\rfloor\leq\lfloor x+y\rfloor$ и что это соотношение становится равенством тогда и только тогда, когда $x\mod 1+y\mod1<1$. Выполняется ли аналогичная формула для функции ``потолок''?

\begin{flalign*}
  &\lfloor\ x+y\rfloor=\lfloor\ \lfloor x\rfloor+x\mod 1+\lfloor y\rfloor+y\mod 1\rfloor=&\\
  &\lfloor x\rfloor+\lfloor y\rfloor+\lfloor x\mod 1+y\mod 1\rfloor\geq
  \lfloor x\rfloor+\lfloor y\rfloor;&\\
  &0\leq x\mod 1<1;&\\
  &0\leq y\mod 1<1;&\\
  &0\leq x\mod 1+y\mod 1<2;&\\
  &\lfloor x\mod 1+y\mod 1\rfloor=\begin{cases}
    0,& \textrm{если }0\leq x\mod 1+y\mod1<1;\\
    1,& \textrm{если }1\leq x\mod 1+y\mod1<2.
  \end{cases}&\\
\end{flalign*}

Для функции ``потолок'' анлогичная фомула выглядит следующим образом:
$\lceil x\rceil + \lceil y\rceil\geq\lceil x+y\rceil$. Она обращается в равенство, если $x$ и $y$ --- целые числа, а также если $1\leq x\mod 1+y\mod1<2$.

\subsubsection{8.}
Чему равно $100\mod 3$, $100\mod 7$, $-100\mod 7$, $-100\mod 0$?

\begin{flalign*}
  &100\mod 3=1;&\\
  &100\mod 7=2;&\\
  &\lfloor-100/7\rfloor=\left\lfloor-14\frac{2}{7}\right\rfloor=-15;&\\
  &-100\mod 7=-100-(-15*7)=-100+105=5;&\\
  &-100\mod 0=-100.&\\
\end{flalign*}

\subsubsection{9.}
Чему равно $5\mod-3$, $18\mod-3$, $-2\mod-3$?

\begin{flalign*}
  &\lfloor 5/-3\rfloor=\left\lfloor-1\frac{2}{3}\right\rfloor=-2;&\\
  &5\mod-3=5-(-2*(-3))=-1;&\\
  &\lfloor 18/-3\rfloor=\left\lfloor-6\right\rfloor=-6;&\\
  &18\mod-3=18-(-6*(-3))=0;&\\
  &\lfloor -2/-3\rfloor=\left\lfloor\frac{2}{3}\right\rfloor=0;&\\
  &-2\mod-3=-2-(0*(-3))=-2.&\\
\end{flalign*}

\subsubsection{10.}
Чему равно $1.1\mod 1$, $0.11\mod .1$, $0.11\mod-.1$?

\begin{flalign*}
  &\lfloor 1.1/1\rfloor=\left\lfloor 1.1\right\rfloor=1;&\\
  &1.1\mod 1=1.1-1*1=0.1;&\\
  &\lfloor 0.11/.1\rfloor=\left\lfloor 1.1\right\rfloor=1;&\\
  &0.11\mod .1=0.11-1*.1=0.01;&\\
  &\lfloor 0.11/-.1\rfloor=\left\lfloor -1.1\right\rfloor=-2;&\\
  &0.11\mod-.1=0.11-(-2*(-.1))=0.11-0.2=-0.09.&\\
\end{flalign*}

\subsubsection{11.}
Что означает выражение ``$x\equiv y\ (\textrm{по модулю }0)$'' согласно принятому нами определению?

$x\equiv y\ (\textrm{по модулю }m)$, если $x\mod m=y\mod m$. $x\mod 0=x$, отсюда выражение можно переписать как ``$x=y$.

\subsubsection{12.}
Какие целые числа взаимно просты с $1$?

Взаимно простыми называются числа, которые не имеют общих множителей (отличных от $1$). По другому, это числа, наибольший общий делитель которых равен $1$. Получается, что все целые числа взаимно просты с $1$. Также можно воспользоваться приемом сокращения дробей: дробь, в числителе или знаменателе которой стоит $1$, несократима.

\subsubsection{13.}
Будем считать, что наибольший общий делитель чисел $0$ и $n$ равен $|n|$. Какие целые числа взаимно просты с $0$?

По нашему определению наибольший общий делитель двух взаимнопростых чисел должен быть равен $1$. Значит, только $1$ и $-1$ взаимно просты с $0$.

\subsubsection{14.}
Если $x\mod 3=2$ и $x\mod 5=3$, чему равно $x\mod 15$?

Условие $x\mod 3=2$ задает множество чисел $A=\{\cdots,\ -4, -1,\ 2,\ 5,\ 8,\ 11,\ 14, 17,\ 20,\ 23,\ \cdots\} = 3n+2$.

Условие $x\mod 5=3$ задает множество чисел $B=\{\cdots,\ -7, -2,\ 3,\ 8,\ 13,\ 18,\ 23,\ 28,\ \cdots\} = 5m+3$.

$x$ удовлетворяет как первому, так и второму условиям, т.е. входит в пересечение двух множеств: $A\cap B=\{\cdots,\ 8,\ 23,\ \cdots\}=15k+8$. Число $8$ можно получить следующим образом:

\begin{flalign*}
  &3n+2=5m+3;&\\
  &n=\frac{5m+1}{3};&\\
  &3*2+2=5*1+3=8.&\\
\end{flalign*}
Для целых $m$ и $n$ соотношение выполняется  при $m=1$ и $n=2$. Отсюда $x\mod 15=8$.

\subsubsection{15.}
Докажите, что $z(x\mod y)=(zx)\mod(zy)$. [Правило C немедленно следует из этого распределительного закона.]

\begin{flalign*}
  &\frac{x}{y}=\left\lfloor\frac{x}{y}\right\rfloor+\frac{x\mod y}{y}\Longrightarrow
  x\mod y=x-y\left\lfloor\frac{x}{y}\right\rfloor\Longrightarrow&\\
  &z(x\mod y)=zx-zy\left\lfloor\frac{x}{y}\right\rfloor=zx-zy\left\lfloor\frac{zx}{zy}\right\rfloor=
  (zx)\mod(zy).&\\
\end{flalign*}

Если $a\equiv b\ (\textrm{по модулю }m)$, то $a\mod m=b\mod m$. Умножим последнее соотношение на $n$: $n(a\mod m)=n(b\mod m)$ и раскроем скобки $(na)\mod(nm)=(nb)\mod(nm)$. Последнее означает справедливость правила C: $na\equiv nb\ (\textrm{по модулю }nm)$.

\subsubsection{16.}
Пусть $y>0$. Покажите, что если $(x-z)/y$ --- целое число и $0\leq z<y$, то $z=x\mod y$.

Рассмотрим $\frac{x}{y}$ и $\frac{z}{y}$, разность которых по условию дает целое число.
\begin{flalign*}
  &\frac{x}{y}=\left\lfloor\frac{x}{y}\right\rfloor+\frac{x\mod y}{y};&\\
  &0\leq\frac{x\mod y}{y}<1;&\\
  &0\leq z<y\Longrightarrow 0\leq\frac{z}{y}<1.&\\
\end{flalign*}

Для того, чтобы разность двух дробей давала целое число, необходимо, чтобы $\frac{x\mod y}{y}-\frac{z}{y}=0\Longrightarrow x\mod y=z$.

\subsubsection{17.}
Выведите свойство A непосредственно из определения сравнимости и докажите первую половину свойства D: если $a\equiv b\ (\textrm{по модулю }rs)$, то $a\equiv b\ (\textrm{по модулю }r)$ и $a\equiv b\ (\textrm{по модулю }s)$. (Здесь $r$ и $s$ --- произвольные целые числа.)

\begin{flalign*}
  &a\equiv b\ (\textrm{по модулю }m)\Longrightarrow a\mod m=b\mod m;&\\
  &x\equiv y\ (\textrm{по модулю }m)\Longrightarrow x\mod m=y\mod m;&\\
  &q=a\mod m+x\mod m=a-m\left\lfloor\frac{a}{m}\right\rfloor+x-m\left\lfloor\frac{x}{m}\right\rfloor=
  (a+x)-m\left(\left\lfloor\frac{a}{m}\right\rfloor+\left\lfloor\frac{x}{m}\right\rfloor\right);&\\
  &q=b\mod m+y\mod m;&\\
  &0\leq a,x,b,y\mod m<1;&\\
  &0\leq a,b\mod m+x,y\mod m=q<2;&\\
  &q=\begin{cases}
  (a+x)-m\left\lfloor\frac{a+x}{m}\right\rfloor=(a+x)\mod m=(b+y)\mod m,& \textrm{если }0\leq q<1;\\
  (a+x)-m\left(\left\lfloor\frac{a+x}{m}\right\rfloor-1\right)=(a+x)\mod m+m=(b+y)\mod m+m,& \textrm{если }1\leq q<2.
  \end{cases}&\\
  &(a+x)\mod m=(b+y)\mod m\Longrightarrow a+x\equiv b+y\ (\textrm{по модулю }m).&\\
\end{flalign*}
Для разности выполним похожие рассуждения:
\begin{flalign*}
  &q=a\mod m-x\mod m=a-m\left\lfloor\frac{a}{m}\right\rfloor-x+m\left\lfloor\frac{x}{m}\right\rfloor=
  (a-x)-m\left(\left\lfloor\frac{a}{m}\right\rfloor-\left\lfloor\frac{x}{m}\right\rfloor\right);&\\
  &-1< a,b\mod m-x,y\mod m=q<1;&\\
  &q=\begin{cases}
  (a-x)-m\left\lfloor\frac{a-x}{m}\right\rfloor=(a-x)\mod m=(b-y)\mod m,& \textrm{если }0\leq q<1;\\
  (a-x)-m\left(\left\lfloor\frac{a-x}{m}\right\rfloor+1\right)=(a-x)\mod m+m=(b-y)\mod m+m,& \textrm{если }-1<q<0.
  \end{cases}&\\
  &(a-x)\mod m=(b-y)\mod m\Longrightarrow a-x\equiv b-y\ (\textrm{по модулю }m).&\\
\end{flalign*}

Для произведения:
\begin{flalign*}
  &q=a\mod m\ast x\mod m=\left(a-m\left\lfloor\frac{a}{m}\right\rfloor\right)\left(x-m\left\lfloor\frac{x}{m}\right\rfloor\right)=ax-am\left\lfloor\frac{x}{m}\right\rfloor-xm\left\lfloor\frac{a}{m}\right\rfloor+m^2\left\lfloor\frac{a}{m}\right\rfloor\left\lfloor\frac{x}{m}\right\rfloor=&\\
  &ax-m\left(a\left\lfloor\frac{x}{m}\right\rfloor+x\left\lfloor\frac{a}{m}\right\rfloor-m\left\lfloor\frac{a}{m}\right\rfloor\left\lfloor\frac{x}{m}\right\rfloor\right)=&\\
  &ax-m\left(m\left(\left\lfloor\frac{a}{m}\right\rfloor+\frac{a\mod m}{m}\right)\left\lfloor\frac{x}{m}\right\rfloor+m\left(\left\lfloor\frac{x}{m}\right\rfloor+\frac{x\mod m}{m}\right)\left\lfloor\frac{a}{m}\right\rfloor-m\left\lfloor\frac{a}{m}\right\rfloor\left\lfloor\frac{x}{m}\right\rfloor\right)=&\\
  &ax-m\left(a\mod m\left\lfloor\frac{x}{m}\right\rfloor+x\mod m\left\lfloor\frac{a}{m}\right\rfloor+m\left\lfloor\frac{a}{m}\right\rfloor\left\lfloor\frac{x}{m}\right\rfloor\right).&\\
\end{flalign*}
В результате получили интересное соотношение:
\begin{flalign*}
  &a\left\lfloor\frac{x}{m}\right\rfloor+x\left\lfloor\frac{a}{m}\right\rfloor-m\left\lfloor\frac{a}{m}\right\rfloor\left\lfloor\frac{x}{m}\right\rfloor=a\mod m\left\lfloor\frac{x}{m}\right\rfloor+x\mod m\left\lfloor\frac{a}{m}\right\rfloor+m\left\lfloor\frac{a}{m}\right\rfloor\left\lfloor\frac{x}{m}\right\rfloor.&\\
\end{flalign*}
С другой стороны:
\begin{flalign*}
  &\left\lfloor\frac{ax}{m}\right\rfloor=\left\lfloor \frac{m^2}{m}
  \left(\left\lfloor\frac{a}{m}\right\rfloor+\frac{a\mod m}{m}\right)
  \left(\left\lfloor\frac{x}{m}\right\rfloor+\frac{x\mod m}{m}\right)\right\rfloor=&\\
  &\left\lfloor m
  \left(
  \left\lfloor\frac{a}{m}\right\rfloor\left\lfloor\frac{x}{m}\right\rfloor+
  \left\lfloor\frac{a}{m}\right\rfloor\frac{x\mod m}{m}+
  \left\lfloor\frac{x}{m}\right\rfloor\frac{a\mod m}{m}+
  \frac{(x\mod m)(a\mod m)}{m^2}\right)\right\rfloor=&\\
  &m\left\lfloor\frac{a}{m}\right\rfloor\left\lfloor\frac{x}{m}\right\rfloor+
  \left\lfloor\frac{a}{m}\right\rfloor (x\mod m)+
  \left\lfloor\frac{x}{m}\right\rfloor (a\mod m)+
  \left\lfloor\frac{(x\mod m)(a\mod m)}{m}\right\rfloor;&\\
\end{flalign*}
В результате:
\begin{flalign*}
  &q=ax-m\left(\left\lfloor\frac{ax}{m}\right\rfloor-\left\lfloor\frac{(x\mod m)(a\mod m)}{m}\right\rfloor\right);&\\
  &0\leq a,b\mod m\ast x,y\mod m=q<1\Longrightarrow&\\
  &q=ax-m\left\lfloor\frac{ax}{m}\right\rfloor=(ax)\mod m=(by)\mod m\Longrightarrow
  ax\equiv by\ (\textrm{по модулю }m).&\\
\end{flalign*}

Для свойства D
\begin{flalign*}
  &a\equiv b\ (\textrm{по модулю }rs)\Longrightarrow a\mod rs=b\mod rs\Longrightarrow
  a-rs\left\lfloor\frac{a}{rs}\right\rfloor=b-rs\left\lfloor\frac{b}{rs}\right\rfloor\Longrightarrow&\\
  &a-b=rs\left(\left\lfloor\frac{a}{rs}\right\rfloor-\left\lfloor\frac{b}{rs}\right\rfloor\right).&\\
\end{flalign*}

Множитель $\left(\left\lfloor\frac{a}{rs}\right\rfloor-\left\lfloor\frac{b}{rs}\right\rfloor\right)$ представляет собой разность целых чисел и сам является целым числом. Следовательно $a-b$ кратно $rs$. Но тогда $a-b$ должно быть кратно $r$ и $s$:
\begin{flalign*}
  &\frac{a-b}{r}=s\left(\left\lfloor\frac{a}{rs}\right\rfloor-\left\lfloor\frac{b}{rs}\right\rfloor\right);&\\
  &\frac{a-b}{s}=r\left(\left\lfloor\frac{a}{rs}\right\rfloor-\left\lfloor\frac{b}{rs}\right\rfloor\right).&\\
\end{flalign*}

Т.к. разность чисел $a$ и $b$ кратна $r$, то $a\mod r=b\mod r$, т.к. только тогда $\frac{a}{r}-\frac{b}{r}=\left\lfloor\frac{a}{r}\right\rfloor-\left\lfloor\frac{b}{r}\right\rfloor+\frac{a\mod r}{r}-\frac{b\mod r}{r}$ может дать целое число. Отсюда получаем, что $a\equiv b\ (\textrm{по модулю }r)$.

\subsubsection{18.}
С помощью свойства B докажите вторую половину свойства D: если $a\equiv b\ (\textrm{по модую }r)$ и $a\equiv b\ (\textrm{по модую }s)$, то $a\equiv b\ (\textrm{по модую }rs)$ при условии, что $r\perp s$.

Согласно свойству B, если $ax\equiv by$ и $a\equiv b$ и если $a\perp m$, то $x\equiv y\ (\textrm{по модулю }m)$.

\begin{flalign*}
  &\frac{a}{s}=\left\lfloor\frac{a}{s}\right\rfloor+\frac{a\mod s}{s};&&
  \frac{b}{s}=\left\lfloor\frac{b}{s}\right\rfloor+\frac{b\mod s}{s};&\\
  &\frac{a}{r}=\left\lfloor\frac{a}{r}\right\rfloor+\frac{a\mod r}{r};&&
  \frac{b}{r}=\left\lfloor\frac{b}{r}\right\rfloor+\frac{b\mod r}{r};&\\
  &s\equiv s\ (\textrm{по модулю }r);&&
  r\equiv r\ (\textrm{по модулю }s);&\\
\end{flalign*}
Применяя свойство B, получаем
\begin{flalign*}
  &\frac{a}{s}\equiv\frac{b}{s}\ (\textrm{по модулю }r);&&
  \frac{a}{r}\equiv\frac{b}{r}\ (\textrm{по модулю }s);&\\
  &\frac{a}{s}-r\left\lfloor\frac{a}{rs}\right\rfloor=\frac{b}{s}-r\left\lfloor\frac{b}{rs}\right\rfloor;&&
  \frac{a}{s}-s\left\lfloor\frac{a}{rs}\right\rfloor=\frac{b}{s}-s\left\lfloor\frac{b}{rs}\right\rfloor;&\\
  &a-rs\left\lfloor\frac{a}{rs}\right\rfloor=b-rs\left\lfloor\frac{b}{rs}\right\rfloor;&&
  a\mod rs=b\mod rs;&\\
  &a\equiv b\ (\textrm{по модулю }rs).&&&\\
\end{flalign*}

\subsubsection{19.}
(\emph{Закон существования обратного элемента.}) Если $n\perp m$, то существует такое целое $n'$, что $nn'\equiv 1\ (\textrm{по модулю }m)$. Докажите это с помощью обощенного алгоритма Евклида (алгоритм 1.2.1E).

Обобщенный алгоритм Евклида находит НОД $d$ двух целых положительных чисел $m$ и $n$, а также числа $a$ и $b$ такие, что $am+bn=d$. В нашем случае $d=1$, т.к. $m\perp n$.

Разделим обе части равенства на $m$ и найдем остатки от деления на $m$ частей равенства:
\begin{flalign*}
  &\frac{am+bn}{m}=a+\frac{bn}{m}=a+\left\lfloor\frac{bn}{m}\right\rfloor+\frac{bn\mod m}{m};&\\
  &\frac{1}{m}=\begin{cases}
  1+\frac{1\mod m}{m}=\frac{1\mod 1}{1}=0,\ &\textrm{если }m=1;\\
  0+\frac{1\mod m}{m},\ &\textrm{если }m>1.\end{cases}&\\
\end{flalign*}

Для того, чтобы равенство не нарушилось после деления, дробные части, а следовательно и остатки от деления на $m$, должны быть равны. Для $m\geq 1$:
\begin{flalign*}
  &bn\mod m=1\mod m\Longrightarrow bn\equiv 1\ (\textrm{по модулю }m)\Longrightarrow n'=b.&\\
\end{flalign*}

\subsubsection{20.}
Докажите свойство B с помощью свойства A и закона существования обратного элемента.

Требуется доказать, что, если $ax\equiv by$ и $a\equiv b$ и если $a\perp m$, то $x\equiv y\ (\textrm{по модулю }m)$.

Согласно свойству A, если $a\equiv b$ и $x\equiv y$, то $ax\equiv by\ (\textrm{по модулю }m)$.

По закону существования обратного элемента, если $a\perp m$, то существует $a'$ такое, что $aa'\equiv 1\ (\textrm{по модулю }m)$.

\begin{flalign*}
  &a\equiv b\Longrightarrow aa'\equiv a'b\equiv 1\ (\textrm{по модулю })m;&\\
  &ax\equiv by\Longrightarrow aa'x\equiv a'by\Longrightarrow x\equiv y\ (\textrm{по модулю }m).&\\
\end{flalign*}

\subsubsection{21.}
(\emph{Основная теорема арифметики.}) С помощью свойства B и упр. 1.2.1--5 докажите, что любое целое число $n>1$ можно \emph{единственным образом} (если не учитывать порядок сомножителей) представить в виде произведения простых чисел. Другими словами, покажите, что существует ровно один способ записи $n=p_1p_2\ldots p_k$, где каждое $p_j$---простое число и $p_1\leq p_2\leq\ldots\leq p_k$.

В упр. 1.2.1--5 доказывается, что любое целое число $n>1$ можно записать как произведение одного или нескольких простых чисел. Здесь следует доказать единственность подобной записи для любого целого числа.

Любое простое число можно представить в виде произведения одного единственного множителя --- самого себя. Очевидно, такое представление единственно.

Предположим по индукции, что числа $2,\ 3,\ \ldots,\ n$ можно представить в виде произведения простых чисел \emph{единственным образом}. Пусть, для целого числа $n+1$ существуют два различных представления в виде произведения простых чисел: $p_1p_2\ldots p_k$ и $q_1q_2\ldots q_l$, где $p_j$ и $q_i$ --- простые числа, $p_1\leq p_2\leq\ldots\leq p_k$ и $q_1\leq q_2\leq\ldots\leq q_l$.

Если среди чисел $p_j$ и $q_i$ найдется хотя бы одно, которое встречается и в $p_j$ и в $q_i$, т.е. для некоторых $i$ и $j$ $p_j=q_i$, то разделим $n+1$ на это число. Получим число $\frac{n+1}{p_j}<n$, для которого согласно предположению индукции существует лишь единственное представление в виде произведения целых чисел. Следоваельно представления $p_1p_2\ldots p_k$ и $q_1q_2\ldots q_l$ идентичны.

Если предсавления $p_j$ и $q_i$ не имеют общих сомножителей, то возьмем по одному любому числу $p_1$ и $q_1$ из каждого представления. Об этих числах известно, что $p_1\neq q_1$ и $p_1\perp q_1$. Обозначим $p'=\frac{n+1}{p_1}$, $q'=\frac{n+1}{q_1}$.
\begin{flalign*}
  &p_1p'=q_1q';&&p_1p'\equiv q_1q'\equiv 0\ (\textrm{по модулю }p_1);&&p_1p'\equiv q_1q'\equiv 0\ (\textrm{по модулю }q_1).&\\
\end{flalign*}
Т.к. $p_1\perp q_1$, а $n+1$ кратно $q_1$, то $p'$ кратно $q_1$. Обозначим $p''=\frac{p'}{q_1}$. Соответственно $q''=\frac{q'}{p_1}$. По свойству B имеем:
\begin{flalign*}
  &p_1p''\equiv q'\equiv 0\ (\textrm{по модулю }p_1);&&p'\equiv q_1q''\equiv 0\ (\textrm{по модулю }q_1);&\\
\end{flalign*}
Но последние соотношения могут выполняться только если $q'$ кратно $p_1$, т.е. среди $q_j$ существует число равное $p_1$. Это противоречит предположению о существовании двух различных представлений для числа $n+1$.

\subsubsection{22.}
Приведите пример того, что свойство B не всегда выполняется в случае, если $a$ и $m$ не являются взаимно простыми числами.

Пусть $m=2$, $a=m*3=6$, а $b=m*2=4$. $a\equiv b\equiv 0\ (\textrm{по модулю }m)$. В качестве $x$ примем любое четное число, а $y$ --- любое нечетное число. Тогда $ax\equiv by\ (\textrm{по модулю }2)$. Но $x\not\equiv y\ (\textrm{по модулю }2)$.

\subsubsection{23.}
Приведите пример того, что свойство D не всегда выполняется, если $r$ и $s$ не являются взаимно простыми.

Свойство D: если $r\perp s$, то $a\equiv b\ (\textrm{по модулю }rs)$ тогда и только тогда, когда $a\equiv b\ (\textrm{по модулю }r)$ и $a\equiv b\ (\textrm{по модулю }s)$.

Как было доказано выше первая половина свойства D выполняется всегда независимо от чисел $r$ и $s$:
\begin{flalign*}
  &r=3;\ s=6;\ rs=18;&\\
  &a=19;\ b=37;\ a\mod rs=b\mod rs=1;&\\
  &a\mod r=19\mod 3=1;\ b\mod r=37\mod 3=1;&\\
  &a\mod s=19\mod 6=1;\ b\mod s=37\mod 6=1.&\\
\end{flalign*}

Но обратное уже не будет верно:
\begin{flalign*}
  &a=7;\ b=13;\ a\mod rs=7\neq b\mod rs=13;&\\
  &a\mod r=7\mod 3=1;\ b\mod r=13\mod 3=1;&\\
  &a\mod s=7\mod 6=1;\ b\mod s=13\mod 6=1.&\\
\end{flalign*}

\subsubsection{24.}
Допускают ли свойства A, B, C и D такое обобщение, чтобы они выполнялись не только для целых, но и для произвольных действительных чисел?

Доказательство свойства A и первой половины свойства D из упр. 17 справедливо для произвольных действительных чисел.

Свойство B и вторая половина свойства D требуют, чтобы некоторые числа были взаимно простыми. Если определить отношение взаимной простоты для действительных чисел, то свойства также могут быть справедливы для действительных чисел.

Свойство C справедливо для действительных чисел:
\begin{flalign*}
  &a\mod m=a-m\left\lfloor\frac{a}{m}\right\rfloor=
  b\mod m=b-m\left\lfloor\frac{b}{m}\right\rfloor;&\\
  &a-m\left\lfloor\frac{an}{mn}\right\rfloor=
  b-m\left\lfloor\frac{bn}{mn}\right\rfloor;&\\
  &an-mn\left\lfloor\frac{an}{mn}\right\rfloor=
  bn-mn\left\lfloor\frac{bn}{mn}\right\rfloor;&\\
  &an\mod mn=bn\mod mn.&\\
\end{flalign*}

\subsubsection{25.}
На основании теоремы F покажите, что $a^{p-1}\mod p=[a\textrm{ не кратно }p]$ для любого простого числа $p$.

Если $a$ кратно $p$, то $a$ в любой степени делится на $p$ без остатка, т.е. $a^{p-1}\mod p=0$.

Если $a$ не кратно $p$, то $a\perp p$, т.к. $p$ --- простое число. Согласно теореме Ферма, если $p$ --- простое число, то $a^p\equiv a\ (\textrm{по модулю }p)$ для всех целых $a$. По правилу B последнее соотношение можно сократить на $a$: $a^{p-1}\equiv 1\ (\textrm{по модулю }p)\Longrightarrow a^{p-1}\mod p=1\mod p=1$.

\subsubsection{26.}
Пусть $p$ --- нечетное простое число, $a$ --- произвольное целое и $b=a^{(p-1)/2}$. Покажите, что $b\mod p$ равно либо $0$, либо $1$, либо $p-1$. [\emph{Указание}. Рассмотрите $(b+1)(b-1)$.]

Т.к. $p>2$, то $\frac{p-1}{2}\geq 1$. Если $a$ кратно $p$, то $b\mod p=0$.

Если $a$ не кратно $p$, рассмотрим $b^2-1=a^{p-1}-1$. По теореме Ферма в этом случае $a^{p-1}\mod p=1$ или $a^{p-1}\equiv 1\ (\textrm{по модулю }p)\Longrightarrow a^{p-1}-1\equiv 0\ (\textrm{по модулю }p)\Longrightarrow (b-1)(b+1)\equiv 0\ (\textrm{по модулю }p)$. Значит возможно два случая.
\begin{flalign*}
  &(b-1)\equiv 0\Longrightarrow b\equiv 1\ (\textrm{по модулю }p);&\\
  &(b+1)\equiv 0\Longrightarrow b\equiv -1\Longrightarrow b\equiv p-1\ (\textrm{по модулю }p).&\\&\\
\end{flalign*}

\subsubsection{27.}
Пусть $n$---положительное целое число и пусть $\varphi(n)$---количество значений из множества $\{0,1,\ldots,n-1\}$, взаимно простых с $n$. Таким образом, $\varphi(1)=1$, $\varphi(2)=1$, $\varphi(3)=2$, $\varphi(4)=2$ и т.д. Покажите, что если $p$---простое число, то $\varphi(p)=p-1$, и вычислите $\varphi(p^e)$, где $e$---положительное целое число.

Если $p$ --- простое число, то оно делится только на $1$ и на $p$. Количество чисел больших $0$, но меньших $p$ равно $p-1$.

$p^2=p\times p$ делится на $1$, на $p,2p,3p,\ldots,(p-1)p$,  и на само себя. Количество чисел больших $p$, но меньших $p^2$ равно $p^2-p-1$. Количество чисел, кратных $p$ больших $p$ и меньших $p^2$ равно $p-2$. Т.е. $\varphi(p^2)=\varphi(p)+p^2-p-1-(p-2)=p^2-p-1-p+2+p-1=p^2-p$.

$p^3$ делится на $(p+1)p,(p+2)p,(p+3)p,\ldots,(p^2-1)p$,  и на само себя. Количество чисел больших $p^2$, но меньших $p^3$ равно $p^3-p^2-1$. Количество чисел, кратных $p$ больших $p^2$ и меньших $p^3$ равно $p^2-p-1$. Т.е. $\varphi(p^3)=\varphi(p^2)+p^3-p^2-1-(p^2-p-1)=p^3-p^2-1-p^2+p+1+p^2-p=p^3-p^2$.

Предположим по индукции, что для $e=1,2,\ldots,n$ выполняется $\varphi(p^e)=p^e-p^{e-1}$. Тогда для $e=n+1$ количество чисел больших $p^n$, но меньших $p^{n+1}$ равно $p^{n+1}-p^n-1$, а количество чисел кратных $p$ больших $p^n$, но меньших $p^{n+1}$ равно $p^n-p^{n-1}-1$. Т.е. $\varphi(p^n+1)=\varphi(p^n)+p^{n+1}-p^n-1-(p^n-p^{n-1}-1)=p^{n+1}-p^n-1-p^{n}+p^{n-1}+1+p^n-p^{n-1}=p^{n+1}-p^n$.

\subsubsection{28.}
Покажите, что метод, который использовался для доказательства теоремы F, можно применить для доказательства следующего ее обобщения, называемого \emph{теоремой Эйлера}: если $a\perp m$, то $a^{\varphi(m)}\equiv 1\ (\textrm{по модулю }m)$ для \emph{любого} положительного целого $m$. (В частности, число $n'$ из упр. 19 можно взять равным $n^{\varphi(m)-1}\mod m$.)

Если $m$ --- простое число, то $\varphi(m)=m-1$ и доказываемое выражение упрощается до теоремы F. В противном случае $m$ можно представить в виде произведения простых чисел $m=p_1^{e_1}p_2^{e_2}\ldots p_n^{e_n}$.

Например, для числа $15$ существует $(3*5-1)$ чисел, меньших $15$, из них $(5-1)+(3-1)$ невзаимнопростых, тогда $\varphi(15)=(3*5-1)-(5-1)-(3-1)$. Для $36$ существует $(2*2*3*3-1)$ чисел, меньших $36$, из них $(2*3*3-1)$ кратных $2$ и $(2*2*3-1)$ кратных $3$, кроме того, $2*3-1$ кратных $2$ и $3$ одновременно, тогда $\varphi(36)=(2*2*3*3-1)-(2*3*3-1)-(2*2*3-1)+(2*3-1)$.

Продолжая данные рассуждения, в общем случае формула получается достаточно сложной: из общего количества чисел, меньших $m$, т. е. из ($m-1$), вычитаем количество чисел, кратных каждому простому сомножителю ($(m/p_1-1)+(m/p_2-1)+\ldots+(m/p_n-1)$). Затем прибавляем количество чисел кратных двум сомножителям одновременно ($(m/p_1p_2-1)+(m/p_1p_3-1)+\ldots+(m/p_1p_n-1)+(m/p_2p_3-1)+...+(m/p_2p_n-1)+...+(m/p_{n-1}p_n-1)$). Затем вычитаем количество чисел, кратных трем сомножителям, прибавляем количество кратных четырем, и т.д.

Для того, чтобы сохранить аналогию с теоремой F, мы должны взять $\varphi(m)$ чисел взаимно простых с $m$. Обозначим их $k_i$, $i\in[1,\varphi(m)]$, домножить каждое из них на $a$ и посчитать остаток от деления каждого из них на $m$:
\begin{flalign} \label{eq:1_2_4__28_1}
  ak_1\mod m,\ ak_2\mod m,\ \ldots,\ ak_{\varphi(m)}\mod m
\end{flalign}
Все эти числа различны, т.к. если бы $ak_i\mod m=ak_j\mod m$, то по определению эквивалентности $ak_i\equiv ak_j\ (\textrm{по модулю }m)$; следовательно, согласно свойству B $k_i\equiv k_j\ (\textrm{по модулю }m)$.

Таким образом, последовательность \ref{eq:1_2_4__28_1} представляет собой $\varphi(m)$ различных неотрицательных чисел, меньших, чем $m$. Следовательно, согласно свойству A:
\begin{flalign*}
  (ak_1)(ak_2)\ldots(ak_{\varphi(m)})\equiv k_1\cdot k_2\ldots k_{\varphi(m)}\ (\textrm{по модулю }m).
\end{flalign*}
Это доказывает теорему, поскольку каждый из сомножителей $k_i$ взаимно прост с $m$, поэтому на основании свойства B его можно сократить.

\subsubsection{29.}
Функция $f(n)$ от положительного целочисленного аргумента $n$ называется \emph{мультипликативной (multiplicative)}, если $f(rs)=f(r)f(s)$ для любых взаимнопростых $r$ и $s$. Покажите, что каждая из перечисленных ниже функций является мультипликативной: (a) $f(n)=n^c$, где $c$ --- произвольная постоянная; (b) $f(n)=[n\textrm{ не делится на }k^2\textrm{ для любого целого }k>1]$; (c) $f(n)=c^k$, где $k$ --- количество различных простых чисел, которые делят $n$; (d) произведение любых двух мультипликативных функций.

(a)
\begin{flalign*}
  &f(r)=r^c; && f(s)=s^c; && f(rs)=(rs)^c=(r^c)(s^c)=f(r)f(s).&
\end{flalign*}
(b) Для того, чтобы $n$ делился на $k^2$, $k^2$ должен быть меньше либо равен $n$.

Если существует число $k_r$ такое, что $r$ делится на $k_r^2$, и существует число $k_s$ такое, что $s$ делится на $k_s^2$, то число $rs$ также делится на $k_r^2$ и на $k_s^2$. Т.е. $f(r)=f(s)=0$, $f(rs)=f(r)f(s)=0$.

Если для $r$ или для $s$ существует число $k$ такое, что $r$ или $s$ делится на $k^2$, то число $rs$ также делится на $k^2$. Т.е. $f(r)=0$ или $f(s)=0$, $f(rs)=0$ и $f(r)f(s)=0$ даже если один из сомножителей равен $1$.

Если для $r$ и для $s$ нельзя найти таких $k_r$ и $k_s$, чтобы их квадраты были их делителями, то $f(r)=f(s)=1$. Т.к. $r\perp s$, то эти числа можно разложить на простые множители $r=p_1^{e_1}p_2^{e_2}\ldots p_n^{e_n}$, $s=q_1^{g_1}q_2^{g_2}\ldots q_m^{g_m}$, при этом наборы чисел $\{p_i\}$ и $\{q_j\}$ не пересекаются. Для того, чтобы число делилось на квадрат какого-либо числа, необходимо, чтобы хотя бы один из сомножителей входил в разложение со степенью большей $1$. В нашем случае это не выполняется для $r$ и $s$, но это также не выполняется для $rs=p_1^{e_1}p_2^{e_2}\ldots p_n^{e_n}q_1^{g_1}q_2^{g_2}\ldots q_m^{g_m}$, состоящего из тех же сомножителей. Следовательно, $f(rs)=1$.

(c) Для того, чтобы простое число $p$ делило $n$, оно должно быть меньше $n$. Обозначим через $k_r$ и $k_s$ количество простых чисел, которые делят $r$ и $s$ соответственно. Тогда $f(r)=c^{k_r}$, $f(s)=c^{k_s}$, а $f(r)f(s)=c^{k_r+k_s}$. Т.к. $r\perp s$, то в разложение этих чисел входят разные простые числа. Но тогда в $rs$ входит $k_r+k_s$ различных простых чисел. $f(rs)=c^{k_r+k_s}$.

(d) Пусть функции $h(n)$ и $g(n)$ мультипликативные и функция $f(n)=h(n)g(n)$. Тогда
\begin{flalign*}
  &h(rs)=h(r)h(s),\ g(rs)=g(r)g(s);&\\
  &f(r)=h(r)g(r),\ f(s)=h(s)g(s);&\\
  &f(r)f(s)=h(r)g(r)h(s)g(s)=\bigl(h(r)h(s)\bigl)\bigl(g(r)g(s)\bigl)=
  h(rs)g(rs)=f(rs).&
\end{flalign*}

\subsubsection{30.}
Докажите, что функция $\varphi(n)$ из упр. 27 является мультипликативной. Используя этот факт, вычислите $\varphi(1000000)$ и предложите простой метод вычисления $\varphi(n)$, когда $n$ разложено на простые множители.

$\varphi(r)$ --- есть количество чисел меньших $r$ и взаимно простых с $r$. $\varphi(s)$ --- есть количество чисел меньших $s$ и взаимно простых с $s$. Количество чисел, меньших $rs$ и взаимно простых с $r$ равно $s\varphi(r)$. Количество чисел, меньших $rs$ и взаимно простых с $s$ равно $r\varphi(s)$. Тогда $\varphi(rs)$ - есть количество чисел меньших $rs$ и взаимно простых одновременно и с $r$, и с $s$.

Предположим, для $r$ существуют числа $r_1,r_2,\ldots,r_n$, такие что $r_i<r$ и $r_i\perp r$, а для $s$ --- числа $s_1,s_2,\ldots,s_m$, такие что $s_j<s$ и $s_j\perp s$. Соответственно, существуют числа $r_1,r_2,\ldots,r_n,r_1+r,r_2+r,\ldots,r_n+r,\ldots,r_1+(s-1)r,r_2+(s-1)r,\ldots,r_n+(s-1)r$, взаимно простых с $r$ и меньших $rs$, и $s_1,s_2,\ldots,s_m,s_1+s,s_2+s,\ldots,s_m+s,\ldots,s_1+(r-1)s,s_2+(r-1)s,\ldots,s_m+(r-1)s$. Для того, чтобы число было взаимно простым для $rs$ оно должно входить в оба этих множества.

Рассмотрим числа $r_i,r_i+r,r_i+2r,\ldots,r_i+(s-1)r$. Их количество равно $s$ и все они взаимно просты с $r$. Среди чисел $0,1,2,\ldots,s-1$ есть $\varphi(s)$ чисел взаимно простых с $s$. Т.к. $r\perp s$, то среди чисел $0r,1r,2r,\ldots,(s-1)r$ также $\varphi(s)$ чисел взаимнопростых с $s$. Причем все числа $s_ir\mod s$ различны, т.к. если $s_ir\equiv s_jr\ (\textrm{по модулю }s)$, то $s_i=s_j$, чего быть не может. Следовательно, все числа $r_i\mod s,(r_i+r)\mod s,(r_i+2r)\mod s,\ldots,(r_i+(s-1)r)\mod s$ также различны. Поэтому среди них есть также $\varphi(s)$ чисел взаимно простых с $s$.

Получается, что для каждого из $\varphi(r)$ чисел взаимнопростых с $r$ есть $\varphi(s)$ чисел, меньших $rs$ и взаимно простых как с $r$, так и с $s$. Общее число таких чисел равно $\varphi(r)\varphi(s)$ и это и есть $\varphi(rs)$.

$1000000=10^6=2^6 5^6$. Числа $2^6$ и $5^6$ взаимно простые. $\varphi(p^e)=p^e-p^{e-1}$. Таким образом, $\varphi(1000000)=\varphi(2^6)\varphi(5^6)=(2^6-2^5)(5^6-5^5)=2^5(2-1)5^5(5-1)=4\cdot 10^5$.

Пусть число $n$ разложено на простые множители $p_1^{e_1}p_2^{e_2}\ldots p_n^{e_n}$. Тогда $\varphi(n)=p_1^{e_1-1}p_2^{e_2-1}\ldots p_n^{e_n-1}(p_1-1)(p_2-1)\ldots(p_n-1)=\frac{n(p_1-1)(p_2-1)\ldots(p_n-1)}{p_1p_2\ldots p_n}$.

\subsubsection{31.}
Докажите, что если функция $f(n)$ мультипликативна, то $g(n)=\sum_{d\setminus n}{f(d)}$ также мультипликативна.

Пусть $s\perp r$. Нас интересуют не только простые числа, но все возможные делители $r$ и $s$. Пусть множество $C$ содержит все возможные делители $r$ и имеет размер $n$, а $D$ --- все возможные делители $s$ и содержит $m$ элементов. Множество $CD$ должно содержать $m\times n$ чисел $c_id_j$. Элементы множеств $C$ и $D$ также входят в $CD$, т.к. $c_1=d_1=1$.
\begin{flalign*}
  &g(r)=\sum_{1\leq i\leq n}{f(p_i)};\ g(s)=\sum_{1\leq j\leq m}{f(q_j)};&\\
  &g(rs)=\sum_{1\leq i\leq n}{\sum_{1\leq j\leq m}{f(p_iq_j)}}=\sum_{1\leq i\leq n}{\sum_{1\leq j\leq m}{f(p_i)f(q_j)}}=\left(\sum_{1\leq i\leq n}{f(p_i)}\right)\left(\sum_{1\leq j\leq m}{f(q_j)}\right)=g(r)g(s).&\\
\end{flalign*}

\subsubsection{32.}
Докажите, что для любой функции $f(x,y)$ выполняется тождество
\begin{flalign*}
  \sum_{d\setminus n}{\sum_{c\setminus d}{f(c,d)}}=\sum_{c\setminus n}{\sum_{d\setminus (n/c)}{f(c,cd)}}.
\end{flalign*}

Рассмотрим все делители числа $n$. Любое число делится на $1$, которая также делится на $1$. Для $n=1$
\begin{flalign*}
  &\sum_{d=1}{\sum_{c=1}{f(c,d)}}=f(1,1);\ \sum_{c=1}{\sum_{d=1}{f(1,1)}}=f(1,1).&\\
\end{flalign*}

Если $n$ --- простое, то оно делится на $1$ и на само себя. Тогда
\begin{flalign*}
  &\sum_{d\in\{1,n\}}{\sum_{c\setminus d}{f(c,d)}}=\sum_{c\setminus 1}{f(c,1)}+\sum_{c\setminus n}{f(c,n)}=f(1,1)+f(1,n)+f(n,n);&\\
  &\sum_{c\in\{1,n\}}{\sum_{d\setminus (n/c)}{f(c,cd)}}=\sum_{d\setminus n}{f(1,d)}+\sum_{d\setminus 1}{f(n,nd)}=f(1,1)+f(1,n)+f(n,n).&\\
\end{flalign*}

В общем случае имеем множество $D=\{d_1,d_2,\ldots,d_n\}$ делителей числа $n$, и множество делителей для каждого делителя $C=\{\{c_{11},c_{12},\ldots,c_{1m_1}\},\{c_{21},c_{22},\ldots,c_{2m_2}\},\dots,\{c_{n1},c_{n2},\ldots,c_{nm_n}\}\}$. Обратим внимание, что все элементы множеств $C_1,C_2,\ldots,C_n$ входят в $D$. Тогда
\begin{flalign*}
  &\sum_{d\setminus n}{\sum_{c\setminus d}{f(c,d)}}=&&&\\
  &&&f(c_{11},d_1)+f(c_{12},d_1)+\ldots+f(c_{1m_1},d_1)+&\\
  &&&f(c_{21},d_2)+f(c_{22},d_2)+\ldots+f(c_{2m_2},d_2)+\ldots+&\\
  &&&f(c_{n1},d_n)+f(c_{n2},d_n)+\ldots+f(c_{nm_n},d_n);&\\
\end{flalign*}
\begin{flalign*}
  &\sum_{c\setminus n}{\sum_{d\setminus (n/c)}{f(c,cd)}}=
  \sum_{c\setminus n}{\sum_{e\setminus (n/c)}{f(c,ce)}}=
  \sum_{d\setminus n}{\sum_{e\setminus (n/d)}{f(d,de)}}=
  \sum_{d\setminus n}{\sum_{c\setminus (n/d)}{f(d,dc)}};&\\
\end{flalign*}
В правой части равенства получаем, что внешняя сумма выполняется по тому же индексу, что и внешняя сумма в левой части равенства. Числа $\{\frac{n}{d_1},\frac{n}{d_2},\ldots,\frac{n}{d_n}\}$ также являются делителями числа $n$. Пусть $d_n=\frac{n}{d_1},d_{n-1}=\frac{n}{d_2},\ldots,d_1=\frac{n}{d_n}$, т.е. $d_i=\frac{n}{d_{n-i+1}}$. Таким образом получаем
\begin{flalign*}
  &\sum_{d\setminus n}{\sum_{c\setminus (n/d)}{f(d,dc)}}=&&&\\
  &&&f(d_1,d_1c_{n1})+f(d_1, d_1c_{n2})+\ldots+f(d_1, d_1c_{nm_n})+&\\
  &&&f(d_2,d_2c_{(n-1)1})+f(d_2, d_2c_{(n-1)2})+\ldots+f(d_2, d_2c_{(n-1)m_{n-1}})+\ldots+&\\
  &&&f(d_n,d_nc_{11})+f(d_n, d_nc_{12})+\ldots+f(d_n, d_nc_{1m_1}).&\\
\end{flalign*}

Получили сумму с таким же числом слагаемых, в каждом слагаемом аргумент $x$ является делителем $y$. Теперь нужно докажать, что эти слагаемые идентичны слагаемым в левой части равенства.

Рассмотрим ещё раз сумму $\sum_{c\setminus n}{\sum_{d\setminus (n/c)}{f(c,cd)}}$. В отличие от суммы в левой части равенства здесь мы для каждого делителя числа $n$ находим не его делители, а делители частного $n/c$. При умножении этих чисел на $c$ получаем все возможные кратные для этого делителя. 

\subsubsection{33.}
Для целых чисел $m$ и $n$ вычислите:
\begin{flalign*}
  &(a)\ \left\lfloor\frac{1}{2}(n+m)\right\rfloor+\left\lfloor\frac{1}{2}(n-m+1)\right\rfloor;\ (b)\ \left\lceil\frac{1}{2}(n+m)\right\rceil+\left\lceil\frac{1}{2}(n-m+1)\right\rceil.&\\
\end{flalign*}
(Обратите внимание на частный случай $m=0$.)

(a) Если $n$ и $m$ --- оба четные или оба нечетные, то $\left\lfloor\frac{1}{2}(n+m)\right\rfloor=\frac{1}{2}(n+m)$. Если одно число четное, а другое нечетное, то $\left\lfloor\frac{1}{2}(n+m)\right\rfloor=\frac{1}{2}(n+m-1)$.

Если $n$ и $m$ --- оба четные или оба нечетные, то $\left\lfloor\frac{1}{2}(n-m+1)\right\rfloor=\frac{1}{2}(n-m)$. Если одно число четное, а другое нечетное, то $\left\lfloor\frac{1}{2}(n-m+1)\right\rfloor=\frac{1}{2}(n-m+1)$.

Складывая оба выражения и в первом, и во втором случае получаем $n$.

(b) Если $n$ и $m$ --- оба четные или оба нечетные, то $\left\lceil\frac{1}{2}(n+m)\right\rceil=\frac{1}{2}(n+m)$. Если одно число четное, а другое нечетное, то $\left\lceil\frac{1}{2}(n+m)\right\rceil=\frac{1}{2}(n+m+1)$.

Если $n$ и $m$ --- оба четные или оба нечетные, то $\left\lceil\frac{1}{2}(n-m+1)\right\rceil=\frac{1}{2}(n-m+2)$. Если одно число четное, а другое нечетное, то $\left\lceil\frac{1}{2}(n-m+1)\right\rceil=\frac{1}{2}(n-m+1)$.

Складывая оба выражения и в первом, и во втором случае получаем $\frac{2n+2}{2}=n+1$.

\subsubsection{34.}
Какие необходимые и достаточные условия нужно наложить на действительное число $b>1$, чтобы равенство $\left\lfloor\log_{b}{x}\right\rfloor=\left\lfloor\log_{b}{\lfloor x\rfloor}\right\rfloor$ выполнялось для всех действительных $x\geq 1$?

Рассмотрим утверждения $A$ и $B$. Если из утверждения $A$ следует утверждение $B$ ($A\Longrightarrow B$), то утверждение $A$ называется достаточным условием для утверждения $B$. Если из утвержения $B$ не следует утверждение $A$ ($B\not\Longrightarrow A$), то $B$ называется необходимым (но недостаточным) условием для $A$. Если же из $B$ также следует $A$ ($A\Longleftrightarrow B$), то утверждения $A$ и $B$ являются необходимыми и достаточными условиями друг друга.

Например, если $x$ --- целое число, то это достаточное условие для утверждения $\left\lfloor\log_{b}{x}\right\rfloor=\left\lfloor\log_{b}{\lfloor x\rfloor}\right\rfloor$, т.к. в этом случае $\lfloor x\rfloor=x$. Но нас просят рассмотреть условия, которые относятся к основанию логарифма $b$.

Рассмотрим функцию $\log_{2}{x}$.

\begin{tabularx}{1\textwidth} { 
  | >{\centering\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X | }
 \hline  $x$ & $y=\log_{2}{x}$ & $\left\lfloor\log_{2}{x}\right\rfloor$ & $y=\log_{2}{\lfloor x\rfloor}$ & $\left\lfloor\log_{2}{\lfloor x\rfloor}\right\rfloor$ \\
 \hline  $1$ & $0$ & $0$ & $0$ & $0$ \\
 \hline  $1<x<2$ & $0<y<1$ & $0$& $0$ & $0$ \\
 \hline  $2$ & $1$ & $1$& $1$ & $1$ \\
 \hline  $2<x<3$ & $1<y<2$ & $1$& $1$ & $1$ \\
 \hline  $3\leq x<4$ & $1<y<2$ & $1$& $1<y<2$ & $1$ \\
 \hline  $2^2=4$ & $2$ & $2$& $2$ & $2$ \\
 \hline  $4<x<5$ & $2<y<3$ & $2$& $2$ & $2$ \\
 \hline  $5\leq x<8$ & $2<y<3$ & $2$& $2<y<3$ & $2$ \\
 \hline  $2^3=8$ & $3$ & $3$& $3$ & $3$ \\
 \hline  $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ \\
 \hline
\end{tabularx}
 
Функция $\log_{2}{x}$ монотонно возрастает с ростом значений $x$. Функция $\left\lfloor\log_{2}{x}\right\rfloor$ изменяется ступеньками при переходе $x$ через степени числа $2$. Поведение функции $y=\log_{2}{\lfloor x\rfloor}$ похоже на поведение обычного логарифма, за исключением областей, где $2^n<x<2^n-1$, на которых график функции представляет собой горизонтальную прямую. Однако, это не оказывает никакого влияния на значения $\left\lfloor\log_{2}{\lfloor x\rfloor}\right\rfloor$, которые всегда совпадают со значениями $\left\lfloor\log_{2}{x}\right\rfloor$. Подобная ситуация должна наблюдаться для всех целых $b$. Таким образом для выполнения утверждения \emph{достаточно}, чтобы $b$ было целым числом и $>1$.

Если $b$ не является целым числом, то $b^n$ также не является целым, для любого целого $n$. Для того, чтобы получить целое число, необходимо, чтобы степень была действительным нецелым числом. Следовательно, $\log_{b}{x}$ может принимать целые значения для некоторых нецелых $x$, равных $b^n$, а $\log_{b}{\lfloor x\rfloor}$ целые значения не принимает никогда. Итак, для $x=\{b^1,b^2,b^3,\ldots,b^n,\ldots\}$ $\log_{b}{x}$ и $\left\lfloor\log_{b}{x}\right\rfloor$ принимают значения $\{1,2,3,\ldots,n,\ldots\}$. В этих точках функция $\log_{b}{\lfloor x\rfloor} < \log_{b}{x}$, следовательно, т.к. $\log_{b}{x}$ --- целое, $\left\lfloor\log_{b}{x}\right\rfloor<\left\lfloor\log_{b}{\lfloor x\rfloor}\right\rfloor$. Отсюда условие ``$b$ --- целое'' являтся также \emph{необходимым}.

\subsubsection{35.}
Пусть $m$ и $n$ --- целые числа и $n>0$. Докажите, что равенство
\begin{flalign*}
  \lfloor(x+m)/n\rfloor=\left\lfloor(\lfloor x\rfloor+m)/n\right\rfloor
\end{flalign*}
выполняется для всех действительных $x$. (Заметим, что $m=0$ --- это очень важный частный случай.) Будет ли справедливо аналогичное равенство для фукнции ``потолок''?

Функция $(x+m)/n$ является целой не для всех целых $x$, однако, для того, чтобы функция была целой, $x$ также должно быть целым. Очевидно, $n$ столько же целых раз помещается в числе $(\lfloor x\rfloor + m)/n$, округленном до целого, сколько в дробном $(x+m)/n$.

Докажем сперва частный случай $\left\lfloor x/n\right\rfloor=\left\lfloor\lfloor x\rfloor/n\right\rfloor$ при $m=0$:
\begin{flalign*}
  &x=\lfloor x\rfloor+x\mod 1;&\\
  &x/n=\lfloor x\rfloor/n+(x\mod 1)/n;&\\
  &x/n=\lfloor x/n\rfloor + (x\mod n)/n;&\\
  &\lfloor x\rfloor/n=\lfloor x/n\rfloor + (x\mod n)/n-(x\mod 1)/n;&\\
  &\left\lfloor\lfloor x\rfloor/n\right\rfloor=\left\lfloor\lfloor x/n\rfloor + (x\mod n)/n-(x\mod 1)/n\right\rfloor;&\\
  &0\leq (x\mod n)/n<1;&\\
  &0\leq (x\mod 1)/n<1;&\\
  &-1<(x\mod n - x\mod 1)/n<1.&\\
\end{flalign*}

$x\mod 1$ может быть $0$, только если $x$ --- целое. $x\mod n$ может быть $0$, если $x$ --- целое кратное $n$. Во всех остальных случаях $x\mod n\geq x\mod 1$ и $0\leq(x\mod n - x\mod 1)/n<1$. Т.е. $\left\lfloor x/n\right\rfloor=\left\lfloor\lfloor x\rfloor/n\right\rfloor$.

Т.к. $m$ --- целое число, то $\left\lfloor\lfloor x\rfloor+m\right\rfloor=\lfloor x\rfloor+m=\lfloor x+m\rfloor$. Таким образом, обозначая через $y$ сумму $y=x+m$, имеем $\lfloor y\rfloor=\lfloor x+m\rfloor=\lfloor x\rfloor+m$.
\begin{flalign*}
  &\left\lfloor y/n\right\rfloor=\left\lfloor\lfloor y\rfloor/n\right\rfloor;&\\
  &\left\lfloor (x+m)/n\right\rfloor=(\left\lfloor\lfloor x\rfloor+m)/n\right\rfloor.&\\
\end{flalign*}

Для функции ``потолок'' соответствующие равенства выполняются для целого $x$ или для $n=1$. Если $x\mod 1>0$ и $n>1$:
\begin{flalign*}
  &x=\lceil x\rceil-1+x\mod 1;&\\
  &x/n=\lceil x\rceil/n+-1/n+(x\mod 1)/n;&\\
  &x/n=\lceil x/n\rceil-1+(x\mod n)/n;&\\
  &\lceil x\rceil/n=\lceil x/n\rceil + (x\mod n)/n-(x\mod 1)/n-1+1/n;&\\
  &\left\lceil\lceil x\rceil/n\right\rceil=\left\lceil\lceil x/n\rceil + (x\mod n)/n-(x\mod 1)/n-1+1/n\right\rceil;&\\
  &0<(x\mod n)/n<1;&\\
  &0<(x\mod 1)/n<1;&\\
  &0\leq(x\mod n - x\mod 1)/n<1\ \textrm{(см. выше)};&\\
  &0\leq x\mod n-x\mod 1\leq n-1\ \textrm{(для нецелого $x$)};&\\
  &0\leq(x\mod n-x\mod 1)/n\leq (n-1)/n;&\\
  &1/n\leq(x\mod n-x\mod 1+1)/n=z\leq 1;&\\
  &\lceil x/n\rceil-1=\lfloor x/n\rfloor\ \textrm{т.к. $x/n$ не является целым};&\\
  &\left\lceil\lceil x\rceil/n\right\rceil=\left\lceil\lfloor x/n\rfloor + z\right\rceil=\left\lceil\lceil x/n\rceil\right\rceil=\lceil x/n\rceil.&\\
\end{flalign*}

\subsubsection{36.}
Докажите, что $\sum_{k=1}^{n}{\lfloor k/2\rfloor}=\lfloor n^2/4\rfloor$; вычислите также сумму $\sum_{k=1}^{n}{\lceil k/2\rceil}$.

По формуле суммы арифметической прогрессии:
\begin{flalign*}
  &\sum_{k=1}^{n}{k/2}=\frac{1}{2}\sum_{k=0}^{n}{k}=\frac{1}{2}\frac{1}{2}n(n+1)=\frac{n(n+1)}{4}.&\\
\end{flalign*}

$k$ --- целое число. Для четных $k$ $\lfloor k/2 \rfloor=k/2$. Для нечетных $k$ $\lfloor k/2 \rfloor = k/2-1/2=(k-1)/2$. Обозначим через $m$ количество нечетных слагаемых в сумме. Тогда $m=\lceil n/2\rceil=\lfloor (n+1)/2\rfloor$:

\begin{tabularx}{0.6\textwidth} { 
  | >{\centering\arraybackslash}X 
  | >{\centering\arraybackslash}X | }
 \hline  $n$ & $m$ \\
 \hline  $0$ & $0$ \\
 \hline  $1$ & $1$ \\
 \hline  $2$ & $1$ \\
 \hline  $3$ & $2$ \\
 \hline  $4$ & $2$ \\
 \hline  $5$ & $3$ \\
 \hline
\end{tabularx}

Таким образом искомая сумма равна $\frac{n(n+1)}{4}-\left\lfloor\frac{n+1}{2}\right\rfloor\frac{1}{2}$.
\begin{flalign*}
  &\left\lfloor\frac{n+1}{2}\right\rfloor=\begin{cases}
  \frac{n}{2},\ \textrm{если $n$---четное},\\
  \frac{n+1}{2},\ \textrm{если $n$---нечетное};
  \end{cases}&\\
  &\sum=\begin{cases}
  \frac{n(n+1)}{4}-\frac{n}{4}=\frac{n^2+n-n}{4}=\frac{n^2}{4}=\left\lfloor\frac{n^2}{4}\right\rfloor,\ \textrm{если $n$---четное},\\
  \frac{n(n+1)}{4}-\frac{n+1}{4}=\frac{(n-1)(n+1)}{4}=\frac{n^2}{4}-\frac{1}{4},\ \textrm{если $n$---нечетное}.
  \end{cases}&\\
\end{flalign*}

В случае нечетного $n$ выражение $\frac{(n-1)(n+1)}{4}$ представляет собой целое число, которое меньше $\frac{n^2}{2}$ на $\frac{1}{4}$. Следовательно $\frac{n^2}{4}-\frac{1}{4}=\left\lfloor\frac{n^2}{4}\right\rfloor$.

\begin{flalign*}
  &\sum_{k=1}^{n}{\lceil k/2\rceil}=\frac{n(n+1)}{4}+\left\lfloor\frac{n+1}{2}\right\rfloor\frac{1}{2}=\begin{cases}
  \frac{n(n+1)}{4}+\frac{n}{4}=\frac{n^2+2n}{4}=\frac{(n+1)^2}{4}-\frac{1}{4}\,\ \textrm{если $n$---четное},\\
  \frac{n(n+1)}{4}+\frac{n+1}{4}=\frac{(n+1)^2}{4},\ \textrm{если $n$---нечетное}.
  \end{cases}&\\
\end{flalign*}

В любом случае получаем целые числа, равные округленному значению $\left\lfloor\frac{(n+1)^2}{4}\right\rfloor$. Заметим, что это выражение равно $\left\lceil\frac{n(n+2)}{4}\right\rceil$.

\subsubsection{37.}
Пусть $m$ и $n$ --- целые числа, $n>0$. Покажите, что
\begin{flalign*}
  \sum_{0\leq k<n}{\left\lfloor\frac{mk+x}{n}\right\rfloor}=\frac{(m-1)(n-1)}{2}+\frac{d-1}{2}+d\lfloor x/d\rfloor,
\end{flalign*}
где $d$---наибольший общий делитель $m$ и $n$, а $x$ --- любое действительное число.

По формуле суммы арифметической прогрессии
\begin{flalign*}
  &\sum_{0\leq k<n}{\frac{mk+x}{n}}=\sum_{0\leq k\leq n-1}{\left(\frac{x}{n}+\frac{m}{n}k\right)}=\frac{x}{n}n+\frac{1}{2}\frac{m}{n}(n-1)n=x+\frac{1}{2}m(n-1).&\\
\end{flalign*}
Как было показано в предыдущих упражнениях, $\left\lfloor\frac{\lfloor x\rfloor}{n}\right\rfloor=\left\lfloor\frac{x}{n}\right\rfloor$. В нашем случае, $\left\lfloor\frac{mk+x}{n}\right\rfloor=\left\lfloor\frac{mk+\lfloor x\rfloor}{n}\right\rfloor$, т.к. $mk$ --- целое число. $\sum_{0\leq k<n}{\frac{mk+\lfloor x\rfloor}{n}}$ меньше $\sum_{0\leq k<n}{\frac{mk+x}{n}}$ на $n\frac{x\mod 1}{n}=x\mod 1$.

Для того, чтобы получить результат, необходимо вычесть сумму дробных частей каждого слагаемого. Пусть $\{y\}=y\mod 1$. Т.е. требуется вычесть значение
\begin{flalign*}
  &S=\sum_{0\leq k<n}{\left\{\frac{mk+x}{n}\right\}}.&\\
\end{flalign*}

Если $d$ --- наибольший общий делитель чисел $m$ и $n$, то $m=\frac{m}{d}d$ и $n=\frac{n}{d}d$:
\begin{flalign*}
  &\frac{mk+x}{n}=
  \frac{\frac{m}{d}dk+\frac{x}{d}d}{\frac{n}{d}d}=
  \frac{\frac{m}{d}k+\frac{x}{d}}{\frac{n}{d}}=
  \frac{\frac{m}{d}k}{\frac{n}{d}}+\frac{x}{n};&\\
\end{flalign*}

$k$ принимает $n$ значений в интервале $[0..n)$, поэтому числа $0\mod n,\ 1\mod n,\ldots,\ n-1\mod n$ различны. Рассмотрим числа $mk\mod n$. $k\perp n$, $m\not\perp n$. Тогда
\begin{flalign*}
  &\sum_{0\leq k<n}{k}=\sum_{0\leq i<d}{\sum_{0\leq j<\frac{n}{d}}{i\frac{n}{d}+j}}.&\\
\end{flalign*}

Для любого фиксированного $i$ числа $\left(i\frac{n}{d}+j\right)\mod \frac{n}{d}$ различны, а
\begin{flalign*}
  &\sum_{0\leq j<\frac{n}{d}}{\left(\left(i\frac{n}{d}+j\right)\mod \frac{n}{d}\right)}=\sum_{0\leq j<\frac{n}{d}}{j}=\frac{1}{2}\frac{n}{d}\left(\frac{n}{d}-1\right)=
  \frac{n(n-d)}{2d^2}.&\\
\end{flalign*}
Числа $\frac{n}{d}$ и $\frac{m}{d}$ являются взаимнопростыми. Поэтому числа $j\frac{m}{d}\mod\frac{n}{d}$, а следовательно и $\frac{m}{d}\left(i\frac{n}{d}+j\right)\mod \frac{n}{d}$, также являются различными. Следовательно, различными являются и числа $\left(\frac{m}{d}k+\frac{x}{d}\right)\mod\frac{n}{d}$.

Видим, что данная сумма не зависит от $i$, т.е. каждые $d$ остатков от деления на $\frac{n}{d}$ повторяются. Но тогда повторяются и соответствующие дробные части этих слагаемых. Теперь нужно вычислить $\sum_{0\leq k<\frac{n}{d}}{\left\{\frac{\frac{m}{d}k}{\frac{n}{d}}+\frac{x}{n}\right\}}$. Из ответов к упражнению берем соотношение
\begin{flalign*}
  &\sum_{0\leq k<\frac{n}{d}}{\left\{\frac{\frac{m}{d}k}{\frac{n}{d}}+\frac{x}{n}\right\}}=\left\{\frac{x\mod d}{n}\right\}+\left\{\frac{x\mod d}{n}+\frac{1}{\frac{n}{d}}\right\}+\cdots+\left\{\frac{x\mod d}{n}+\frac{\frac{n}{d}-1}{\frac{n}{d}}\right\}.&\\
\end{flalign*}
Заметим, что $\frac{x\mod d}{n}<\frac{d}{n}=1/\frac{n}{d}$. Т.е. каждое слагаемое не превышает $1$. Следовательно, скобки, обозначающие отбрасывание целой части можно опустить. По формуле суммы арифметической прогрессии
\begin{flalign*}
  &S=d\left(\frac{\frac{n}{d}(x\mod d)}{n}+\frac{\frac{n}{d}-1}{2}\right)=
  d\left(\frac{(x\mod d)}{d}+\frac{n-d}{2d}\right)=(x\mod d)+\frac{1}{2}(n-d).&\\
\end{flalign*}
Итоговая сумма равна
\begin{flalign*}
  &x+\frac{1}{2}m(n-1)-(x\mod d)-\frac{1}{2}(n-d)=
  \frac{(m-1)(n-1)}{2}+\frac{n-1}{2}-\frac{n-d}{2}+d\left(\frac{x}{d}-\frac{x\mod d}{d}\right)=&\\
  &\frac{(m-1)(n-1)}{2}+\frac{d-1}{2}+d\left\lfloor\frac{x}{d}\right\rfloor.&\\
\end{flalign*}

\subsubsection{38.}
(Е. Буше (E. Busche), 1909.) Докажите, что для всех действительных чисел $x$ и $y$, причем $y>0$:
\begin{flalign*}
  \sum_{0\leq k<y}{\left\lfloor x+\frac{k}{y}\right\rfloor}=\lfloor xy+\lfloor x+1\rfloor(\lceil y\rceil-y)\rfloor.
\end{flalign*}
В частности, если $y$---целое положительное число, то, обозначив его через $n$, получим важную формулу:
\begin{flalign*}
  \left\lfloor x\right\rfloor+\left\lfloor x+\frac{1}{n}\right\rfloor+\cdots+\left\lfloor x+\frac{n-1}{n}\right\rfloor=\left\lfloor nx\right\rfloor.
\end{flalign*}

По формуле арифметической прогрессии
\begin{flalign*}
  &\sum_{0\leq k<y}{x+\frac{k}{y}}=\sum_{0\leq k<\lceil y\rceil}{x+\frac{k}{y}}=x\lceil y\rceil+\frac{1}{2}\frac{\lceil y\rceil-1}{y}\lceil y\rceil.&\\
\end{flalign*}

Это значение нужно уменьшить на сумму, состоющую из дробных частей каждого слагаемого
\begin{flalign*}
  &\sum_{0\leq k<\lceil y\rceil}{\left\{x+\frac{k}{y}\right\}}=
  \sum_{0\leq k<\lceil y\rceil}{\left\{x-\lfloor x\rfloor+\frac{k}{y}\right\}};&\\
  &0\leq x-\lfloor x\rfloor<1;\ 0\leq\frac{k}{y}<1;&\\
  &0\leq x-\lfloor x\rfloor+\frac{k}{y}<2;&\\
\end{flalign*}
Для того, чтобы число $x-\lfloor x\rfloor+\frac{k}{y}<1$, должно выполняться
\begin{flalign*}
  &y(x-\lfloor x\rfloor)+k<y\Longrightarrow k<y(1-x+\lfloor x\rfloor)\leq\lceil y(1-x+\lfloor x\rfloor)\rceil.&\\
\end{flalign*}

Тогда $\lceil y\rceil-\lceil y(1-x+\lfloor x\rfloor)\rceil$ слагаемых в сумме $\sum_{0\leq k<\lceil y\rceil}{\left\{x+\frac{k}{y}\right\}}$ больше $1$.
\begin{flalign*}
  &\sum_{0\leq k<\lceil y\rceil}{\left\{x-\lfloor x\rfloor+\frac{k}{y}\right\}}=
  \sum_{0\leq k<\lceil y\rceil}{\left(x-\lfloor x\rfloor+\frac{k}{y}\right)}-\lceil y\rceil+\lceil y(1-x+\lfloor x\rfloor)\rceil=&\\
  &(x-\lfloor x\rfloor)\lceil y\rceil+\frac{1}{2}\frac{\lceil y\rceil-1}{y}\lceil y\rceil-\lceil y\rceil+\lceil y(1-x+\lfloor x\rfloor)\rceil.&\\
\end{flalign*}

Вычтем из значения полной суммы сумму дробных частей каждого слагаемого:
\begin{flalign*}
  &\sum_{0\leq k<y}{x+\frac{k}{y}}-\sum_{0\leq k<\lceil y\rceil}{\left\{x-\lfloor x\rfloor+\frac{k}{y}\right\}}=\lfloor x\rfloor\lceil y\rceil+\lceil y\rceil-\lceil y(1-x+\lfloor x\rfloor)\rceil=&\\
  &\lceil y\rceil+\lceil y\rceil\lfloor x\rfloor-\lceil y+y\lfloor x\rfloor-yx\rceil=\lceil y\rceil+\lceil y\rceil\lfloor x\rfloor+\lfloor-y-y\lfloor x\rfloor+yx\rfloor=&\\
  &\lfloor\lceil y\rceil+\lceil y\rceil\lfloor x\rfloor-y-y\lfloor x\rfloor+yx\rfloor=
  \lfloor xy+\lceil y\rceil(1+\lfloor x\rfloor)-y(1+\lfloor x\rfloor)\rfloor=&\\
  &\lfloor xy+(1+\lfloor x\rfloor)(\lceil y\rceil-y)\rfloor=
  \lfloor xy+\lfloor x+1\rfloor(\lceil y\rceil-y)\rfloor.&\\
\end{flalign*}

\subsubsection{39.}
Функция $f$, для которой $f(x)+f(x+\frac{1}{n})+\cdots+f(x+\frac{n-1}{n})=f(nx)$, где $n$---любое положительное целое число, называется \emph{репликативной функцией}. Из предыдущего упражнения следует, что функция $\lfloor x\rfloor$ репликативна. Покажите, что репликативны следующие функции:
\begin{enumerate}[label=\alph*)]
\item $f(x)=x-\frac{1}{2}$;
\item $f(x)=[x\textrm{--- целое число}]$;
\item $f(x)=[x\textrm{--- положительное целое число}]$;
\item $f(x)=[\textrm{существует рациональное число $r$ и целое $m$, такие, что $x=r\pi+m$}]$;
\item ещё три функции, аналогичные функции (d), для которых $r$ и/или $m$ рассматриваются только на множестве положительных чисел;
\item $f(x)=\log{|2\sin{\pi x}|}$, если допускается значение $f(x)=-\infty$;
\item сумма любых двух репликативных функций;
\item произведение репликативной функции на константу;
\item функция $g(x)=f(x-\lfloor x\rfloor)$, где $f(x)$ репликативна.
\end{enumerate}

\begin{flalign*}
  &\textrm{(a) }\sum_{0\leq k<n}{x+\frac{k}{n}-\frac{1}{2}}=nx-\frac{n}{2}+\frac{1}{2}\frac{n-1}{n}n=nx+\frac{n^2-n-n^2}{2n}=nx-\frac{1}{2}.&\\
\end{flalign*}

\begin{flalign*}
  &\textrm{(b) }\sum_{0\leq k<n}{\left[x+\frac{k}{n}\textrm{---целое число}\right]}.&\\
\end{flalign*}
Рассмотрим числа $x,x+\frac{1}{n},x+\frac{2}{n},\ldots,x+\frac{n-1}{n}$. Все они лежат на интервале $[x;\ x+1)$. Внутри данного интервала может лежать только одно целое число равное $\lceil x\rceil$. Если среди всех слагаемых данной суммы есть одно целое число, то вся сумма будет равна $1$, а $x$ можно представить в виде $\lceil x-1\rceil+\frac{n-k}{n}$, где $0\leq k<n$. В этом случае $nx=n\left(\lceil x-1\rceil+\frac{n-k}{n}\right)=n\lceil x-1\rceil+n-k$ является целым числом, следовательно $f(nx)$ также равняется $1$.

\begin{flalign*}
  &\textrm{(c) }\sum_{0\leq k<n}{\left[x+\frac{k}{n}\textrm{---положительное целое число}\right]}&\\
\end{flalign*}
Мы выяснили, что все слагаемые данной суммы лежат на интервале $[x;\ x+1)$ и что внутри него есть только одно целое число $x\leq m<x+1$. Если $x\leq 0$, то $m<1$. Т.е. для того, чтобы это число было $>0$ необходимо, чтобы $x>0$, так как в противном случае в интервале может лежать либо 0, либо отрицательное целое число.

Итак, если сумма равна $1$, значит $x>0$ и $nx$ --- целое число, откуда $f(nx)=1$.
\begin{flalign*}
  &\textrm{(d) }\sum_{0\leq k<n}{\left[\textrm{существует рациональное число $r=\frac{p}{q}$ и целое $m$, такие, что $x+\frac{k}{n}=r\pi+m$}\right]};&\\
  &\textrm{Предположим, что такие числа существуют: }\frac{nx+k}{n}=r\pi+m,&\\
  &\textrm{тогда }nx=(nr)\pi+(nm-k);&\\
  &\pi=\frac{q(nx+k-mn)}{np}=\frac{q}{p}x-\frac{qm}{p}+\frac{qk}{np};&\\
  &p\pi-qx=q\frac{k}{n}-qm;&\\
  &np\pi-nqx=qk-nqm;&\\
  &np\pi-qk=nqx-nqm.&\\
\end{flalign*}
Предположим, что существуют целые числа $0\leq k_1<k_2<n$ для которых
\begin{flalign*}
  &np_1\pi-q_1k_1=nq_1x-nq_1m_1\Longrightarrow k_1q_1=n(p_1\pi-q_1x+q_1m_1)
  \Longrightarrow k_1=n(r_1\pi-x+m_1);&\\
  &np_2\pi-q_2k_2=nq_2x-nq_2m_2\Longrightarrow k_2q_2=n(p_2\pi-q_2x+q_2m_2)
  \Longrightarrow k_2=n(r_2\pi-x+m_2);&\\
  &c=k_2-k_1=n(\pi(r_2-r_1)+(m_2-m_1))\textrm{---целое положительное число, }1<c<n.&
\end{flalign*}
Последнее невозможно, т.к. $\pi$---нерациональное число. Следовательно, если такие числа существуют, то только для одного слагаемого данной суммы.

(e) В случае, если $r$ и/или $m$ являются положительными, доказательство репликативности остается аналогичным случаю (d). Действительно, для выражения $nx=(nr)\pi+(nm-k)$ $nr$ является положительным, если $r$ положительно, и $nm-k$ положительно при положительном целом $m$, т.к. $n>k$.

\begin{flalign*}
  &\textrm{(f) }
  \sum_{0\leq k<n}{\log{\left|2\sin{\pi\left(x+\frac{k}{n}\right)}\right|}}=
  \log{\prod_{0\leq k<n}{\left|2\sin{\pi\left(x+\frac{k}{n}\right)}\right|}}=\ldots&\\
\end{flalign*}

(g) Пусть $g(x)$ и $h(x)$ --- репликативные функции. Тогда
\begin{flalign*}
  &\sum_{0\leq k<n}{g\left(x+\frac{k}{n}\right)}=g(nx);&\\
  &\sum_{0\leq k<n}{h\left(x+\frac{k}{n}\right)}=h(nx);&\\
  &f(x)=g(x)+h(x);&\\
  &f(nx)=g(nx)+h(nx)=\sum_{0\leq k<n}{\left(g\left(x+\frac{k}{n}\right)+h\left(x+\frac{k}{n}\right)\right)}=\sum_{0\leq k<n}{f\left(x+\frac{k}{n}\right)}.&\\
\end{flalign*}

(h) Пусть $g(x)$ --- репликативная функция, а $f(x)=cg(x)$.
\begin{flalign*}
  &f(nx)=cg(nx)=\sum_{0\leq k<n}{cg\left(x+\frac{k}{n}\right)}=
  \sum_{0\leq k<n}{f\left(x+\frac{k}{n}\right)}.&\\
\end{flalign*}

\begin{flalign*}
  &\textrm{(i) }y(x)=x-\lfloor x\rfloor;&\\
  &\sum_{0\leq k<n}{f\left(x-\lfloor x\rfloor+\frac{k}{n}\right)}=
  \sum_{0\leq k<n}{f\left(y+\frac{k}{n}\right)}=f(ny)=f(n(x-\lfloor x\rfloor)).&\\
\end{flalign*}

\subsubsection{40.}
\subsubsection{41.}
Пусть $a_1,a_2,a_3,\ldots$ --- последовательность $1,2,2,3,3,3,4,4,4,4,\ldots$. Выразите $a_n$ как функцию от $n$ с помощью функции ``пол'' и/или ``потолок''.

\begin{tabularx}{0.6\textwidth} { 
  | >{\centering\arraybackslash}X 
  | >{\centering\arraybackslash}X | }
 \hline  $n$ & $a_n$ \\
 \hline  $1$ & $1$ \\
 \hline  $2$ & $2$ \\
 \hline  $3$ & $2$ \\
 \hline  $4$ & $3$ \\
 \hline  $5$ & $3$ \\
 \hline  $6$ & $3$ \\
 \hline  $7$ & $4$ \\
 \hline  $8$ & $4$ \\
 \hline  $9$ & $4$ \\
 \hline  $10$ & $4$ \\
 \hline  $11$ & $5$ \\
 \hline  $12$ & $5$ \\
 \hline  $13$ & $5$ \\
 \hline  $14$ & $5$ \\
 \hline  $15$ & $5$ \\
 \hline
\end{tabularx}

Пусть $S_k=\sum_{i=0}^{k}{i}$. Заметим, что для $n=1,3,6,10,15,\ldots$ $n=S_{a_n}$. По формуле суммы арифметической прогрессии $S_k=\frac{1}{2}k(k+1)$. Выразим $k$ через $S_k$:
\begin{flalign*}
  &\frac{1}{2}k^2+\frac{1}{2}k=S_k;&\\
  &k^2+k-2S_k=0;&\\
  &D=b-4ac=1-4(-2S_k)=1+8S_k;&\\
  &k_{1,2}=\frac{-b\pm\sqrt{D}}{2a}=\frac{-1\pm\sqrt{1+8S_k}}{2};&\\
  &k=\frac{1}{2}\left(\sqrt{8S_k+1}-1\right)\textrm{ (т.к. $k>0$)};&\\
  &a_n=\left\lceil\frac{1}{2}\left(\sqrt{8n+1}-1\right)\right\rceil.&\\
\end{flalign*}

\subsubsection{42.}
(a) Докажите, что
\begin{flalign*}
  \sum_{k=1}^{n}{a_k}=na_n-\sum_{k=1}^{n-1}{k(a_{k+1}-a_k)},\ \textrm{если }n>0.
\end{flalign*}
(b) Предыдущая функция используется для вычисления сумм, в которых присутствует функция ``пол''. Докажите, что если $b$---целое число и $b\geq2$, то
\begin{flalign*}
  \sum_{k=1}^{n}{\left\lfloor\log_{b}{k}\right\rfloor}=(n+1)\left\lfloor\log_{b}{n}\right\rfloor-(b^{\lfloor\log_{b}{n}\rfloor+1}-b)/(b-1).
\end{flalign*}

\begin{flalign*}
  &\textrm{(a) }\sum_{k=1}^{n}{a_k}=a_1+a_2+\ldots+a_n;&\\
  &\sum_{k=1}^{n-1}{k(a_{k+1-a_k})}=1(a_2-a_1)+2(a_3-a_2)+\ldots+(n-1)(a_n-a_{n-1})=&\\
  &(1a_2+2a_3+\ldots+(n-1)a_n)-(1a_1+2a_2+\ldots+(n-1)a_{n-1})=&\\
  &\sum_{k=2}^{n-1}{(k-1)a_k}+(n-1)a_n-a_1-\sum_{k=2}^{n-1}{ka_k}=
  \sum_{k=2}^{n-1}{(k-1)a_k-ka_k}+(n-1)a_n-a_1=&\\
  &-a_1-\sum_{k=2}^{n-1}{a_k}+(n-1)a_n=-\sum_{k=1}^{n-1}{a_k}+(n-1)a_n;&\\
  &na_n-\sum_{k=1}^{n-1}{k(a_{k+1}-a_k)}=na_n+\sum_{k=1}^{n-1}{a_k}-(n-1)a_n=
  \sum_{k=1}^{n-1}{a_k}+a_n=\sum_{k=1}^{n}{a_k}.&\\
\end{flalign*}

\begin{flalign*}
  &\textrm{(b) }\sum_{k=1}^{n}{\left\lfloor\log_{b}{k}\right\rfloor}=
  n\left\lfloor\log_{b}{n}\right\rfloor-\sum_{k=1}^{n-1}{k(\left\lfloor\log_{b}{(k+1)}\right\rfloor-\left\lfloor\log_{b}{k}\right\rfloor)};&\\
  &\lfloor\log_{b}{k}\rfloor=\begin{cases}
  0,\ 1\leq k<b,\\
  1,\ b\leq k<b^2,\\
  2,\ b^2\leq k<b^3,\\
  \cdots\\
  \lfloor\log_{b}{n}\rfloor-1,\ b^{\lfloor\log_{b}{n}\rfloor-1}\leq k<b^{\lfloor\log_{b}{n}\rfloor},\\
  \lfloor\log_{b}{n}\rfloor,\ b^{\lfloor\log_{b}{n}\rfloor}\leq k<b^{\lfloor\log_{b}{n}\rfloor+1};
  \end{cases}&\\
  &\left\lfloor\log_{b}{(k+1)}\right\rfloor-\left\lfloor\log_{b}{k}\right\rfloor=
  \begin{cases}
    0,\ b^{\lfloor\log_{b}{k}\rfloor}\leq k<k+1<b^{\lfloor\log_{b}{k}\rfloor+1},\\
    1,\ b^{\lfloor\log_{b}{k}\rfloor}\leq k<k+1=b^{\lfloor\log_{b}{k}\rfloor+1};
  \end{cases}&\\
  &\left\lfloor\log_{b}{(k+1)}\right\rfloor-\left\lfloor\log_{b}{k}\right\rfloor=[\log_{b}{(k+1)}\textrm{---целое число}].&\\
\end{flalign*}
Таким образом, первое целое число в сумме от $1$ до $n-1$ получаем при $k+1=b$, $k=b-1$. Второе при $k+1=b^2$, $k=b^2-1$. И т.д. до $k=b^{\lfloor\log_{b}{n}\rfloor}-1$ --- всего $\lfloor\log_{b}{n}\rfloor$ слагаемых. Сумма в правой части равенства примет вид
\begin{flalign*}
  &n\left\lfloor\log_{b}{n}\right\rfloor-((b-1)+(b^2-1)+(\ldots+b^{\lfloor\log_{b}{n}\rfloor}-1))=
  n\left\lfloor\log_{b}{n}\right\rfloor+\lfloor\log_{b}{n}\rfloor-\sum_{k=1}^{\lfloor\log_{b}{n}\rfloor}{b^k}=&\\
  &(n+1)\left\lfloor\log_{b}{n}\right\rfloor-\frac{1-b^{\lfloor\log_{b}{n}\rfloor+1}}{1-b}\ (\textrm{по формуле суммы геометрической прогрессии}).&\\
\end{flalign*}

\subsubsection{43.}
Вычислите сумму $\sum_{k=1}^{n}{\lfloor\sqrt{k}\rfloor}$.
Рассмотрим значения слагаемых данной суммы при различных значениях $k$:

\begin{tabularx}{0.6\textwidth} { 
  | >{\centering\arraybackslash}X 
  | >{\centering\arraybackslash}X | }
 \hline  $k$ & $\lfloor\sqrt{k}\rfloor$ \\
 \hline  $1$ & $1$ \\
 \hline  $2$ & $1$ \\
 \hline  $3$ & $1$ \\
 \hline  $4$ & $2$ \\
 \hline  $\cdots$ & $\cdots$ (всего 5 двоек) \\
 \hline  $8$ & $2$ \\
 \hline  $9$ & $3$ \\
 \hline  $\cdots$ & $\cdots$ (всего 7 троек) \\
 \hline  $15$ & $3$ \\
 \hline  $16$ & $4$ \\
 \hline  $\cdots$ & $\cdots$ (всего 9 четверок) \\
 \hline
\end{tabularx}

\begin{flalign*}
  &\lfloor\sqrt{k}\rfloor=
  \begin{cases}
    1,\ 1\leq k<4,\\
    2,\ 4\leq k<9,\\
    \cdots,\\
    \lfloor\sqrt{n}\rfloor-1, (\lfloor\sqrt{n}\rfloor-1)^2\leq k<(\lfloor\sqrt{n}\rfloor)^2,\\
    \lfloor\sqrt{n}\rfloor, (\lfloor\sqrt{n}\rfloor)^2\leq k\leq n<(\lfloor\sqrt{n}\rfloor+1)^2;
  \end{cases}&\\
  &S=\sum_{k=1}^{n}{\lfloor\sqrt{k}\rfloor}=n\lfloor\sqrt{n}\rfloor-\sum_{k=1}^{n-1}{k(\lfloor\sqrt{k+1}\rfloor-\lfloor\sqrt{k}\rfloor)};&\\
  &(\lfloor\sqrt{k+1}\rfloor-\lfloor\sqrt{k}\rfloor)=[\sqrt{k+1}\textrm{---целое число}];&\\
  &-\sum_{k=1}^{n-1}{k(\lfloor\sqrt{k+1}\rfloor-\lfloor\sqrt{k}\rfloor)}=
  -(2^2-1)-(3^2-1)-\ldots-(\lfloor\sqrt{n}\rfloor^2-1)=&\\
  &(\lfloor\sqrt{n}\rfloor-1)-\sum_{k=2}^{\lfloor\sqrt{n}\rfloor}{k^2}=
  (\lfloor\sqrt{n}\rfloor-1+1)-\left(1+\sum_{k=2}^{\lfloor\sqrt{n}\rfloor}{k^2}\right)=
  \lfloor\sqrt{n}\rfloor-\sum_{k=0}^{\lfloor\sqrt{n}\rfloor}{k^2}=&\\
  &\lfloor\sqrt{n}\rfloor-\frac{\lfloor\sqrt{n}\rfloor(\lfloor\sqrt{n}\rfloor+1)(2\lfloor\sqrt{n}\rfloor+1)}{6}&\\
  &S=n\lfloor\sqrt{n}\rfloor+\lfloor\sqrt{n}\rfloor-\frac{\lfloor\sqrt{n}\rfloor(\lfloor\sqrt{n}\rfloor+1)(2\lfloor\sqrt{n}\rfloor+1)}{6}=&\\
  &\frac{\lfloor\sqrt{n}\rfloor}{6}(6n+6-(\lfloor\sqrt{n}\rfloor+1)(2\lfloor\sqrt{n}\rfloor+1))=
  \lfloor\sqrt{n}\rfloor(n+1-\frac{1}{6}(\lfloor\sqrt{n}\rfloor+1)(2\lfloor\sqrt{n}\rfloor+1))=&\\
  &\lfloor\sqrt{n}\rfloor(n+1-\frac{1}{6}(2\lfloor\sqrt{n}\rfloor^2+3\lfloor\sqrt{n}\rfloor+1))=
  \lfloor\sqrt{n}\rfloor(n-\frac{1}{6}(2\lfloor\sqrt{n}\rfloor^2+3\lfloor\sqrt{n}\rfloor-5))=&\\
  &\lfloor\sqrt{n}\rfloor(n-\frac{1}{6}(\lfloor\sqrt{n}\rfloor-1)(2\lfloor\sqrt{n}\rfloor+5)).&\\
\end{flalign*}

\subsubsection{44.}
Покажите, что $\sum_{k\geq 0}{\sum_{1\leq j<b}{\lfloor(n+jb^k)/b^{k+1}\rfloor}}=n$, если $b$ и $n$ --- целые числа, $n\geq 0$ и $b\geq 2$. Чему равна эта сумма при $n<0$?

\begin{flalign*}
  &\sum_{k\geq 0}{\sum_{1\leq j<b}{\lfloor(n+jb^k)/b^{k+1}\rfloor}}=
  \sum_{1\leq j<b}{\sum_{k\geq 0}{\lfloor(n+jb^k)/b^{k+1}\rfloor}}.&\\
\end{flalign*}

\begin{tabularx}{1\textwidth} { 
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X
  | >{\centering\arraybackslash}X 
  | >{\centering\arraybackslash}X 
  | >{\centering\arraybackslash}X 
  | >{\centering\arraybackslash}X | }
 \hline  $j\backslash k$   & $0$ & $1$ & $2$ & $\cdots$ & $k$ & $\cdots$ \\
 \hline  $1$      & $\left\lfloor\frac{n+1}{b}\right\rfloor$ & $\left\lfloor\frac{n+b}{b^{2}}\right\rfloor$ & $\left\lfloor\frac{n+b^2}{b^{3}}\right\rfloor$ & $\cdots$ & $\left\lfloor\frac{n+b^k}{b^{k+1}}\right\rfloor$ & $\cdots$ \\
 \hline  $2$       & $\left\lfloor\frac{n+2}{b}\right\rfloor$ & $\left\lfloor\frac{n+2b}{b^{2}}\right\rfloor$ & $\left\lfloor\frac{n+2b^2}{b^{3}}\right\rfloor$ & $\cdots$ & $\left\lfloor\frac{n+2b^k}{b^{k+1}}\right\rfloor$ & $\cdots$ \\
 \hline  $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ \\
 \hline  $j$      & $\left\lfloor\frac{n+j}{b}\right\rfloor$ & $\left\lfloor\frac{n+jb}{b^{2}}\right\rfloor$  & $\left\lfloor\frac{n+jb^2}{b^{3}}\right\rfloor$ & $\cdots$ & $\left\lfloor\frac{n+jb^k}{b^{k+1}}\right\rfloor$ & $\cdots$ \\
 \hline  $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$  \\
 \hline  $b-1$    & $\left\lfloor\frac{n+(b-1)}{b}\right\rfloor$ & $\left\lfloor\frac{n+(b-1)b}{b^{2}}\right\rfloor$ & $\left\lfloor\frac{n+(b-1)b^2}{b^{3}}\right\rfloor$ & $\cdots$ & $\left\lfloor\frac{n+(b-1)b^k}{b^{k+1}}\right\rfloor$ & $\cdots$ \\
 \hline
\end{tabularx}

Каждое слагаемое в свою очередь состоит из двух слагаемых $\frac{n}{b^{k+1}}$ и $\frac{jb^k}{b^{k+1}}=\frac{j}{b}$.

Данная сумма является конечной, т.к. существует такое $k$, при котором
\begin{flalign*}
  &\frac{n}{b^{k+1}}+\frac{b-1}{b} < 1;\Longrightarrow n+b^k(b-1) < b^{k+1};\Longrightarrow n<b^k;\Longrightarrow\log_{b}{n}<\log_{b}{b^k}=k;&\\
  &\frac{n}{b^{k+1}}+\frac{b-2}{b} < 1;\Longrightarrow n+b^k(b-2) < b^{k+1};\Longrightarrow n<2b^k;\Longrightarrow\log_{b}{\frac{n}{2}}<\log_{b}{b^k}=k;&\\
  &\cdots&\\
  &\frac{n}{b^{k+1}}+\frac{2}{b} < 1\Longrightarrow n<b^k(b-2)\Longrightarrow \log_{b}{n}<k+\log_{b}{(b-2)}\Longrightarrow \log_{b}{\frac{n}{b-2}}<k;&\\
  &\frac{n}{b^{k+1}}+\frac{1}{b} < 1\Longrightarrow n<b^k(b-1)\Longrightarrow \log_{b}{n}<k+\log_{b}{(b-1)}\Longrightarrow \log_{b}{\frac{n}{b-1}}<k;&\\
\end{flalign*}

Рассмотрим суммы $\sum_{1\leq j<b}{\lfloor(n+jb^k)/b^{k+1}\rfloor}$ для различных фиксированных $k$. В каждой сумме по $b$ слагаемых. $0<\frac{j}{b}<1$. Все слагаемые $\left\lfloor\frac{n}{b^{k+1}}\right\rfloor\leq a_j\leq \left\lceil\frac{n}{b^{k+1}}\right\rceil$.

\begin{flalign*}
  &\sum_{j=1}^{b-1}{\left\lfloor\frac{n}{b^{k+1}}+\frac{j}{b}\right\rfloor}=
  (b-1)\left\lfloor\frac{n}{b^{k+1}}+\frac{b-1}{b}\right\rfloor-\sum_{j=1}^{b-2}{j\left(\left\lfloor\frac{n}{b^{k+1}}+\frac{j+1}{b}\right\rfloor-\left\lfloor\frac{n}{b^{k+1}}+\frac{j}{b}\right\rfloor\right)}.&\\
\end{flalign*}

Найдем слагаемое в сумме в правой части, которое не равно нулю. Пусть
\begin{flalign*}
  &p_k=\left\lfloor\frac{n}{b^{k+1}}\right\rfloor=\frac{p_kb^{k+1}}{b^{k+1}};&\\
  &\frac{n-p_kb^{k+1}}{b^{k+1}}+\frac{j}{b}<1\leq \frac{n-p_kb^{k+1}}{b^{k+1}}+\frac{j+1}{b};&\\
  &n-p_kb^{k+1}+jb^k<b^{k+1}\leq n-p_kb^{k+1}+jb^k+b^k;&\\
  &n-(p_k+1)b^{k+1}<-jb^k\leq n-(p_k+1)b^{k+1}+b^k;&\\
  &-\frac{n}{b^k}+(p_k+1)b-1\leq j<-\frac{n}{b^k}+(p_k+1)b;&\\
  &\left(\left\lfloor\frac{n}{b^{k+1}}\right\rfloor+1\right)b-\frac{n}{b^k}-1\leq j<\left(\left\lfloor\frac{n}{b^{k+1}}\right\rfloor+1\right)b-\frac{n}{b^k}<b-1;&\\
  &b\left(\left\lfloor\frac{n}{b^{k+1}}\right\rfloor+1-\frac{n}{b^{k+1}}\right)-1\leq j<b\left(\left\lfloor\frac{n}{b^{k+1}}\right\rfloor+1-\frac{n}{b^{k+1}}\right)<b-1;&\\
  &j=\left\lceil b\left(\left\lfloor\frac{n}{b^{k+1}}\right\rfloor+1-\frac{n}{b^{k+1}}\right)-1\right\rceil=b\left\lfloor\frac{n}{b^{k+1}}\right\rfloor+b-1+\left\lceil -b\frac{n}{b^{k+1}}\right\rceil=b\left\lfloor\frac{n}{b^{k+1}}\right\rfloor+b-1-\left\lfloor b\frac{n}{b^{k+1}}\right\rfloor=&\\
  &b-1-\left\lfloor b\frac{n}{b^{k+1}}-b\left\lfloor\frac{n}{b^{k+1}}\right\rfloor\right\rfloor=
  b-1-\left\lfloor b\left(\frac{n}{b^{k+1}}-\left\lfloor\frac{n}{b^{k+1}}\right\rfloor\right)\right\rfloor=
  b-1-\left\lfloor\frac{n\mod b^{k+1}}{b^k}\right\rfloor.&\\
\end{flalign*}

В последнем выражении правая часть не превышает $b-1$ и не может быть отрицательной. Нас интересуют $j<b-1$. Если $j=b-1$, то сумма в правой части обращается в $0$.

\begin{flalign*}
  &\sum_{j=1}^{b-1}{\left\lfloor\frac{n}{b^{k+1}}+\frac{j}{b}\right\rfloor}=
  (b-1)\left\lfloor\frac{n}{b^{k+1}}+\frac{b-1}{b}\right\rfloor-\left(b-1-\left\lfloor\frac{n\mod b^{k+1}}{b^k}\right\rfloor\right)\mod(b-1).&\\
\end{flalign*}

Как мы выяснили выше, первое слагаемое обращается в $0$ при $k>\log_{b}{n}$. Второе слагаемое также обращается в $0$:
\begin{flalign*}
  &\frac{n\mod b^{k+1}}{b^k}<1\Longrightarrow n\mod b^{k+1}<b^k\Longrightarrow
  n<b^k\Longrightarrow\log_{b}{n}<k.&\\
\end{flalign*}

Заметим, что при $k=\log_{b}{n}+1$, которое не обязательно является целым числом:
\begin{flalign*}
  &(b-1)\left\lfloor\frac{n}{b^{\log_{b}{n}+2}}+\frac{b-1}{b}\right\rfloor-\left(b-1-\left\lfloor\frac{n\mod b^{\log_{b}{n}+2}}{b^{\log_{b}{n}+1}}\right\rfloor\right)\mod(b-1)=&\\
  &(b-1)\left\lfloor\frac{n}{nb^2}+\frac{b-1}{b}\right\rfloor-\left(b-1-\left\lfloor\frac{n\mod nb^2}{nb}\right\rfloor\right)\mod(b-1)=&\\
  &(b-1)\left\lfloor\frac{b^2-b+1}{b^2}\right\rfloor-(b-1)\mod(b-1)=0-0=0.&\\
\end{flalign*}

Заметим, что при $k=\log_{b}{n}$, которое не обязательно является целым числом:
\begin{flalign*}
  &(b-1)\left\lfloor\frac{n}{b^{\log_{b}{n}+1}}+\frac{b-1}{b}\right\rfloor-\left(b-1-\left\lfloor\frac{n\mod b^{\log_{b}{n}+1}}{b^{\log_{b}{n}}}\right\rfloor\right)\mod(b-1)=&\\
  &(b-1)\left\lfloor\frac{n}{nb}+\frac{b-1}{b}\right\rfloor-\left(b-1-\left\lfloor\frac{n\mod nb}{nb}\right\rfloor\right)\mod(b-1)=&\\
  &(b-1)-0=b-1.&\\
\end{flalign*}

Следовательно, внешняя сумма имеет вид
\begin{flalign*}
  &\sum_{k=0}^{\lfloor\log_{b}{n}\rfloor}{(b-1)\left\lfloor\frac{n}{b^{k+1}}+\frac{b-1}{b}\right\rfloor-\left(b-1-\left\lfloor\frac{n\mod b^{k+1}}{b^k}\right\rfloor\right)\mod(b-1)}&\\
\end{flalign*}

Рассмотрим первое слагаемое:
\begin{flalign*}
  &b^{\lfloor\log_{b}{n}\rfloor}\leq n<b^{\lfloor\log_{b}{n}\rfloor+1}\Longrightarrow
  \frac{1}{b}\leq\frac{n}{b^{\lfloor\log_{b}{n}\rfloor+1}}<1\Longrightarrow
  1\leq\frac{n}{b^{\lfloor\log_{b}{n}\rfloor+1}}+\frac{b-1}{b}<1+\frac{b-1}{b}<1+1;&\\
  &1\leq\frac{n}{b^{\lfloor\log_{b}{n}\rfloor}}<b\Longrightarrow
  2-\frac{1}{b}<1+1\leq\frac{n}{b^{\lfloor\log_{b}{n}\rfloor+1}}+\frac{b-1}{b}<b+1-\frac{1}{b}<b+1;&\\
  &b+1\leq\frac{n}{b^{\lfloor\log_{b}{n}\rfloor-1}}+\frac{b-1}{b}<b^2+1;&\\
  &\cdots&\\
  &b^{\lfloor\log_{b}{n}\rfloor-1}+1\leq\frac{n}{b}+\frac{b-1}{b}<b^{\lfloor\log_{b}{n}\rfloor}+1;&\\
\end{flalign*}
\begin{flalign*}
  &\left\lfloor\frac{n}{b^{k+1}}+\frac{b-1}{b}\right\rfloor=\left\lfloor1+\frac{n-b^k}{b^{k+1}}\right\rfloor=
  \begin{cases}
    \left\lfloor\frac{n}{b^{k+1}}\right\rfloor,\ \frac{n}{b^{k+1}}-\left\lfloor\frac{n}{b^{k+1}}\right\rfloor<\frac{1}{b},\\
    \left\lfloor\frac{n}{b^{k+1}}\right\rfloor+1,\ \frac{n}{b^{k+1}}-\left\lfloor\frac{n}{b^{k+1}}\right\rfloor\geq\frac{1}{b};
  \end{cases}&\\
\end{flalign*}

В первом случае выражение можно интерпретировать как число целых раз, которое $b^k+1$ входит в $n$. Второе слагаемое обращается в $0$.
Во втором случае к этому числу прибавляется $1$ с тем, чтобы затем произведения на $(b-1)$ уменьшить так, чтобы в оставшейся части числа $n$ уместилось $b^k-1$. Получаем результат, идентичный формуле
\begin{flalign*}
  &n=\sum_{k=0}^{\log_{b}{n}}{b^k\left\lfloor\frac{n}{b^k}\right\rfloor}.&\\
\end{flalign*}

Последнее заключение получено без вывода. Для отрицательных $n$ получаем $n-1$ (также без вывода).

\subsubsection{45.}
Результат упр. 37 несколько удивляет, т.к. из него следует, что
\begin{flalign*}
  \sum_{0\leq k<n}{\left\lfloor\frac{mk+x}{n}\right\rfloor}=
  \sum_{0\leq k<m}{\left\lfloor\frac{nk+x}{m}\right\rfloor}.
\end{flalign*}
Это ``соотношение взаимности'' --- только один пример из множества подобных формул (см. раздел 3.3.3). Покажите, что для любой функции $f$
\begin{flalign*}
  \sum_{0\leq j<n}{f\left(\left\lfloor\frac{mj}{n}\right\rfloor\right)}=
  \sum_{0\leq r<m}{\left\lceil\frac{rn}{m}\right\rceil(f(r-1)-f(r))}+nf(m-1).
\end{flalign*}
В частности, докажите, что
\begin{flalign*}
  \sum_{0\leq j<n}{\binom{\lfloor mj/n\rfloor+1}{k}}+
  \sum_{0\leq j<m}{\left\lceil\frac{jn}{m}\right\rceil\binom{j}{k-1}}=
  n\binom{m}{k}.
\end{flalign*}
[\emph{Указание.} Выполните замену переменных $r=\lfloor mj/n\rfloor$. Биномиальные коэффициенты $\binom{m}{k}$ обсуждаются в разделе 1.2.6.]

\begin{flalign*}
  &\sum_{0\leq j<n}{f\left(\left\lfloor\frac{mj}{n}\right\rfloor\right)}=
  f(0)+
  f\left(\left\lfloor\frac{m}{n}\right\rfloor\right)+\ldots+
  f\left(\left\lfloor\frac{2m}{n}\right\rfloor\right)+\ldots+
  f\left(\left\lfloor\frac{(n-1)m}{n}\right\rfloor\right)=&\\
  &\sum_{1\leq k=j+1\leq n}{f\left(\left\lfloor\frac{m(k-1)}{n}\right\rfloor\right)}=
  nf\left(\left\lfloor\frac{m(n-1)}{n}\right\rfloor\right)-\sum_{1\leq k<n}{k\left({f\left(\left\lfloor\frac{mk}{n}\right\rfloor\right)}-{f\left(\left\lfloor\frac{m(k-1)}{n}\right\rfloor\right)}\right)};&\\
  &f\left(\left\lfloor\frac{m(n-1)}{n}\right\rfloor\right)=
  f\left(\left\lfloor m-\frac{1}{n}\right\rfloor\right)=f(m-1);&\\
  &r'=\frac{mj}{n}\Longrightarrow j=\frac{nr'}{m};\ r=\left\lfloor\frac{mj}{n}\right\rfloor;&\\
\end{flalign*}
\begin{flalign*}
  &-\sum_{1\leq k<n}{k\left({f\left(\left\lfloor\frac{mk}{n}\right\rfloor\right)}-{f\left(\left\lfloor\frac{m(k-1)}{n}\right\rfloor\right)}\right)}=
  \sum_{0\leq j<n-1}{(j+1)\left({f\left(\left\lfloor\frac{mj}{n}\right\rfloor\right)}-{f\left(\left\lfloor\frac{m(j+1)}{n}\right\rfloor\right)}\right)};&\\
  &0\leq j<n\Longrightarrow 0\leq \frac{mj}{n}<m\Longrightarrow 0\leq r<m;&\\
  &0\leq j<n-1\Longrightarrow 0\leq \frac{mj}{n}<\frac{m(n-1)}{n}<m\Longrightarrow 0\leq r<m;&\\
\end{flalign*}
Если $m<=n$, то формула $\sum_{0\leq j<n-1}{(j+1)\left({f\left(\left\lfloor\frac{mj}{n}\right\rfloor\right)}-{f\left(\left\lfloor\frac{m(j+1)}{n}\right\rfloor\right)}\right)}=\sum_{1\leq r<m}{\left\lceil\frac{rn}{m}\right\rceil(f(r-1)-f(r))}=\sum_{0\leq r<m}{\left\lceil\frac{rn}{m}\right\rceil(f(r-1)-f(r))}$ справедлива в силу того, что одному целому $r$ соответствует одно или несколько целых $j$, и
\begin{flalign*}
  &p=f\left(\left\lfloor\frac{mj}{n}\right\rfloor\right)-
  f\left(\left\lfloor\frac{m(j+1)}{n}\right\rfloor\right)=\begin{cases}
  0,\ \left\lfloor\frac{m(j+1)}{n}\right\rfloor-\left\lfloor\frac{mj}{n}\right\rfloor=0,\\
  f(r-1)-f(r)=,\ \left\lfloor\frac{m(j+1)}{n}\right\rfloor-\left\lfloor\frac{mj}{n}\right\rfloor=1;
  \end{cases}&\\
  &j=\left\lceil\frac{rn}{m}\right\rceil\ (\textrm{если }p\neq 0);&\\
\end{flalign*}

Если $m>n$, то одному целому $j$ соответствует несколько $r$. Но $j=\left\lceil\frac{rn}{m}\right\rceil$ для всех $j$. Если существует такие $r_1, r_2, \ldots, r_l$, что им соответствует одно число $j$, то 
\begin{flalign*}
  &\left\lceil\frac{r_1n}{m}\right\rceil=\left\lceil\frac{r_2n}{m}\right\rceil=\ldots=\left\lceil\frac{r_ln}{m}\right\rceil;&\\
  &\sum_{1\leq i\leq l}{f(r_{i-1})-f(r_i)}=f(r_{i-1})-f(r_l).&\\
\end{flalign*}
К доказательству частного случая можно вернуться при рассмотрении биномиальных коэффициентов.

%TODO%

\subsubsection{46.}
(\emph{Обобщенный закон взаимности}.) Обобщите формулу из упр. 45 таким образом, чтобы получить выражение для суммы $\sum_{0\leq j<\alpha n}{f(\lfloor mj/n\rfloor)}$, где $\alpha$ --- \emph{любое} положительное действительное число.
%TODO%
\subsubsection{47.}
%TODO%
\subsubsection{48.}
Пусть $m$ и $n$ --- целые числа. Докажите или опровергните следующие тождества:
\begin{flalign*}
  \textrm{(a) }\left\lfloor\frac{m+n-1}{n}\right\rfloor=\left\lceil\frac{m}{n}\right\rceil;\ \ \ \ \textrm{(b) }\left\lfloor\frac{n+2-\lfloor n/25\rfloor}{3}\right\rfloor=\left\lfloor\frac{8n+24}{25}\right\rfloor.
\end{flalign*}

\begin{flalign*}
  &\textrm{a) }\left\lfloor\frac{m}{n}+\frac{n-1}{n}\right\rfloor=\begin{cases}
  \left\lfloor\frac{m}{n}\right\rfloor+\left\lfloor\frac{n-1}{n}\right\rfloor=\left\lfloor\frac{m}{n}\right\rfloor,\textrm{ если }\frac{m\mod n+n-1}{n}<1,\\
  \left\lfloor\frac{m}{n}\right\rfloor+\left\lfloor\frac{n-1}{n}\right\rfloor+1=
  \left\lfloor\frac{m}{n}\right\rfloor+1,\textrm{ если }\frac{m\mod n+n-1}{n}\geq1;
  \end{cases}&\\
  &0\leq m\mod n<n.&
\end{flalign*}
Для того, чтобы выполнялось первое условие
\begin{flalign*}
  &m\mod n+n-1<n;&\\
  &m\mod n<1.&\\
\end{flalign*}
Т.е первое условие выполняется только при $m$ кратном $n$, тогда $\left\lfloor\frac{m}{n}\right\rfloor=\left\lceil\frac{m}{n}\right\rceil$.
Второе условие выполняется при $m$ некратном $n$:
\begin{flalign*}
  &m\mod n+n-1\geq n;&\\
  &m\mod n\geq 1.&\\
\end{flalign*}
И тогда $\left\lfloor\frac{m}{n}\right\rfloor+1=\left\lceil\frac{m}{n}\right\rceil$.

Данные соотношения справедливы для положительного $n$. Для отрицательного $n$ и $m$ кратного $n$ соотношения не выполняются.

\begin{flalign*}
  &\textrm{b) }\left\lfloor\frac{8n+24}{25}\right\rfloor=
  \left\lceil\frac{8n}{25}\right\rceil;&\\
  &\left\lfloor\frac{n+2-\lfloor n/25\rfloor}{3}\right\rfloor=
  \left\lceil\frac{n-\lfloor n/25\rfloor}{3}\right\rceil;&\\
  &\frac{8n}{25}=\frac{n}{3+\frac{1}{8}}=\frac{n}{3(1+\frac{1}{24})}=
  \frac{n}{3(\frac{25}{24})}=\frac{\frac{24n}{25}}{3}=\frac{n-\frac{n}{25}}{3}.&\\
\end{flalign*}
Если $n/25$ целое, то получаем верное тождество. В противном случае
\begin{flalign*}
  &\frac{n-\frac{n}{25}}{3}<\frac{n-\lfloor\frac{n}{25}\rfloor}{3};&\\
  &\left\lfloor\frac{n}{25}\right\rfloor\leq\frac{n}{25}<\left\lfloor\frac{n}{25}\right\rfloor+1;&\\
  &-\left\lfloor\frac{n}{25}\right\rfloor-1<-\frac{n}{25}\leq-\left\lfloor\frac{n}{25}\right\rfloor;&\\
  &n-\left\lfloor\frac{n}{25}\right\rfloor-1<n-\frac{n}{25}\leq n-\left\lfloor\frac{n}{25}\right\rfloor;&\\
  &\frac{n-\left\lfloor\frac{n}{25}\right\rfloor}{3}-\frac{1}{3}<\frac{n-\frac{n}{25}}{3}\leq \frac{n-\left\lfloor\frac{n}{25}\right\rfloor}{3}.&\\
\end{flalign*}
Таким образом, получаем, что разница между неокругленными дробями меньше $\frac{1}{3}$. Большая дробь может быть целой или иметь дробную часть $\frac{1}{3}$ или $\frac{2}{3}$. Если большая дробь целая, то меньшая округляется до неё в большую сторону. Если большая дробь дробная, то меньшая имеет ту же целую часть и тоже не является целой. Следовательно, при округлении они дают одно и тоже целое число.

\subsubsection{49.}
Предположим, что функция $f(x)$ удовлетворяет следующим двум условиям: (i) $f(x+1)=f(x)+1$; (ii) $f(x)=f(f(nx)/n)$ для всех положительных целых $n$. Докажите, что для всех рациональных $x$ либо $f(x)=\lfloor x\rfloor$, либо $f(x)=\lceil x\rceil$.

%TODO%

\subsection{Перестановки и факториалы}

\subsubsection{1.}
Сколькими способами можно перетасовать колоду из 52 карт?

$52!$

\subsubsection{2.}
Используя обозначения из соотношения (2), покажите, что $p_{n(n-1)}=p_{nn}$, и объясните, почему это так.
\begin{flalign*}
  &p_{nk}=n(n-1)\ldots(n-k+1);&\\
  &p_{n(n-1)}=n(n-1)\ldots(n-n+3)(n-n+2)=n(n-1)\ldots 3\ 2;&\\
  &p_{nn}=n(n-1)\ldots(n-n+3)(n-n+2)(n-n+1)=n(n-1)\ldots 3\ 2\ 1=p_{n(n-1)}.&\\
\end{flalign*}
Существует два способа выбрать предпоследний элемент из двух возможных и один способ выбрать последний элемент из одного.

\subsubsection{3.}
Какие перестановки чисел $\{1,2,3,4,5\}$ можно построить из перестановки $3\ 1\ 2\ 4$ с помощью методов 1 и 2 соответственно?

По первому методу поставим $5$ во все возможные позиции
\begin{flalign*}
  &5\ 3\ 1\ 2\ 4,&\\
  &3\ 5\ 1\ 2\ 4,&\\
  &3\ 1\ 5\ 2\ 4,&\\
  &3\ 1\ 2\ 5\ 4,&\\
  &3\ 1\ 2\ 4\ 5.&
\end{flalign*}

По второму методу запишем сначала $3\ 1\ 2\ 4\ \frac{1}{2}$, $3\ 1\ 2\ 4\ \frac{3}{2}$, $3\ 1\ 2\ 4\ \frac{5}{2}$, $3\ 1\ 2\ 4\ \frac{7}{2}$, $3\ 1\ 2\ 4\ \frac{9}{2}$, а затем преобразуем в $4\ 2\ 3\ 5\ 1$, $4\ 1\ 3\ 5\ 2$, $4\ 1\ 2\ 5\ 3$, $3\ 1\ 2\ 5\ 4$, $3\ 1\ 2\ 4\ 5$.

\subsubsection{4.}
Учитывая тот факт, что $\log_{10}{1000!}=2567.60464\ldots$, определите точно, сколько цифр содержится в числе $1000!$. Какая цифра стоит в \emph{старшем} разряде? Какая в \emph{младшем}?

\begin{flalign*}
  &10^{2567}<1000!<10^{2568}.&\\
\end{flalign*}
Число $1000!$ содержит $2568$ цифр в десятичном представлении. В старшем разряде может стоять цифра $1\leq k\leq 9$.
\begin{flalign*}
  &\log_{10}{k10^{2567}}=2567+\log_{10}{k};&\\
  &\log_{10}{4}<0.60464<\log_{10}{5};&\\
  &k=4.&
\end{flalign*}
В младшем разряде стоит $0$, т.к. число кратно $10$.

\subsubsection{5.}
Оцените значение $8!$ с помощью следующей более точной приближенной формулы Стирлинга:
\begin{flalign*}
  n!\approx \sqrt{2\pi n}\left(\frac{n}{e}\right)^n\left(1+\frac{1}{12n}\right).
\end{flalign*}
\begin{flalign*}
  &8!=8*7*6*5*4*3*2=2^{1+2+3+1=7}*3^2*5*7=128*9*5*7=896*5*9=8064*5=40320;&\\
  &\sqrt{2\pi 8}\left(\frac{8}{e}\right)^8\left(1+\frac{1}{12*8}\right)=
  \frac{2^{21}97}{3e^8}\sqrt{\pi}\approx 40318.&\\
  &\delta=\frac{2}{40320}*100\%\approx 0.005\%.&\\
\end{flalign*}

\subsubsection{6.}
Используя формулу (8), запишите $20!$ в виде произведения простых сомножителей.

\begin{flalign*}
  &\mu_{2}=\left\lfloor\frac{20}{2}\right\rfloor+\left\lfloor\frac{20}{4}\right\rfloor+\left\lfloor\frac{20}{8}\right\rfloor+\left\lfloor\frac{20}{16}\right\rfloor=10+5+2+1=18;&\\
  &\mu_{3}=\left\lfloor\frac{20}{3}\right\rfloor+\left\lfloor\frac{20}{9}\right\rfloor=6+2=8;&\\
  &\mu_{5}=\left\lfloor\frac{20}{5}\right\rfloor=4;&\\
  &\mu_{7}=2;&\\
  &\mu_{11}=\mu_{13}=\mu_{17}=\mu_{19}=1;&\\
  &20!=2^{18}\cdot 3^{8}\cdot 5^{4}\cdot 7^{2}\cdot 11\cdot 13\cdot 17\cdot 19.&\\
\end{flalign*}

\subsubsection{7.}
Покажите, что ``обощенная терминальная'' функция, определенная формулой (10), удовлетворяет тождеству $x?=x+(x-1)?$ для всех действительных $x$.

\begin{flalign*}
  &x?=\frac{1}{2}x(x+1)=\frac{1}{2}x^2+\frac{1}{2}x;&\\
  &(x-1)?=\frac{1}{2}(x-1)x=\frac{1}{2}x^2-\frac{1}{2}x;&\\
  &x+(x-1)?=\frac{1}{2}(x-1)x=\frac{1}{2}x^2-\frac{1}{2}x+\frac{2}{2}x=
  \frac{1}{2}x^2+\frac{1}{2}x=x?.&\\
\end{flalign*}

\subsubsection{8.}
Покажите, что предел в формуле (13) равен $n!$ и в том случае, если $n$ --- неотрицательное целое число.

\begin{flalign*}
  &\lim_{m\rightarrow\infty}{\frac{m^nm!}{(n+1)(n+2)\ldots(n+m)}}=
  \lim_{m\rightarrow\infty}{\frac{m^n(m(m-1)(m-2)\ldots(n+2)(n+1)n(n-1)\ldots 2\ 1)}{(n+m)(n+m-1)\ldots(m+1)m(m-1)(m-2)\ldots(n+2)(n+1)}}=&\\
  &\lim_{m\rightarrow\infty}{\frac{m^n(n(n-1)\ldots 2\ 1)}{(n+m)(m+n-1)\ldots(m+1)}}=\lim_{m\rightarrow\infty}{n(n-1)\ldots 2\ 1}=n(n-1)\ldots 2\ 1=n!&\\
\end{flalign*}

\subsubsection{9.}
Определите значения $\Gamma\left(\frac{1}{2}\right)$ и $\Gamma\left(-\frac{1}{2}\right)$ на основании того, что $\left(\frac{1}{2}\right)!=\sqrt{\pi}/2$.

\begin{flalign*}
  &\Gamma(x)=\frac{x!}{x};\Longrightarrow\Gamma\left(\frac{1}{2}\right)=\frac{\left(\frac{1}{2}\right)!}{\frac{1}{2}}=\frac{2\sqrt{\pi}}{2}=\sqrt{\pi}.&\\
\end{flalign*}
\begin{flalign*}
  &(-z!)\Gamma(z)=\frac{\pi}{\sin{\pi z}};\Longrightarrow\Gamma(-z)=-\frac{\pi}{z!\sin{\pi z}};&\\
  &\Gamma\left(-\frac{1}{2}\right)=-\frac{\pi}{\left(\frac{1}{2}\right)!\sin{\frac{\pi}{2}}}=-2\sqrt{\pi}.&\\
\end{flalign*}

\subsubsection{10.}
Справедливо ли тождество $\Gamma(x+1)=x\Gamma(x)$ для всех действительных чисел $x$ (см. упр. 7)?
\begin{flalign*}
  &\Gamma(x)=\lim_{m\rightarrow\infty}{\frac{m^xm!}{x(x+1)(x+2)\ldots(x+m)}};&\\
  &\Gamma(x+1)=\lim_{m\rightarrow\infty}{\frac{m^{x+1}m!}{(x+1)(x+2)\ldots(x+m)(x+1+m)}};&\\
  &x\Gamma(x)=\lim_{m\rightarrow\infty}{\frac{xm^xm!}{x(x+1)(x+2)\ldots(x+m)}}=
  \lim_{m\rightarrow\infty}{\frac{xm^xm!}{x(x+1)(x+2)\ldots(x+m)}\frac{m}{x+1+m}}=&\\
  &\lim_{m\rightarrow\infty}{\frac{m^{x+1}m!}{(x+1)(x+2)\ldots(x+m)(x+1+m)}}=
  \Gamma(x+1).&\\
\end{flalign*}

Данные построения не выполняются в случае отрицательных целых $x$ или $x=0$.

\subsubsection{11.}
Пусть представление числа $n$ в двоичной системе выглядит следующим образом: $n=2^{e_1}+2^{e_2}+\cdots+2^{e_r}$, где $e_1>e_2>\cdots>e_r\leq 0$. Покажите, что $n!$ делится на $2^{n-r}$, но не делится на $2^{n-r+1}$.

Для нахождения максимальной степени двойки $\mu$, которая входит в $n!$, необходимо вычислить $\sum_{k>0}{\left\lfloor\frac{n}{2^k}\right\rfloor}$. Максимальное значение $k$, при котором дробь не обращается в $0$, равно $e_1$. Процесс вычисления суммы можно представить ввиде последовательного сдвига числа $n$ вправо.

Для $r=1$ $\mu=2^{e_1-1}+2^{e_1-2}+\ldots+2^{e_1-e_1+1}+2^{e_1-e_1}=2^{e_1}-1=n-1$.

Для $r=2$ $\mu=(2^{e_1-1}+2^{e_1-2}+\ldots+2^{e_1-e_1+1}+2^{e_1-e_1})+(2^{e_2-1}+2^{e_2-2}+\ldots+2^{e_2-e_2+1}+2^{e_2-e_2})=2^{e_1}-1+2^{e_2}-1=n-2$.

Для $r=r$ $\mu=(2^{e_1-1}+2^{e_1-2}+\ldots+2^{e_1-e_1+1}+2^{e_1-e_1})+(2^{e_2-1}+2^{e_2-2}+\ldots+2^{e_2-e_2+1}+2^{e_2-e_2})+\ldots+(2^{e_r-1}+2^{e_r-2}+\ldots+2^{e_r-e_r+1}+2^{e_r-e_r})=2^{e_1}-1+2^{e_2}-1+\ldots+2^{e_r}-1=n-r$.

\subsubsection{12.}
(А. Лежандр, 1808.) Обобщим результата предыдущего упражнения. Пусть $p$ --- простое число и представление $n$ в системе счисления с основанием $p$ имеет вид $n=a_kp^k+a_{k-1}p^{k-1}+\ldots+a_1p+a_0$. Найдите простую формулу, выражающую число $\mu$ из формулы (8) через $n$, $p$ и  коэффициенты $a_k$.

\begin{flalign*}
  &\left\lfloor\frac{a_kp^k+a_{k-1}p^{k-1}+\ldots+a_1p+a_0}{p}\right\rfloor=
  a_kp^{k-1}+a_{k-1}p^{k-2}+\ldots+a_2p+a_1;&\\
  &\left\lfloor\frac{a_kp^k+a_{k-1}p^{k-1}+\ldots+a_1p+a_0}{p^2}\right\rfloor=
  a_kp^{k-2}+a_{k-1}p^{k-3}+\ldots+a_3p+a_2;&\\
  &\ldots&\\
  &\left\lfloor\frac{a_kp^k+a_{k-1}p^{k-1}+\ldots+a_1p+a_0}{p^{k-1}}\right\rfloor=
  a_kp+a_{k-1};&\\
  &\left\lfloor\frac{a_kp^k+a_{k-1}p^{k-1}+\ldots+a_1p+a_0}{p^{k}}\right\rfloor=
  a_k;&\\
  &\left\lfloor\frac{a_kp^k+a_{k-1}p^{k-1}+\ldots+a_1p+a_0}{p^{k+1}}\right\rfloor=
  0;&\\
\end{flalign*}
\begin{flalign*}
  &a_k\sum_{0\leq i\leq k-1}{p^i}+a_{k-1}\sum_{0\leq i\leq k-2}{p^i}+\ldots+a_2(1+p)+a_1=&\\
  &a_k\left(\frac{1-p^{k}}{1-p}\right)+a_{k-1}\left(\frac{1-p^{k-1}}{1-p}\right)+\ldots+a_2\left(\frac{1-p^2}{1-p}\right)+a_1\frac{1-p}{1-p}=&\\
  &\frac{a_k(1-p^k)+a_{k-1}(1-p^{k-1})+\ldots+a_2(1-p^2)+a_1(1-p)}{1-p}=&\\
  &\frac{-(n-a_0)+\sum_{0<i\leq k}{a_i}}{1-p}=\frac{n-\sum_{0\leq i\leq k}{a_i}}{p-1}.&\\
\end{flalign*}

\subsection{Биномиальные коэффициенты}

\subsubsection{10.}
Пусть $p$ --- простое число. Покажите:

\paragraph{e.}

\begin{flalign} \label{eq:1_2_6__10_e_1}
  \binom{n}{k} \equiv \binom{\lfloor n/p \rfloor}{\lfloor k/p \rfloor} \binom{n \bmod p}{k \bmod p} (\textrm{по модулю} \ \ p) &&
\end{flalign}

Основная формула биномиального коэффициента:

\begin{flalign*}
  \binom{n}{k} = \frac {n (n-1) (n-2) \dots (n-k+1)} {k (k-1) (k-2) \dots 1} &&
\end{flalign*}

Рассмотрим $ k \bmod p $ первых сомножителей в знаменателе. Все они делятся на $p$ с остатком. 
Если $ k \bmod p > 0 $, то

\begin{flalign*}
  \prod_{i=0}^{(k \bmod p)-1} k-i & \equiv \prod_{i=1}^{k \bmod p} i \ \ & (\textrm{по модулю } p) \\
  k & \equiv k \bmod p \ \ & (\textrm{по модулю } p) \\
  k - 1 & \equiv (k \bmod p) - 1 \ \ & (\textrm{по модулю } p) \\
  \dots & \equiv \dots & \\
  k - (k \bmod p) + 2 & \equiv 2  \ \ & (\textrm{по модулю } p) \\
  k - (k \bmod p) + 1 & \equiv 1  \ \ & (\textrm{по модулю } p) \\
\end{flalign*}

Например, для $ k=17, p=7 $:

\begin{flalign*}
  17 \bmod 7 & = 3 & \\
  (17 \bmod 7) - 1 & = 2 & \\
  \prod_{i=0}^{2} 17-i  & \equiv \prod_{i=1}^{3} i \ \ & (\textrm{по модулю } 7) \\
  17 \cdot 16 \cdot 15  & \equiv 3 \cdot 2 \cdot 1 \ \ & (\textrm{по модулю } 7) \\
  4080 & \equiv 6  \ \ & (\textrm{по модулю } 7) \\
  4080 \bmod 7 & = 6
\end{flalign*}

Эта формула также справедлива для случая, когда $k$ делится на $p$ без остатка. Например, для $ k=14, p=7 $:

\begin{flalign*}
  14 \bmod 7 & = 0 & \\
  (14 \bmod 7) - 1 & = -1 & \\
  \prod_{i=0}^{-1} 14-i  & \equiv \prod_{i=1}^{0} i \ \ & (\textrm{по модулю } 7) \\
  1  & \equiv 1 \ \ & (\textrm{по модулю } 7)
\end{flalign*}

Теперь рассмотрим $ k \bmod p $ первых сомножителей в числителе $ n (n - 1) \dots (n - (k \bmod p) + 1) $.
Среди них может не оказаться сомножителя кратного $p$. Тогда:

\begin{flalign*}
  \prod_{i=0}^{(k \bmod p)-1} n-i & \equiv (n \bmod p) ((n \bmod p) - 1) \dots ((n \bmod p) - (k \bmod p) + 1) \ \ & (\textrm{по модулю } p) \\
  n & \equiv n \bmod p \ \ & (\textrm{по модулю } p) \\
  n - 1 & \equiv (n \bmod p) - 1 \ \ & (\textrm{по модулю } p) \\
  \dots & \equiv \dots & \\
  n - (k \bmod p) + 2 & \equiv (n \bmod p) - (k \bmod p) + 2  \ \ & (\textrm{по модулю } p) \\
  n - (k \bmod p) + 1 & \equiv (n \bmod p) - (k \bmod p) + 1  \ \ & (\textrm{по модулю } p) \\
\end{flalign*}

Например, для $ n=20, k=17, p=7 $:

\begin{flalign*}
  20 \bmod 7 & = 6 & \\
  (20 \bmod 7) - 1 & = 5 & \\
  \prod_{i=0}^{2} 20-i  & \equiv 6 \cdot 5 \cdot 4 \ \ & (\textrm{по модулю } 7) \\
  20 \cdot 19 \cdot 18  & \equiv 6 \cdot 5 \cdot 4 \ \ & (\textrm{по модулю } 7) \\
  6840 & \equiv 120  \ \ & (\textrm{по модулю } 7) \\
  6840 \bmod 7 & = 1 &\\
  120 \bmod 7 & = 1 &
\end{flalign*}

Для случая $ k \bmod p = 0 $ произведение в числителе, также как и в знаменателе, обращается в $ 1 $.
Если среди первых $ k \bmod p $ сомножителей в числителе встретится число, кратное $p$, то

\begin{flalign*}
  \prod_{i=0}^{(k \bmod p)-1} n-i & \equiv 0 \ \ & (\textrm{по модулю } p) \\
\end{flalign*}

Подставим получившиеся соотношения в дробь

\begin{flalign*}
  \frac{\prod_{i=0}^{(k \bmod p)-1} n-i}{\prod_{i=0}^{(k \bmod p)-1} k-i} & \equiv \frac{(n \bmod p) ((n \bmod p) - 1) \dots ((n \bmod p) - (k \bmod p) + 1)}{\prod_{i=1}^{k \bmod p} i}  \ \ & (\textrm{по модулю } p) \\
  \frac{\prod_{i=0}^{(k \bmod p)-1} n-i}{\prod_{i=0}^{(k \bmod p)-1} k-i} & \equiv \binom{n \bmod p}{k \bmod p} \ \ & (\textrm{по модулю } p)
\end{flalign*}

Для случая $ \prod_{i=0}^{(k \bmod p)-1} n-i \equiv 0 \ \ (\textrm{по модулю } p) $ соотношения также справедливы, т.к. $ \binom{0}{k} = \Bigl\{ \genfrac{}{}{0pt}{}{0 \textrm{ при } k > 0}{1 \textrm{ при } k = 0} $.

Рассмотрим далее оставшиеся сомножители в знаменателе: $ \prod_{i=1}^{k-(k \bmod p)} i $. Например, для $ k=17, p = 7 $ имеем $ \prod_{i=1}^{14} i $. Можно выделить $ \lfloor k / p \rfloor $ групп по $ p $ элементов в каждой. При этом в каждой группе существует только один элемент, кратный $ p $, а остальные эквиваленты $ (p-1)! $. То же самое утверждение справедливо и для числителя.

Тогда элементы некратные $p$ сокращаются в числителе и знаменателе. Рассмотрим $ \lfloor k / p \rfloor $ элементов кратных $p$. Разделим каждый сомножитель в числителе и знаменателе на $ p $. Получим в знаменателе $ \lfloor k / p \rfloor ! $, т.к. первое число равно $ \lfloor k / p \rfloor $, а каждое последующее должно уменьшаться на $1$. В числителе получим $ \lfloor k / p \rfloor $ сомножителей, первым из которых является $ \lfloor (n - (k \bmod p)) / p \rfloor $, а последующие также уменьшаются на единицу. Т.е. получим биномиальный коэффициент

\begin{flalign*}
  \binom{\lfloor (n - (k \bmod p)) / p \rfloor}{\lfloor k / p \rfloor}
\end{flalign*}

При этом

\begin{flalign*}
  \lfloor (n - (k \bmod p)) / p \rfloor = \biggl\{ \genfrac{}{}{0pt}{0}
          {\lfloor n / p \rfloor \textrm{, если } k \bmod p \leq n \bmod p}
          {\lfloor n / p \rfloor - 1 \textrm{, если } k \bmod p > n \bmod p}
\end{flalign*}

Учтем, что при $ k \bmod p > n \bmod p $ второй сомножитель $ \binom{n \bmod p}{k \bmod p} = 0 $, поэтому значение первого сомножителя во всех случаях можно оставить равным $ \lfloor n / p \rfloor $.

Интересным следствием доказанной формулы является тот факт, что

\begin{flalign} \label{eq:1_2_6__10_e_2}
  \binom{n}{k} \equiv 0 \ \ (\textrm{по модулю } p) \textrm{, если } k \bmod p > n \bmod p 
\end{flalign}

\paragraph{a.}

\begin{flalign} \label{eq:1_2_6__10_a_1}
  \binom{n}{p} \equiv \biggl \lfloor \frac{n}{p} \biggl \rfloor \ \ (\textrm{по модулю} \ \ p) &&
\end{flalign}


Подставим в формулу \ref{eq:1_2_6__10_e_1} $p$ вместо $k$. Получим

\begin{flalign*}
  \binom{n}{p} & \equiv \binom{\lfloor n/p \rfloor}{\lfloor p/p \rfloor} \binom{n \bmod p}{p \bmod p} & (\textrm{по модулю} \ \ p) && \\
  \binom{n}{p} & \equiv \binom{\lfloor n/p \rfloor}{1} \binom{n \bmod p}{0} & (\textrm{по модулю} \ \ p) && \\
  \binom{n}{p} & \equiv \lfloor n/p \rfloor \cdot 1 & (\textrm{по модулю} \ \ p) && \\
  \binom{n}{p} & \equiv \lfloor n/p \rfloor & (\textrm{по модулю} \ \ p) && \\
\end{flalign*}

\paragraph{b.}

\begin{flalign} \label{eq:1_2_6__10_b_1}
  \binom{p}{k} \equiv 0 \ \ (\textrm{по модулю} \ \ p) \textrm{ для } 1 \leq k \leq p-1 &&
\end{flalign}

Подставим в формулу \ref{eq:1_2_6__10_e_1} $p$ вместо $n$. Получим

\begin{flalign*}
  \binom{p}{k} & \equiv \binom{\lfloor p/p \rfloor}{\lfloor k/p \rfloor} \binom{p \bmod p}{k \bmod p} & (\textrm{по модулю} \ \ p) && \\
  \binom{p}{k} & \equiv \binom{1}{\lfloor k/p \rfloor} \binom{0}{k \bmod p} & (\textrm{по модулю} \ \ p) && \\
  & k \bmod p = k \textrm{ для } 1 \leq k \leq p-1 & && \\
  & \lfloor k/p \rfloor = 0 \textrm{ для } 1 \leq k \leq p-1 & && \\
  \binom{p}{k} & \equiv \binom{1}{0} \binom{0}{k} & (\textrm{по модулю} \ \ p) && \\
  \binom{p}{k} & \equiv 1 \cdot 0 & (\textrm{по модулю} \ \ p) && \\
  \binom{p}{k} & \equiv 0 & (\textrm{по модулю} \ \ p) && \\
\end{flalign*}

\paragraph{c.}

\begin{flalign*}
  \binom{p-1}{k} \equiv (-1)^{k} \ \ (\textrm{по модулю} \ \ p) \textrm{ для } 0 \leq k \leq p-1 &&
\end{flalign*}

Если $k=0$, а $p>0$, то $ \binom{p-1}{k} = \binom{p-1}{0} = 1 $ и $ (-1)^k = 1 $.

Подстановка $p-1$ вместо $n$ в формулу \ref{eq:1_2_6__10_e_1} ничего не дает, т.к. первый сомножитель обращается в $1$, а второй в исходное выражение:

\begin{flalign*}
  \binom{p-1}{k} & \equiv \binom{\lfloor (p-1)/p \rfloor}{\lfloor k/p \rfloor} \binom{p-1 \bmod p}{k \bmod p} & (\textrm{по модулю} \ \ p) && \\
  \binom{p-1}{k} & \equiv \binom{0}{\lfloor k/p \rfloor} \binom{p-1}{k \bmod p} & (\textrm{по модулю} \ \ p) && \\
  & k \bmod p = k \textrm{ для } 0 \leq k \leq p-1 & && \\
  & \lfloor k/p \rfloor = 0 \textrm{ для } 0 \leq k \leq p-1 & && \\
  \binom{p-1}{k} & \equiv \binom{0}{0} \binom{p-1}{k} & (\textrm{по модулю} \ \ p) && \\
\end{flalign*}

Рассмотрим формулу сложения:

\begin{flalign*}
  \binom{p}{k} & = \binom{p-1}{k} + \binom{p-1}{k-1} && \\
  \binom{p-1}{k} & = \binom{p}{k} - \binom{p-1}{k-1} && \\
\end{flalign*}

Т.к. по формуле \ref{eq:1_2_6__10_b_1} $\binom{p}{k} \equiv 0 \ \ (\textrm{по модулю } p)$, то имеем

\begin{flalign*}
  \binom{p-1}{k} & \equiv - \binom{p-1}{k-1} & (\textrm{по модулю } p) && \\
  \binom{p-1}{0} & \equiv 1 & (\textrm{по модулю } p) && \\
  \binom{p-1}{1} & \equiv -1 = p-1 & (\textrm{по модулю } p) && \\
  \binom{p-1}{2} & \equiv 1 & (\textrm{по модулю } p) && \\
  \dots & \equiv \dots & (\textrm{по модулю } p) && \\
  \binom{p-1}{p-1} & \equiv 1 & (\textrm{по модулю } p) && \\
  \binom{p-1}{k} & \equiv (-1)^{k} & (\textrm{по модулю } p) && \\
\end{flalign*}

Т.к. $p$ -- простое число, а следовательно и нечетное, то $p-1$ -- число четное и $(-1)^{p-1} = 1$. 

\paragraph{d.}

\begin{flalign*}
  \binom{p+1}{k} \equiv 0 \ \ (\textrm{по модулю} \ \ p) \textrm{ для } 2 \leq k \leq p-1 &&
\end{flalign*}

По формуле сложения:

\begin{flalign*}
  \binom{r}{k} & = \binom{r-1}{k} + \binom{r-1}{k-1} && \\
  \binom{p+1}{k} & = \binom{p}{k} + \binom{p}{k-1} && \\
\end{flalign*}

По формуле \ref{eq:1_2_6__10_b_1} $ \binom{p}{k} \equiv 0 \ \ (\textrm{по модулю } p) \textrm{ для } k \geq 1 $, но тогда и $ \binom{p}{k-1} \equiv 0 \ \ (\textrm{по модулю } p) $, т.к. по условию $ k \geq 2 $.

\paragraph{f.}

Если в системе счисления с основанием $p$ числа $n$ и $k$ представляются в виде

\begin{flalign*}
  \genfrac{}{}{0pt}{}{n = a_r p^r + \dots + a_1 p + a_0,}{k = b_r p^r + \dots + b_1 p + b_0,} \textrm{ то }
  \binom{n}{k} \equiv \binom{a_r}{b_r} \dots \binom{a_1}{b_1} \binom{a_0}{b_0} \ \ (\textrm{по модулю } p)
\end{flalign*}

Заметим, что

\begin{flalign*}
  \lfloor n/p \rfloor & = a_r p^{r-1} + \dots + a_2 p + a_1 &&  \\
  n \bmod p           & = a_0 &&
\end{flalign*}

Таким образом по формуле \ref{eq:1_2_6__10_e_1} получаем

\begin{flalign*}
  \binom{n}{k} & \equiv \binom{a_r p^{r-1} + \dots + a_2 p + a_1}{b_r p^{r-1} + \dots + b_2 p + b_1} \binom{a_0}{b_0} \ \ & (\textrm{по модулю } p) && \\
  \binom{n}{k} & \equiv \binom{a_r p^{r-2} + \dots + a_3 p + a_2}{b_r p^{r-2} + \dots + b_3 p + b_2} \binom{a_1}{b_1} \binom{a_0}{b_0} \ \ & (\textrm{по модулю } p) && \\
  \dots & \equiv \dots \ \ & (\textrm{по модулю } p) && \\
  \binom{n}{k} & \equiv \binom{a_r p + a_{r-1}}{b_r p + b_{r-1}} \binom{a_{r-2}}{b_{r-2}} \dots \binom{a_1}{b_1} \binom{a_0}{b_0} \ \ & (\textrm{по модулю } p) && \\
  \binom{n}{k} & \equiv \binom{a_r}{b_r} \binom{a_{r-1}}{b_{r-1}} \binom{a_{r-2}}{b_{r-2}} \dots \binom{a_1}{b_1} \binom{a_0}{b_0} \ \ & (\textrm{по модулю } p) && \\
\end{flalign*}


\end{document}
